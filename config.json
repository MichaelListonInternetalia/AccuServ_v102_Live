{"id":"e531dde6-a467-4882-a3d1-95c4c54f0a1f","version":"1.0.5","icon":"other","splash":"other","splashdata":{"img":"accuserv-splash 3.png","bg":"#ffffff"},"settings":{"router":{"mode":"single","animation":"off"},"theme":"default","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false},"wp":{"enabled":false}},"provisioning":{"enabled":false,"manifest":"","poll":2,"manual":false,"wifionly":true},"crashReporting":{"enabled":false,"androidEnabled":false,"iosEnabled":false,"splunkAndroidApiKey":"","splunkIosApiKey":"","splunkExtraData":""},"kioskMode":{"enabled":false},"loading-message":false,"logging":{"enabled":true,"bufferFrequency":100,"defaultRootLogLevel":"warn","defaultMaxFileSizeKilobyte":1000,"defaultMaxFiles":5,"appEnabled":true,"appUseDefault":true,"appRootLogLevel":"error","appMaxFileSizeKilobyte":1000,"appMaxFiles":5,"clientEnabled":true,"clientUseDefault":true,"clientRootLogLevel":"error","clientMaxFileSizeKilobyte":1000,"clientMaxFiles":5,"nativeEnabled":true,"nativeUseDefault":true,"nativeRootLogLevel":"error","nativeMaxFileSizeKilobyte":1000,"nativeMaxFiles":5},"plugins":{"builtIn":{"cordova-plugin-whitelist@1.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-battery-status@1.1.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-console@1.0.3":{"override":false,"used":true,"enabled":true},"cordova-plugin-contacts@2.1.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-device@1.1.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-device-motion@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-device-orientation@1.0.3":{"override":false,"used":false,"enabled":false},"cordova-plugin-file@4.2.0":{"override":false,"used":true,"enabled":true},"cordova-plugin-geolocation@2.2.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-globalization@1.0.3":{"override":false,"used":true,"enabled":true},"commontime-cordova-plugin-inappbrowser@1.6.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-network-information@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-splashscreen@3.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-vibration@2.1.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-statusbar@1.0.1":{"override":false,"used":true,"enabled":true},"cordova-plugin-camera@2.3.1":{"override":true,"used":false,"enabled":true,"PHOTOLIBRARY_USAGE_DESCRIPTION":"This app would like to access your photo library.","CAMERA_USAGE_DESCRIPTION":"AccuMobile would like to use the camera."},"phonegap-plugin-barcodescanner@6.0.4":{"override":true,"used":true,"enabled":false},"com.commontime.cordova.thumbnail@1.4.8":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.fileimporter@1.0.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.beacon@1.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.notification@1.0.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.audio@0.9.10":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.media-properties@1.2.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splitscreen@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.preferences@1.0.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.authentication@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.urlhandler@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.securesettings@1.0.2":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.geofence@0.5.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.file-transfer@1.5.5":{"override":true,"used":false,"enabled":true},"com.commontime.cordova.public.provisioning@0.0.13":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.insomnia@0.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splunk-mint@1.0.3":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.kiosk@1.0.11":{"override":false,"used":false,"enabled":false},"cordova-android-movetasktoback@0.1.3":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.logging@1.0.20":{"override":false,"used":true,"enabled":true},"cordova-plugin-email-composer":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.38":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.file-opener@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.logging@1.0.24":{"override":false,"used":true,"enabled":true},"cordova-plugin-email":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.44":{"override":false,"used":true,"enabled":true}},"customPlugins":{}},"minimise-on-back-button":true},"language":{"defaultLocale":"en_GB","initialLanguage":"","useDeviceLocale":true},"metadata":{"applicationkey":"accu-mobile-rr-app","googleapikey":"AIzaSyBwRT_044Cf1uL00BiGs4GMqjiIVe3cHus","accuservurl":"https://fix360dev.yourhousinggroup.co.uk/accuservrestv01/","yhgtesturl":"http://217.78.2.198/AccuServRESTV01/"},"name":"AccuServ_CP12_v105","packageId":"com.internetalia.accuserv.yhguat","schemaVersion":22,"minimumStudioVersion":"3.1.0","pages":[{"start":false,"name":"AppSettings","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"62c1b32d-60f2-4ffb-9743-a2275f56cd61","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.AppSettings === undefined) {\n  cti.store.pages.AppSettings = {};\n}\n\nif(cti.store.pages.AppSettings.accuservAPIAddress === undefined) {\n  cti.store.pages.AppSettings.accuservAPIAddress = \"\";\n}\n\nvar uatURL = cti.store.schema.metadata.yhgtesturl;\nvar apis = cti.store.webService.apiUrls;\nvar uatExists = false;\n\nfor(var i in apis) {\n  if(apis[i].value == uatURL) {\n    uatExists = true;\n    break;\n  }\n}\n\nif(!uatExists) {\n    apis.push({\"value\" : uatURL});\n}\n\ncti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;"},"_auto_id_":"e8d361da-573a-464f-8fef-1ecd3b9b522b"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"05b77a8e-1f57-40c8-9df9-652333d5fd6a","content":"<h4 class=\"title\">AccuMobile Settings</h4>","expressions":{}}],"_auto_id_":"5d73da71-0acf-4893-8e36-1afa175a9a75","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"apiQRcode","type":"capture","item-type":"qrcode","_auto_id_":"80710960-bacc-4f4d-a0b0-099d327cb256","label":"QR Code: ","required":false,"display-value":true,"validators":[],"actions":[],"expressions":{}},{"name":"apiURLcode","type":"user-input","item-type":"text","_auto_id_":"5910e47a-e93c-4e33-86cc-9d6fdb743877","label":"Manually Input API Address:","required":false,"multiline":false,"debounce":250,"validators":[],"actions":[],"expressions":{}},{"name":"apiQRcodeSave","type":"button","item-type":"button","_auto_id_":"e86d3248-0980-497c-8015-c621e3e480da","content":"Save API URL","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var urlCode = cti.store.pages.AppSettings.apiURLcode;\n\nvar qrCode = cti.store.pages.AppSettings.apiQRcode;\n\nvar apis = cti.store.webService.apiUrls;\nvar qrExist = false;\nvar urlExist = false;\n\nif((qrCode) || (urlCode)) {\n  for(var i in apis) {\n    if(apis[i].value == qrCode) {\n      qrExist = true;\n      break;\n    }\n  }\n  for(var i in apis){\n    if(apis[i].value == urlCode) {\n      urlExist = true;\n      break;\n    }\n  }\n\n  if(qrExist == true) {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\": \"app_odometer\",\n        \"item-type\": \"app-notification\",\n        \"style\": \"Warning\",\n        \"title\": \"Warning\",\n        \"text\": \"This Web Service QR code has already been scanned to this device. Please check the list below.\"\n      }\n    );\n    cti.store.pages.AppSettings.apiQRcode = undefined;\n  } \n  else if(urlExist == true) {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\": \"app_odometer\",\n        \"item-type\": \"app-notification\",\n        \"style\": \"Warning\",\n        \"title\": \"Warning\",\n        \"text\": \"This Web Service URL has already been scanned to this device. Please check the list below.\"\n      }\n    );\n    cti.store.pages.AppSettings.apiURLcode = undefined;\n  } \n  else if((qrExist == false) && (qrCode != \"\") && ((urlCode == undefined)|| (urlCode == \"\"))) {\n    apis.push({\"value\" : qrCode});\n    cti.store.schema.metadata.accuservurl = qrCode;\n    cti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;\n    cti.store.pages.AppSettings.apiQRcode = undefined;\n  } \n  else if((urlExist == false) && (urlCode != \"\") && ((qrCode == undefined)||(qrCode == \"\"))) {\n    apis.push({\"value\" : urlCode});\n    cti.store.schema.metadata.accuservurl = urlCode;\n    cti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;\n    cti.store.pages.AppSettings.apiURLcode = undefined;\n  }\n  else if((qrExist == false) && (urlExist == false) && (urlCode != \"\") && (qrCode != \"\")) {\n    apis.push({\"value\" : qrCode});\n    cti.store.schema.metadata.accuservurl = qrCode;\n    cti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;\n    cti.store.pages.AppSettings.apiQRcode = undefined;\n  }\n} \n\nelse {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning\",\n      \"text\": \"Please scan a QR Code or manually input an API URL address before attempting to save.\"\n    }\n  );\n}"},"_auto_id_":"71e7c006-09cb-4d36-b4cd-edead63871eb","actions":[]}],"classes":"confirm-bar-btn"},{"name":"urlSwitch","type":"choice","item-type":"select","_auto_id_":"a33002ba-45e4-421a-8a33-27b15a806e8c","label":"Web Services:","required":false,"options":[{"label":"Option 1","value":"https://fix360dev.yourhousinggroup.co.uk/accuservrestv01/"},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"option-source":"$store.webService.apiUrls","label-property":"value","value-property":"value","expressions":{},"message":"This is a required field","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.store.schema.metadata.accuservurl = cti.store.pages.AppSettings.urlSwitch.value;\ncti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;"},"_auto_id_":"9153ad00-a080-48c2-ab8b-0ce2d00be9c1","actions":[]}],"validators":[],"group-property":""},{"name":"accuservAPIAddress","type":"user-input","item-type":"text","_auto_id_":"166f2b21-ebf4-4532-9274-df62451eda77","label":"AccuServ API address","required":false,"multiline":false,"debounce":250,"description":"","left-icon":"fa-cloud","expressions":{"show":"0"},"modelLocationOverride":"","validators":[],"actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"1b8e3197-14bd-4196-9c15-54376f184809","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"286787e4-4ddb-4dd6-9c9e-409db57e52a2","content":"Back","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"Login\" });"},"_auto_id_":"d1bcc79a-785b-484f-8a25-cbf8876af983","actions":[]}],"expressions":{},"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"bb871f55-99b5-43e5-b1b3-6a1200c16e95","expressions":{}}]},{"start":false,"name":"SupportInfo","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"489a886f-823e-4a11-a014-cfd25a836aba","content":"<h4 class=\"title\">Support Information</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"c1ca0df3-ebff-4c80-82cf-cfbdeea56330","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"SupportInfo","componentInstanceId":"eb7efe5f-3731-4721-b760-eba3ba581150","function":"open"},"_auto_id_":"2b940f0a-8309-4ff0-83d6-546f1d2a3566"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"300d329e-e772-4448-92e7-b9744f440e71","content":"Logout","theme":"default","expressions":{"show":"$store.variables.jobStarted == false","disabled":"$store.variables.pauseTask === true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"7e5aee50-4032-44ab-bb76-960abe10fe59"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"eb7efe5f-3731-4721-b760-eba3ba581150","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"e3955ee5-a0e1-4f6b-8cfb-c922756789cb","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_jobaccessdetail","type":"content","item-type":"html","_auto_id_":"7fb7cd4d-a84d-4219-a86e-bd35e02b719d","content":"<h4 style=\"font-weight:bold;\">Current user information</h4>\n<div>\n\t<p>Current user: {{'$store.currentProfile.username'|store}}</p>\n\t<p>Login token expires: {{'$store.variables.supportInfo.tokenExpiry'|store}}</p>\n\t<p>Session expires: {{'$store.variables.supportInfo.sessionExpiry'|store}}</p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Application information</h4>\n<div>\n\t<p>Version: {{'$store.schema.version'|store}}</p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Event history</h4>","expressions":{}},{"name":"list_eventLog","type":"content","item-type":"list","_auto_id_":"9dd08989-b503-4c96-b612-0bdede7c3276","search":"","classes":"","model":"$store.log","actions":[],"expressions":{},"theme":"bootstrap","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_eventLog_html","_auto_id_":"5ab72d8e-a827-461b-b5c0-2cc3c1089a7f","content":"<div class=\"list-item-container\">\n  <div class=\"list-item-head\">{{$data.$item.time}} <span class=\"log-{{$data.$item.type}}\"><b>{{$data.$item.type}}</b></span></div>\n  <div class=\"list-item-detail\">{{$data.$item.message}}</div>\n</div>"}],"pagination":true,"paginationItemsPerPage":10,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationFirstLast":false,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":5},{"name":"html_hardreset","type":"content","item-type":"html","_auto_id_":"207c0071-2d10-4c85-8e77-6fdf4776f988","content":"<hr>\n<h4 style=\"font-weight:bold;\">Reset Application</h4>\n<p>If you have encounted a serious error with the application, or are experiencing issues that are blocking you from progressing through the Job or the app, please take a screenshot of the above log stream and select the <span style=\"color:blue\">Reset</span> button below.</p>\n<p><span style=\"color:red\"><strong>WARNING:</strong></span> Once you have selected the <span style=\"color:blue\">Reset</span> option, you will lose any data you currently have on device related to the current Job.</p>","expressions":{}},{"name":"btnReset","type":"button","item-type":"button","_auto_id_":"d1980cc2-01cc-4b4f-985e-5d6c072a5a98","content":"RESET","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"b8b99cbb-4baf-421b-82f6-5f19bac97843"}],"classes":"deletephoto-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"7d77e2d9-0f08-485c-84c5-9149d59ace04","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"9b228093-1933-40ea-8229-7353b50f4023","content":"Back","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.supportInfo;\ncti.utils.callAction('go-to-page', { \"name\": cti.store.variables.supportInfoLastPage });"},"_auto_id_":"ecb18e40-a307-46e7-bb70-31bc50065157","actions":[]}],"expressions":{},"classes":"button-bar-btn"},{"name":"clear_btn","type":"button","item-type":"button","_auto_id_":"40da9170-badf-43bb-939b-a148b796e203","content":"Clear Logs","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"console.clear();\ncti.store.log = [];\ncti.utils.updatePage();"},"_auto_id_":"5d86917e-6cc9-4aa8-98b1-0e86f3041971","actions":[]}],"expressions":{},"classes":"deletephoto-btn"}],"expressions":{}}],"_auto_id_":"20813ffb-3731-4ca8-aba5-563235fab7c5"}]},{"start":false,"name":"PauseTask","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"c0b90b38-eebd-46cc-99c3-8a21c9621c1f","content":"<h4 class=\"title\">Pause Task</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"8522b368-ca75-44a2-be58-74639462aa97","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobSummary","componentInstanceId":"ee2c1fce-5756-407a-babd-e148f2657687","function":"open"},"_auto_id_":"49c1f36c-d4d5-484e-acde-62416cb752cd"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"7232b3b6-e8d8-48f9-a649-7f1ea6e7300e","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"e32fc2a4-3df1-4f5d-aa75-b41841bf56ac"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"b0dbae57-ec3b-48d6-9eea-5cc4ea0f3a8a","content":"Job List","theme":"default","expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"47c77d7d-6e41-465b-8504-fb39572150a1"}],"left-icon":"fa-list"},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"c8729b37-815d-4d18-9a2d-7dcc56926f69","content":"Logout","theme":"default","expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"5e5f5a48-290b-433c-b658-ab1199685354"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"d5b55603-4357-4bcc-85a7-5f1b1c52a2c7","attributes":{},"expressions":{}}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"ee2c1fce-5756-407a-babd-e148f2657687","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"54eeaf46-cb7a-498c-b497-a793789bed1b","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"pauseTaskInfo","type":"content","item-type":"html","_auto_id_":"0edd30a2-d30c-4da3-aa09-1b9636d145a7","content":"<p>Please select the Pause Task button below if you would like to record Non-Productive time (i.e. lunch break)</p>","expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"}},{"name":"activityCategory","type":"choice","item-type":"select","_auto_id_":"782e36f6-cc5f-42d7-8a48-8a05a34ba69c","label":"Activity Category:","required":true,"options":[{"label":"BREAK","value":"BREAK"}],"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field"},{"name":"activityType","type":"choice","item-type":"select","_auto_id_":"2f2d3f3b-96b5-4cea-9a63-9459f9f769a9","label":"Activity Type:","required":true,"options":[{"label":"LUNCH","value":"LUNCH"}],"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field"},{"name":"activityDuration","type":"choice","item-type":"select","_auto_id_":"154a6dd3-1236-402b-8b58-5e7adc444840","label":"Estimated Duration:","required":true,"options":[{"label":"00:15","value":"15"},{"label":"00:30","value":"30"},{"label":"00:45","value":"45"},{"label":"01:00","value":"60"},{"label":"01:15","value":"75"},{"label":"01:30","value":"90"},{"label":"01:45","value":"105"},{"label":"02:00","value":"120"}],"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field","actions":[]},{"name":"operativeComments","type":"user-input","item-type":"text","_auto_id_":"ec97c12c-b8f9-42a4-9196-0107c5f4ea38","label":"Operative Comments:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.payloads.pauseTask.bPauseTask != true"},"message":"This is a required field"},{"name":"pauseTask","type":"button","item-type":"button","_auto_id_":"95f0c211-cc5a-44a8-811e-a3d289473064","content":"Pause Task","theme":"default","expressions":{"disabled":"$form.invalid","show":"$store.payloads.pauseTask.bPauseTask != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.pauseTask = true;\ncti.store.payloads.pauseTask = {\n  \"bPauseTask\" : true,\n  \"dtPauseDateTime\" : moment().locale('en').format('HH:MM DD-MM-YYYY'),\n  \"dtEndDateTime\" : \"\",\n  \"sActivityCategory\" : cti.store.pages.PauseTask.activityCategory.value,\n  \"sActivityType\" : cti.store.pages.PauseTask.activityType.value,\n  \"tEstimatedTime\" : cti.store.pages.PauseTask.activityDuration.value,\n  \"sComments\" : cti.store.pages.PauseTask.operativeComments\n};\n\n// TODO - Send on break message\ncti.utils.updatePage();"},"_auto_id_":"23529e18-93e0-4688-a345-adb0091ac692"}],"classes":"getmethere-btn"},{"name":"onPause","type":"content","item-type":"html","_auto_id_":"554f4c56-37ba-4b25-b2b9-f84a76ca2f8e","content":"<div class=\"pauseicon\">\n\t<i class=\"fa fa-coffee\"></i>\n</div>\n<h4 class=\"pauseheader\">You are currently on {{'$store.payloads.pauseTask.sActivityType'|store}}</h4>\n<p style=\"text-align:center\">Time {{'$store.payloads.pauseTask.sActivityType'|store}} Started: <span style=\"color:#0072C6\">{{'$store.payloads.pauseTask.dtPauseDateTime'|store}}</span></p>\n<p style=\"text-align:center\">Estimated Duration: <span style=\"color:#0072C6\">{{'$store.payloads.pauseTask.tEstimatedTime'|store}} minutes</span></p>\n<p style=\"text-align:center\">Comments: <span style=\"color:#0072C6\">{{'$store.payloads.pauseTask.sComments'|store}}</span></p>\n<hr>","expressions":{"show":"$store.payloads.pauseTask.bPauseTask == true"}},{"name":"endTask","type":"button","item-type":"button","_auto_id_":"72f2e61e-f6f4-445e-8060-517b4afd6808","content":"End Task","theme":"default","expressions":{"show":"$store.payloads.pauseTask.bPauseTask == true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var endTask = {\n  \"bPauseTask\" : false,\n  \"dtPauseDateTime\" : cti.store.payloads.pauseTask.dtPauseDateTime,\n  \"dtEndDateTime\" : moment().locale('en').format('HH:MM DD-MM-YYYY'),\n  \"sActivityCategory\" : cti.store.payloads.pauseTask.sActivityCategory,\n  \"sActivityType\" : cti.store.payloads.pauseTask.sActivityType,\n  \"tEstimatedTime\" : cti.store.payloads.pauseTask.tEstimatedTime,\n  \"sComments\" : cti.store.payloads.pauseTask.sComments\n};\n  \ncti.store.payloads.pauseTask = endTask;\ndelete cti.store.variables.pauseTask;\n\ncti.utils.destroyPageData('PauseTask');\n\n// TODO - Send off break message\ndelete cti.store.payloads.pauseTask;\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"a8c0ef6b-134a-4a3e-8168-5ed88386cfbf"}],"classes":"getmethere-btn"}],"_auto_id_":"fdf51ece-39a1-413f-a24f-b8b2bb7b1ea8"}]},{"start":false,"name":"PhotoDetail","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"ffee4ce4-7297-49fa-a43c-df46621ec40b","content":"<h4 class=\"title\">Edit Photo Detail</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"e9f96be7-cd94-4ec6-a7f2-f81799dbbf96","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"PhotoDetail","componentInstanceId":"c97491ce-3437-4a7c-99e3-be0fa794093e","function":"open"},"_auto_id_":"a02d85a1-5ff1-4730-a2e9-8b121cb69884"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"15f95685-6fd1-4c74-b1d6-46ac98c6d1d8","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"82f12e5b-e481-4382-a140-a1602ea92926"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"7b970fa1-ce05-42c7-bc64-c2936ffcba4c","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"92982851-ca96-4e17-a451-1ee2ba94427f"}],"left-icon":"fa-list"},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"94b29ae9-2760-4245-8d06-34cc7da3032d","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"13f9c42f-aedf-4f16-9cd5-071ebf6f3762"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"c97491ce-3437-4a7c-99e3-be0fa794093e","attributes":{},"expressions":{}}],"_auto_id_":"332962aa-c938-4f68-99a4-5a81c458baec","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"1bd11111-3adb-4d7a-8c8c-23cac47c7ce8","attributes":{},"expressions":{}},{"name":"htmlPhotoDetail","type":"content","item-type":"html","_auto_id_":"72a3e183-ca16-40a9-bf1e-3213162da897","content":"<h4 style=\"font-weight:bold;\">Current user information</h4>\n<div>\n\t<p>Photo taken: {{'$store.variables.selectedPhoto.date'|store}}</p>\n\t<p>Category: {{'$store.variables.selectedPhoto.category'|store}}</p>\n\t<p>Internal ID: {{'$store.variables.selectedPhoto.id'|store}}</p>\n</div>\n<hr>\n","expressions":{}},{"name":"Description","type":"user-input","item-type":"text","_auto_id_":"72aa094f-c687-4877-ac9a-1ed90d42db3e","label":"Description","required":false,"multiline":true,"debounce":250,"placeholder":"add any notes you have for this photo","maxlength":200,"validators":[],"actions":[],"expressions":{}},{"name":"htmlImage","type":"content","item-type":"html","_auto_id_":"1fbc74d5-1882-430f-ab0b-7b2f6af0de67","content":"<h4 style=\"font-weight:bold;\">Photo</h4>\n<div class=\"photo-review-container\">\n<img class=\"photo-review\" src=\"{{'$store.variables.selectedPhoto.src'|store}}\"></img>\n</div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"e22485f2-106d-49a2-9b16-0dc088977a1c","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnDeletePhoto","type":"button","item-type":"button","_auto_id_":"cd94d950-1c34-4bde-9f85-4d53cbcb9f5a","content":"Delete photo","theme":"default","left-icon":"fa-trash","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Deleting Photo...');\ncti.fnDeleteSelectedPhoto();"},"_auto_id_":"615a12f2-ee80-4748-8255-b555ae55be99"}],"classes":"deletephoto-btn"},{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"b8fa0736-4b38-4f72-b0d8-b2d0b6d5fe56","content":"Save","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if (cti.store.pages.PhotoDetail !== undefined && cti.store.pages.PhotoDetail.Description !== undefined) {\n  for (var k in cti.store.variables.selectedPhotoList) {\n    if (cti.store.variables.selectedPhotoList[k].id == cti.store.variables.selectedPhoto.id) {\n      cti.store.variables.selectedPhotoList[k].description = cti.store.pages.PhotoDetail.Description;\n      break;\n    }\n  }\n\n  delete cti.store.pages.PhotoDetail.Description;\n}\n\ncti.store.variables.fromPhotoDetail = true;\n\nvar lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastPhotoDetailPage));\ncti.utils.callAction(\"go-to-page\", { \"name\" : lastPage });\ndelete cti.store.variables.lastPhotoDetailPage;"},"_auto_id_":"80b5f6d1-90ad-4367-8440-0e0f70542c96","actions":[]}],"expressions":{},"classes":"confirm-bar-btn"}],"expressions":{}}],"_auto_id_":"9aece41e-de7a-4418-b19d-afa77623ef29"}]},{"start":false,"name":"JobMap","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"be270bb0-6720-4393-868f-20ea2b0c299b","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(typeof google === 'object' && typeof google.maps === 'object') {\n  window.appManager.logEvent('Google Maps API initialised.', 'info');\n} else {\n  window.appManager.logEvent('Google Maps API not loaded, initialising...', 'info');\n  var googleMaps = document.createElement('script');\n  googleMaps.id = 'google';\n  googleMaps.src = 'https://maps.googleapis.com/maps/api/js?key=' + cti.store.schema.metadata.googleapikey;\n  document.body.appendChild(googleMaps);\n  window.appManager.logEvent('Google Maps API initialised successfully.', 'info');\n}\n\n$success();"},"_auto_id_":"7cc0a2a3-91a1-4194-9734-6a4e5e6fb276","actions":[{"event":"success","type":"start-timer","data":{"name":"tmFetchMapData"},"_auto_id_":"39072efa-86ce-410b-b1df-551152eedebc"}]}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"f36ca90a-b507-40fd-a177-a883d9e3642a","content":"<h4 class=\"title\">Job Map</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"16114ad5-5eb7-4b12-aed7-b5f8cf949645","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobMap","componentInstanceId":"633b56e9-9ef7-496b-aea3-1138d26682e8","function":"open"},"_auto_id_":"abab64c7-d8dc-4a0f-a463-637abd510eb5"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"d4240f3f-9af9-4267-8171-1aef7bc20d20","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"93573fc2-3f8d-4ddb-a75f-fc54f9fa4e41"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"fc7aed9a-7a46-4839-a6c0-25b663878499","content":"Job List","theme":"default","expressions":{"show":"$store.variables.jobStarted == false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"1cf27e76-4af3-4bf6-99ce-1f4fc010c747"}],"left-icon":"fa-list"},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"94ffc066-3f4f-468c-bd4e-566a0f084f27","content":"Logout","theme":"default","expressions":{"show":"$store.variables.jobStarted == false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"d571e0b7-53bf-4726-8e4b-abdc9accf916"}],"left-icon":"fa-sign-out"}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"633b56e9-9ef7-496b-aea3-1138d26682e8","attributes":{},"expressions":{}}],"_auto_id_":"8fb5fcd3-dd09-45ba-866a-ac90da36a27d","expressions":{},"classes":""},{"name":"staticMap","type":"area","item-type":"static","_auto_id_":"8e1c3e0f-b8e7-464a-aee3-60c86a065d05","content":[{"name":"html_map","type":"content","item-type":"html","_auto_id_":"ecb8ca85-53ef-461a-878c-18cc44fb76d0","content":"<div id=\"map\"></div>","expressions":{}}],"expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"1e4be86d-5244-4754-8678-4e60ac80f0ba","content":[{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"950de66b-df3e-4210-bf3b-cfb0a0e936dd","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"1aef3c81-9961-4678-aae9-250980436439","content":"Back","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobs = [];\ncti.store.variables.showFullJobs = false;\n\nfor(var i in cti.store.jobs.jobListShort) {\n  if(i == \"0\" || i == \"1\") {\n    jobs.push(cti.store.jobs.jobListShort[i]);\n  }\n}\n\ncti.store.jobs.jobListShort = JSON.parse(JSON.stringify(jobs));\n\nvar lastPage = cti.store.variables.lastJobMapPage;\n\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"87d3b2bf-a7b8-4da3-b639-f510079ac061"}],"classes":"button-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobSummary","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"6fd3dc3d-bede-47b0-b45e-42bf20477bdc","content":"<h4 class=\"title\">Job Summary</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"12f988b0-bc42-4296-8556-e3a1c4321ff3","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobSummary","componentInstanceId":"a2ef74e0-3973-40f3-8d60-bd97c7e17070","function":"open"},"_auto_id_":"c6954907-618b-4327-a9f1-eaf648819af7"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"6e7c367a-07fd-4eb7-8505-46fc1bf9c1c9","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"96222bcd-3817-45fa-b91f-6c52172d706a"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"a705164e-ac38-483b-a427-28a9e369584b","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"acff70db-67e4-4bfc-8935-486b37242f60"}],"left-icon":"fa-list"},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"b66d079e-49df-49f6-b955-02ac537cf5e5","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"918d2f81-db33-4624-b2c1-e3791c3028c5"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"b07a332d-f205-499e-b1e2-29bae92e5856","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"51531a67-3e23-4d7f-a10c-25d8deef5dca"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"6ccd1f50-ebf9-4ebd-92ba-4657244dc080","attributes":{},"expressions":{}}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"a2ef74e0-3973-40f3-8d60-bd97c7e17070","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"8dbf6e03-c287-454d-a004-72ec9b47e1a9","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_jobaccessdetail","type":"content","item-type":"html","_auto_id_":"a98c183f-8511-4dbd-8cff-ccd06bd56eda","content":"<h4 style=\"font-weight:bold;\">AccuServ Job ID Details</h4>\n<div>\n\t<p>Job Number: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aAccuServJobID.sJobNo'|store}}</span></p>\n  \t<p>Client Order No: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aAccuServJobID.sOriginatorID'|store}}</span></p>\n  \t<p>Operative ID: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aOperativeDetail.sOperativeName'|store}}</span></p>\n  \t<p>Contract: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sContract'|store}}</span></p>\n  \t<p>Priority: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sPriority'|store}}</span></p>\n  \t<p>Status: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sStatus'|store}}</span></p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Tenant Details</h4>\n<div>\n\t<p>Name: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sTenant_Name'|store}}</span></p>\n\t<p>Home: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sHome_No'|store}}</span></p>\n\t<p>Mob:  <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sMobile_No'|store}}</span></p>\n  \t<p>Address: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sAddress_1'|store}}</span></p>\n\t<p>         <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sAddress_4'|store}}</span></p>\n\t<p>         <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.aPropertyDetail.sPostcode'|store}}</span></p>\n</div>\n<hr>\n<h4 style=\"font-weight:bold;\">Job Detail</h4>\n<div>\n  <p>{{'$store.jobs.jobSummary.sProblemSummary'|store}} - {{'$store.jobs.jobSummary.sProblemDetail'|store}}</p>\n  <p>Expected Duration: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sExpected_Duration'|store}} minutes</span></p>\n  <p>Attend On Date/Time: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.dAttendOnDate'|store}} - {{'$store.jobs.jobSummary.iAttendOnHrs'|store}}:{{'$store.jobs.jobSummary.iAttendOnMins'|store}}</span></p>\n  <p>Appointment Slot: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.sAssignedType'|store}}</span></p>\n  <p>Job Target Date/Time: <span style=\"color:#0072C6\">{{'$store.jobs.jobSummary.dJobTargetDate'|store}} - {{'$store.jobs.jobSummary.iJobTargetHrs'|store}}:{{'$store.jobs.jobSummary.iJobTargetMins'|store}}</span></p>\n</div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"4f451723-75cd-4400-b47b-f3c0f8cae543","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"03533f17-454c-4590-90cd-337fa7c99115","content":"Back","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.jobSummaryLastPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });\ndelete cti.store.jobs.jobSummary;"},"_auto_id_":"c91af581-ad1e-4b7f-b9a6-289548156634","actions":[]}],"expressions":{},"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"223f91de-4d34-4bda-8ae7-240564e1ec40"}]},{"start":false,"name":"JobHistoryDetail","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"913c704d-cde4-46f2-9efd-f68630d9d49b","content":"<h4 class=\"title\">Job: {{'$store.jobs.jobHistorySelected.jobNumber'|store}}</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"b3ce3481-f414-4b68-b90e-d5ce1d61cda2","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobHistoryDetail","componentInstanceId":"2a7c1fd4-9eb1-45de-9de5-66779732d2bb","function":"open"},"_auto_id_":"d9ad28c1-17ae-49a3-8fb0-fffab0871f52"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"d86e3503-f782-4906-a2e6-bd7d1cb61e9f","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"00fd78af-877a-4e72-9328-31caf7d712e8"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"7e75abe8-5ff0-4dda-a48c-14874cead29a","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"02f294dc-64bd-43c8-a38a-c1a4109fe0b6"}],"left-icon":"fa-list"},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"2196db23-0ca2-4d42-b3fd-9488cb4c6387","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"73f5fbd6-ecaa-481d-a10b-f224d2d805bf"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"d07cfe10-75b1-4d01-a2fa-4e94c630862b","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"8218d6bb-9c07-4f1a-985c-5d394ec8cf50"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"2a7c1fd4-9eb1-45de-9de5-66779732d2bb","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"b9b96d30-b891-4fad-8668-a8c87e108a9a","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"bf32ac16-2c5c-4333-b646-8e10494d26f3","content":[{"name":"html_jobdetails","type":"content","item-type":"html","_auto_id_":"6918413f-cbc1-4a1e-bf68-6d7a5ceb209b","content":"<h5 style=\"font-weight:bold;\">Operative</h5>\n<p>{{'$store.jobs.jobHistorySelected.operativeId'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Attend On Date</h5>\n<p>{{'$store.jobs.jobHistorySelected.attendOnDate'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Attend On Time</h5>\n<p>{{'$store.jobs.jobHistorySelected.attendOnTime'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Problem Detail</h5>\n<p>{{'$store.jobs.jobHistorySelected.problemDetail'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Result Detail</h5>\n<p>{{'$store.jobs.jobHistorySelected.resultDetail'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Access Detail</h5>\n<p>{{'$store.jobs.jobHistorySelected.accessDetail'|store}}</p>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"aa0e9bd3-ab4e-4245-a214-bf6804ef9fd2","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"0a0455e1-92bf-4ae9-b975-a46f36f60456","content":"Previous","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"JobHistory\" });"},"_auto_id_":"31ce325c-a94a-406d-84e2-5dedb744e4e9"}],"classes":"button-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobHistory","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"f9a2d93e-ea06-4b7f-a2a3-eb8f3436bcc6","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.jobHistory === undefined) {\n  cti.store.jobs.jobHistory = [];\n}\n\nif(cti.store.jobs.jobHistory.length === 0) {\n  cti.store.variables.historyData = false;\n} else {\n  cti.store.variables.historyData = true;\n}\n\ncti.utils.updatePage();"},"_auto_id_":"c79715ee-f238-4e3b-a697-7664d496be89"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"7e27d782-f47a-4f4f-8760-5e54294ac0e7","content":"<h4 class=\"title\">Job History</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"bc08da80-ef68-4148-98b1-4a7e8cb28338","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobHistory","componentInstanceId":"fe43a931-e569-4e81-871b-8325f1ffee09","function":"open"},"_auto_id_":"33aab652-9693-4201-8deb-6b2a5577ff13"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"7ecf037a-affb-429e-8b0e-c5af9d57c834","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"829166dc-b65b-430d-b1ae-649e44505c44"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"ede8017d-1328-4dd7-92a4-b9d4fe0db9e3","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"735385e5-591c-42a6-86c9-a3cae6da7cee"}],"left-icon":"fa-list"},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"32c5c270-be9d-4b1b-a17c-d539dc8c89f2","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"bada117e-290d-47e1-9967-5ae9a16cf855"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"5d235e45-e880-44a7-8311-5acfa8b46d8b","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"daa04d9e-0b84-4684-be04-280e4cc37c97"}],"left-icon":"fa-sign-out"}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"fe43a931-e569-4e81-871b-8325f1ffee09","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"7354b8ca-ca7c-4f63-86e0-ebf10aed4782","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"f83815ed-f33d-4fb2-9e0f-38a9b94c69ce","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"0acc7c05-7011-42f5-babd-0f47de358c38","attributes":{},"expressions":{}},{"name":"html_nojobhistory","type":"content","item-type":"html","_auto_id_":"3cad1d24-199b-494d-a986-278c30232671","content":"<h4 class=\"centered-text\">No Results Found.</h4><p class=\"centered-text\">Currently there are no results for this Property returned. Please contact your Supervisor or re-try by tapping the below icon.</p>\n<div class=\"retry-job\" onclick=\"cti.utils.callAction('call-actionflow',{'name':'GetJobHistory'});\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.historyData === false"}},{"name":"list_jobhistory","type":"content","item-type":"list","_auto_id_":"d6257310-f5e1-4d38-93e3-c6e6bd5e80c5","search":"","classes":"","expressions":{"show":"$store.variables.historyData === true"},"model":"$store.jobs.jobHistory","theme":"bootstrap","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Remove previous jobHistorySelected object\ndelete cti.store.jobs.jobHistorySelected;\n\n// Package selected job\nvar jobSelected = {{$data.$item}};\n\n// Create jobHistorySelected object with selected job data\ncti.store.jobs.jobHistorySelected = {\n  \"jobNumber\" : jobSelected.aAccuServJobID.sJobNo,\n  \"operativeId\" : jobSelected.aOperativeDetail.sOperativeID + \" - \" + jobSelected.aOperativeDetail.sOperativeName,\n  \"attendOnDate\" : jobSelected.dAttendOnDate,\n  \"attendOnTime\" : jobSelected.iAttendOnHrs + \":\" + jobSelected.iAttendOnMins,\n  \"problemDetail\" : jobSelected.sProblemDetail,\n  \"resultDetail\" : jobSelected.sResultDetail,\n  \"accessDetail\" : jobSelected.sAccessDetail\n}\n\n//Navigate to history detail page\ncti.utils.callAction('go-to-page', { \"name\": \"JobHistoryDetail\" });"},"_auto_id_":"bb698603-4415-4cdf-9479-9cec0a018acb"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_jobhistory_html","_auto_id_":"8e9fce25-e981-4cce-bcfb-4f747caaba4c","content":"<div class=\"joblist-container\">\n  <div class=\"joblist-column-1 joblist-status\">\n    <div class=\"joblist-slot\">{{$data.$item.sAssignedType}}</div>\n    <div class=\"joblist-day\">{{$data.$item.sDay}}</div>\n    <div class=\"joblist-month\">{{$data.$item.sMonth}}</div>\n  </div>\n  <div class=\"joblist-column-2\">\n    <div class=\"joblist-contract\">{{$data.$item.sProblemDetail}}</div>\n    <br>\n    <div class=\"joblist-priority\">{{$data.$item.aAccuServJobID.sJobNo}}</div>\n    <div class=\"joblist-priority\">{{$data.$item.aOperativeDetail.sOperativeName}}</div>\n    <div class=\"joblist-address\"></div>\n  </div>\n  <div class=\"joblist-column-3\"></div>\n</div>"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"64288413-d8d6-4fec-a96f-689f4c9d6f4c","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"5d415df3-1b3b-4ec3-b6eb-0a25c8049f41","content":"Back","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.lastJobHistoryPage;\ndelete cti.store.jobs.jobHistorySelected;\ndelete cti.store.variables.historyData;\n\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"9336ad89-cea9-420e-820c-f1970ac3f451"}],"classes":"button-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"RaiseIncident","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"313eba8d-770e-4555-98ca-53c96b8e58a2","attributes":{},"expressions":{}},{"name":"html_header","type":"content","item-type":"html","_auto_id_":"43237bf5-b360-4335-a968-d847388419ed","content":"<h4 class=\"title\">Raise an Incident</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"f1967067-39b4-4774-8e53-f842b6cc1003","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"77484334-aaa5-4b31-8e4d-492211c8a9a2","function":"open"},"_auto_id_":"28073e02-32b3-4405-91b2-a9985b05c85c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"80d3bf21-c2a8-4859-8060-bdb12aa6f833","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"e7e722d8-ad5d-46d2-bd7b-db0dbfd3b775"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"da30b142-384e-4fa3-b97b-7f6fde33fd47","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"c13256f7-ea0a-4561-9759-60b45de74783"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"358a14da-6955-4862-9a8d-1fd2ddca228f","content":"Job Map","theme":"default","expressions":{"show":"$store.jobs.jobList.length > 0"},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"de5aeb63-e889-4171-b6b4-cec6df71368c"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"41ccd7a9-3569-4da9-b901-0426d40fd9f4","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"1149c4e2-cd4a-4329-8889-54101c1d353a"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"77484334-aaa5-4b31-8e4d-492211c8a9a2","attributes":{},"expressions":{}}],"_auto_id_":"0444eb52-cb25-45c9-bfa6-978d315abfd3","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"1f4e601c-79a5-442e-8d26-a1352f6660ca","content":[{"name":"html_override","type":"content","item-type":"html","_auto_id_":"a364517c-355a-429b-8dd5-bb36f83d5144","content":"<p>In order to raise either a Customer or a Property related Incident, please fill in the form below before submitting.</p>\n<hr>","expressions":{}},{"name":"incidentType","type":"choice","item-type":"select","_auto_id_":"f4f8dd75-ad7d-407e-9362-4aca29d9990b","label":"Incident Type:","required":false,"options":[{"label":"CUSTOMER","value":"CUSTOMER"},{"label":"PROPERTY","value":"PROPERTY"}],"expressions":{}},{"name":"incidentCustomerType","type":"choice","item-type":"select","_auto_id_":"1646efb0-bbfe-478d-8cb4-ee4fac16f749","label":"Customer Type:","required":false,"options":[{"label":"DISABILITY","value":"DISABILITY"},{"label":"VULNERABILITY","value":"VULNERABILITY"},{"label":"OTHER","value":"OTHER"}],"expressions":{"show":"$store.pages.RaiseIncident.incidentType.value == \"CUSTOMER\""}},{"name":"incidentPropertyType","type":"choice","item-type":"select","_auto_id_":"ae1c0ca0-e859-4f74-9dac-f0b924d00f9b","label":"Property Type:","required":false,"options":[{"label":"ASBESTOS","value":"ASBESTOS"},{"label":"DAMP","value":"DAMP"},{"label":"HEALTH AND SAFETY","value":"HEALTH AND SAFETY"},{"label":"DIRTY PROPERTY","value":"DIRTY PROPERTY"},{"label":"INFESTATION","value":"INFESTATION"},{"label":"TENENT DAMAGE","value":"TENENT DAMAGE"},{"label":"RECHARGE","value":"RECHARGE"},{"label":"OTHER","value":"OTHER"}],"expressions":{"show":"$store.pages.RaiseIncident.incidentType.value == \"PROPERTY\""}},{"name":"incidentDescription","type":"user-input","item-type":"text","_auto_id_":"b47e7d28-a962-4a9b-a915-81f3b91fc0a9","label":"Description:","required":true,"multiline":true,"debounce":250,"expressions":{},"message":"This is a required field"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"6c2971cc-dff4-453a-83a1-e14fe3e14a02","extends":{"type":"area","item-type":"row"},"content":[{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"4ed87729-f8de-44aa-b3f1-896092660cc0","content":"Cancel","theme":"default","expressions":{},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.destroyPageData('RaiseIncident');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"dccdc3b7-15bb-498e-92ef-3c4ef657c301"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"088a985d-ee0d-45a8-a0e7-cd5a954a56fc","content":"Submit","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.lastJobEvent === undefined) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_nopreviousjob\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warnings\",\n      \"title\" : \"Warning: No previous Job completed\",\n      \"text\" : \"You can not Raise an Incident as you have yet to complete any Jobs today. Please complete a Job before Raising an Incident.\"\n    }\n  );\n} else {\n  cti.fnOpenSpinner('Raising Incident...');\n  \n  var incidentType = cti.store.pages.RaiseIncident.incidentType.value;\n  var incidentDescription = cti.store.pages.RaiseIncident.incidentDescription;\n  var subType = \"\";\n\n  if(incidentType == \"CUSTOMER\") {\n    subType = cti.store.pages.RaiseIncident.incidentCustomerType.value;\n  } else {\n    subType = cti.store.pages.RaiseIncident.incidentPropertyType.value;\n  }\n\n  var lastJob = cti.store.jobs.lastJobEvent;\n  \n  cti.store.payloads.raiseIncidentPayload = {\n    \"jobID\": lastJob.aAccuServJobID,\n    \"incident\": {\n      \"sIncidentType\": incidentType,\n      \"sIncidentSubType\": subType,\n      \"sIncidentDescription\": incidentDescription,\n      \"sPropertyID\": lastJob.sPropertyID,\n      \"sOperativeID\": lastJob.sOperativeID\n    }\n  }\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"RaiseIncident\" });\n}"},"_auto_id_":"4c8c2ee3-521e-485a-8acc-92305e1d570d"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"RequestJob","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"8e27a845-0f70-4dbb-a708-b98404199f8f","attributes":{},"expressions":{}},{"name":"html_header","type":"content","item-type":"html","_auto_id_":"5b42ad45-2e0f-42a8-afaa-0dfa3650f0ab","content":"<h4 class=\"title\">Request OOH Job</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"cfd20726-309e-46b2-8a23-20b071b9d4af","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"d4a4056e-2518-4aa7-bad6-ff28581e29c7","function":"open"},"_auto_id_":"2f528a71-1ce9-4f08-90a2-fa1f1bb17ad9"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"bd5dde90-f191-444c-adfe-86f9d8faa2cf","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"e11c4ff9-b13f-4592-b6e4-7ae19d4d69e7"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"3c18027f-89ec-42da-aaf7-ca1c59ec827f","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"792caf37-54e7-4bb5-ad33-0f4bfb660787"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"120d6452-ed2a-4e08-ab01-c43328b00a61","content":"Job Map","theme":"default","expressions":{"show":"$store.jobs.jobList.length > 0"},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"f8e5cf54-274e-442f-a138-37f6ba9a7eee"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"08ebf030-00b5-4585-a6be-48d9d840e413","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"44e065ca-f352-4ddd-a94b-ea2fa42ef4e3"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"d4a4056e-2518-4aa7-bad6-ff28581e29c7","attributes":{},"expressions":{}}],"_auto_id_":"acc978e7-4bac-4c75-8fe9-916116d4916f","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"079db61e-d303-47fc-81f8-e0a9b7004d69","content":[{"name":"html_override","type":"content","item-type":"html","_auto_id_":"c56bafe5-bf4c-44c5-8278-4d045dcb21ed","content":"<p>In order to request an OOH, please fill in the form below before submitting.</p>\n<hr>","expressions":{}},{"name":"clientOrderNumber","type":"user-input","item-type":"text","_auto_id_":"27ce9a08-e2e5-4af3-ab35-668ef977c89e","label":"Client Order Number:","required":true,"multiline":false,"debounce":250,"message":"This is a required field","expressions":{}},{"name":"addressLineOne","type":"user-input","item-type":"text","_auto_id_":"ea1bcf3b-ace3-4bf6-a970-806a8e7534ac","label":"Address Line One:","required":true,"multiline":false,"debounce":250,"message":"This is a required field","expressions":{}},{"name":"addressLineTwo","type":"user-input","item-type":"text","_auto_id_":"47d26129-851f-4f99-9bd5-73f1f2e621ae","label":"Address Line Two:","required":true,"multiline":false,"debounce":250,"expressions":{},"message":"This is a required field"},{"name":"postcode","type":"user-input","item-type":"text","_auto_id_":"c0ff7f3d-9419-48b1-a0cb-28652b391719","label":"Postcode:","required":true,"multiline":false,"debounce":250,"expressions":{},"message":"This is a required field"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"7d29152b-df7c-4b1e-9056-3228b03684c5","extends":{"type":"area","item-type":"row"},"content":[{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"0093413d-95e3-4952-9403-9aef8b28d120","content":"Cancel","theme":"default","expressions":{},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.destroyPageData('RequestJob');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"1c0102e3-c72d-46b7-802b-ebc3a2e4440a"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"eb3326da-7677-48ab-9c99-aabb91a2a524","content":"Submit","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Requesting OOH Job...');\n\ncti.store.payloads.requestJobPayload = {\n  \"sOperativeID\": cti.store.currentProfile.username,\n  \"sAddressLine1\": cti.store.pages.RequestJob.addressLineOne,\n  \"sAddressLine2\": cti.store.pages.RequestJob.addressLineTwo,\n  \"sPostCode\": cti.store.pages.RequestJob.postcode,\n  \"sClientCode\": cti.store.pages.RequestJob.clientOrderNumber\n};\n\ncti.utils.callAction('call-actionflow', { \"name\": \"RequestJob\" });"},"_auto_id_":"8f071df4-99ab-4629-8b66-2b2d15a3b532"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"AdHocPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"d3707a47-b059-45f9-a14c-9c51e16edef0","content":"<h4 class=\"title\">Ad Hoc Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"7610c7a0-843a-4582-9a26-b0648cd5f417","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecks","componentInstanceId":"b0812921-4d1c-46e0-bec6-ce29740a5e91","function":"open"},"_auto_id_":"2c6d3713-3721-4f79-92c1-3bc57e5b639c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"0a012f96-22ed-4332-a999-daafd0af70e6","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"2ed2806a-856e-4cd2-9c06-25e07b973bc2"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"c9e04bbe-56c3-443d-aa74-d0ca0000e5b4","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"5a068014-2495-4250-bd34-0fd3ab195e4d"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"b0812921-4d1c-46e0-bec6-ce29740a5e91","attributes":{},"expressions":{}}],"_auto_id_":"8ca64d78-26f7-462c-93d2-68ed07027c24","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"fe019ade-5b77-4576-aa33-0ce9f6a5d6a3","attributes":{},"expressions":{}},{"name":"html_adhocphotos","type":"content","item-type":"html","_auto_id_":"afe3e65f-8429-41c5-a048-aef6d7aa662e","content":"<h4>Ad Hoc Photos</h4>\n<p>If you wish to take any photos throughout the course of the Job (per Ad-Hoc), then please do so here. Below is a list of all photos associated with this job. Photos added from this page will be tagged under the Ad-Hoc Category.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('AdHocPhotos','c2020a1f-3c4e-4df4-8a81-8e653f63a509')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{}},{"name":"takePhoto_btn","type":"button","item-type":"button","_auto_id_":"5561f15f-7ec9-4262-94d5-31c353c7d847","content":"Take Photo","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"AdHocPhotos","componentInstanceId":"c2020a1f-3c4e-4df4-8a81-8e653f63a509","function":"takePhoto"},"_auto_id_":"4340cedd-de12-4b8d-a8e5-ff2667dcb8b7"}],"classes":"takephoto-btn"},{"name":"AdHocPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"98807067-3c95-452a-9d3d-74d7a04fa651","_auto_id_":"c2020a1f-3c4e-4df4-8a81-8e653f63a509","attributes":{"captureCategory":"Ad Hoc","displayCategory":"Ad Hoc","maxPhotos":3},"expressions":{},"actions":[{"event":"maxPhotosTaken","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"app_genericwarning","title":"Photos","text":"You have taken the maximum number of photos for pre-work evidence."},"_auto_id_":"38cac880-01a2-4e6e-aaa3-ffc6f77fdd2d"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"74d63f98-4d4b-48eb-97d3-b41437485856","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"12197ef7-7b06-430f-b669-e08e7798a44e","content":"Back","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.fromPhotoDetail;\nvar lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastTakePhotoPage));\ndelete cti.store.variables.lastTakePhotoPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"9cc7af83-ea75-4ae7-9964-15cf8c6d8f9c","actions":[]}]}],"expressions":{}}],"_auto_id_":"9fa86e91-fc80-427e-8f77-aacf057f596a","expressions":{}}]},{"start":false,"name":"Completion","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"194b87a4-ed39-4753-8a84-bd172edb8e32","content":"<h4 class=\"title\">Complete Job</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"3d460e36-e8da-4617-8613-c3e05b1e6591","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"Completion","componentInstanceId":"5affb76a-d8d9-4d33-ab81-662db5ceba77","function":"open"},"_auto_id_":"5b6efbf6-e00a-4a3b-94bf-7d5929686a9c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"fe30a959-3bf7-489e-b1dd-d840dd26deab","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"c29ed6fd-4317-4b01-89ae-fd3d9e885792"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"2e3553a1-b61e-4562-af8b-a11d753fd523","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e0e3571f-51e1-44ce-8795-f63ded4d38ac"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"9b080511-3c0c-433f-8f89-7587f3fb96a3","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a369886c-237d-445a-a6ff-170359fcb429"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"acce1ee5-5e91-4d65-9de4-cf44b9c03427","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"40fb9bdd-85e6-46f3-9ea5-51dfbc725d8c"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"ca916d7d-8d54-4737-965e-d16c7482d52b","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"3fde139a-6978-4cc9-a000-3b8227b2f40e"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"5affb76a-d8d9-4d33-ab81-662db5ceba77","attributes":{},"expressions":{}}],"_auto_id_":"dabbac89-a793-408e-8075-205188b07f9f","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"b73f4e67-4748-430b-9a96-3f767c97a0e9","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"8a3369e3-99a4-43b1-abbe-691a95d2f974","attributes":{},"expressions":{}},{"name":"operativeComments","type":"user-input","item-type":"text","_auto_id_":"112c9a60-71b1-4e41-a549-36dea69aa1fd","label":"Operative Comments:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.variables.confirmJobComplete != true"},"message":"This is a required field"},{"name":"operativeSignature","type":"user-input","item-type":"signature","_auto_id_":"360a83b5-c3ef-4d63-93b6-59aa1dee8cae","label":"Signature: ","required":true,"expressions":{"show":"$store.variables.confirmJobComplete != true"},"message":"This is a required field"},{"name":"confirmJobCompletion","type":"content","item-type":"html","_auto_id_":"ee3a668c-ae16-42ce-a285-45e333c237c9","content":"<h3 style=\"\n    text-align: center;\n    margin-top: 20px;\n    color: green;\n\">Confirmation</h3>\n<p style=\"\n    text-align: center;\n    color: green;\n\">The task is now complete and ready to be sent. Once sent, no further changes can be made.</p>\n<p style=\"\n    text-align: center;\n    color: green;\n    font-weight: bold;\n\">Are you sure you wish to send the task?</p>","expressions":{"show":"$store.variables.confirmJobComplete == true"}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"84dcb2fb-d19f-4996-88da-3ac653debab9","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"45f32c5b-eb9b-4722-b7ca-20d013fedcff","content":"Previous","theme":"default","expressions":{"show":"$store.variables.confirmJobComplete != true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigatePO(cti.store.state.currentPage);"},"_auto_id_":"9ada13ca-96cd-430b-9368-fdff6931cd21"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"9bb5c306-1402-4cf4-b05a-e6a7f983f56b","content":"Complete Job","theme":"default","expressions":{"disabled":"$form.invalid","show":"$store.variables.confirmJobComplete != true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.confirmJobComplete = true;\ncti.utils.updatePage();"},"_auto_id_":"0ff7e2d1-e795-4645-b3f1-e2e653948ecf","actions":[]}]},{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"cb5ae662-cc73-4b78-89da-728663cb94ed","content":"No","theme":"default","expressions":{"show":"$store.variables.confirmJobComplete == true"},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.confirmJobComplete = undefined;\ncti.utils.updatePage();"},"_auto_id_":"ac7275e6-05c5-4ca2-969c-06a4db284e83"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"6cdb0e65-1c9b-4b60-883e-cd9836edc0b4","content":"Yes","theme":"default","expressions":{"show":"$store.variables.confirmJobComplete == true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.jobEventStatus = \"jobcomplete\";\ncti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });"},"_auto_id_":"210a63ca-bc7d-4714-a06f-9728fd14a976","actions":[]}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"OTCCodes","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"ef1c7fd4-b7d0-4755-b9ad-aa2e142f3839","actions":[{"event":"onload","type":"call-function","data":{"name":"fnSearchPanel","params":{"menuOption":"{{$store.variables.menuOption}}"}},"_auto_id_":"26c23882-6d9f-44f0-b193-b72ff6923bb7"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"f436e929-6bb8-4925-ae3d-d1e98cdd024b","content":"<h4 class=\"title\">Purchase Order Stock</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"e523d2b3-73aa-4a89-89d9-0111a86e3430","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"OTCCodes","componentInstanceId":"fe96a102-1695-46f0-94dc-11132b6cc31e","function":"open"},"_auto_id_":"d7e49dbd-0ff4-4631-aeed-9483049d92d3"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"bdc36e48-feef-45db-ac0b-349d448a47a0","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"51e7a562-b0a8-42d8-97dd-ce5bedfc73c7"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"13a2e266-4ad0-4445-9f31-b40e4b9137f9","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"1653c0c4-688d-4526-a5d4-2dbb733081a1"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"55a4e030-27fc-4dc1-a2e8-5e41d3ceabeb","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"db48ef2a-cb04-44e6-9c91-7f398abc88ea"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"087afb7a-f585-484f-96bc-02cad0e64b72","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"Warnings","componentInstanceId":"19d66f33-fd24-4e81-a674-468947fe1091","function":"show"},"_auto_id_":"84471cba-3620-42b9-bb85-19991593c1ef"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a68cc4f2-5fa1-46d2-ac10-e29225928a71"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"607a1c3b-b680-4562-98a3-c4c5d8cc12a8","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8dd1e099-cd13-40b5-823d-5e91b4d264e8"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"d296b87e-bcf7-4adf-a523-2bb400d34598","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"dc8fc886-b126-4734-bbf7-5a2fa5b4114e"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"eed64dfe-b174-48bb-b6f0-00f3e00e4b96","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"c1367431-c165-47a0-a363-b1e05148b8ce"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"fe96a102-1695-46f0-94dc-11132b6cc31e","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"7051a581-5ee1-43ee-a29a-4db843d3d6ac","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_otcstocklocation","type":"content","item-type":"html","_auto_id_":"61e94c66-1190-4532-a3e2-19c53ca9b0e5","content":"<h4>Purchase Order Stock Location: <span style=\"color:#0072C6;\">{{'$store.variables.selectedLocation.sLocation'|store}}</span></h4>\n<hr>\n<div id=\"panel\" class=\"sor-schedules-panel\">\n  <div id=\"schedules\" class=\"sor-schedules-schedules\" onclick=\"cti.fnSearchPanel('schedules');\">PO Stock</div>\n  <div id=\"search\" class=\"sor-schedules-search\" onclick=\"cti.fnSearchPanel('search');\">Search</div>\n</div>","expressions":{}},{"name":"SearchAllOTCStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"55b24a7c-9cde-4da4-95b2-8ab725ae8165","_auto_id_":"72f0e86f-2b44-4812-af6d-f0dadef8d158","attributes":{"sourceObjectArrayName":"","displayArrayName":"cti.store.variables.otcStockSearchResults","displayListIfNoSearch":0,"maxResults":50,"minCharacters":3,"locationFilter":"","pouchDB":"otc"},"expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[]},{"name":"htmlSearchHint","type":"content","item-type":"html","_auto_id_":"ad081aef-a037-463b-a839-16a2d73ba444","content":"<p style=\"padding-top:10px;\">Please use the search facility above to find Purchase Order Stock codes that your require. The search facility is free text.</p>","expressions":{"show":"($store.variables.otcStockSearchResults===undefined || $store.variables.otcStockSearchResults.length==0) && $store.variables.menuOption === \"search\""}},{"name":"list_otcstock","type":"content","item-type":"list","_auto_id_":"d545677c-647c-458d-bbb6-443956fd4918","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Adding OTC Stock...');\n\nif(cti.store.jobs.selectedJob.aOTCStock == undefined) {\n  cti.store.jobs.selectedJob.aOTCStock = [];\n}\n\nvar otcStock = cti.store.jobs.selectedJob.aOTCStock;\nvar code = {{$data.$item}};\nvar exisits = false;\n\nvar codeObj = code;\ncodeObj.sLocation = cti.store.variables.selectedLocation.sLocation || \"NOLOCATION\";\ncodeObj.nOrderQty = 1;\n\nfor(var i in otcStock) {\n  if(otcStock[i].sCode == codeObj.sCode) {\n    if(otcStock[i].sLocation == codeObj.sLocation) {\n      exisits = true;\n      break;\n    }\n  }\n}\n\nif(!exisits) {\n  otcStock.unshift(codeObj);\n  \n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodeadded\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"success\",\n      \"title\" : \"OTC Stock Added\",\n      \"text\" : \"You have successfully added this Over The Counter item to your Purchase Order.\"\n    }\n  );\n\n  cti.utils.callAction('call-component-function', { \"page\" : \"OTCCodes\",\"componentInstanceId\":\"07983c39-233d-4152-9809-2d67d24e1054\",\"function\":\"bind\"});\n  cti.utils.updatePage();\n  \n  cti.store.variables.menuOption = \"schedules\";\n  cti.fnSearchPanel(cti.store.variables.menuOption);\n} else {\n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have already added this OTC Stock Item to the Purchase Order.\"\n    }\n  );\n}"},"_auto_id_":"09c9e2f4-60ba-44b3-b6a1-df8ef7d412b8"}],"model":"$store.variables.otcStockSearchResults","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_otcstock_html","_auto_id_":"0768aa0b-bb26-4078-a9e8-c65e6c449a90","content":"<div style=\"display:block;width:100%;padding-bottom:10px;\">\n  <div style=\"font-weight:bold;\">Catalogue Stock Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>\n<div style=\"display:block;width:100%\">\n  <div>Cost Price: {{$data.$item.sCostPrice}}</div>\n  <div>Sell Price: {{$data.$item.sSellPrice}}</div>\n</div>"}],"pagination":true,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":3},{"name":"SearchJobOTCStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"55b24a7c-9cde-4da4-95b2-8ab725ae8165","_auto_id_":"07983c39-233d-4152-9809-2d67d24e1054","attributes":{"sourceObjectArrayName":"cti.store.jobs.selectedJob.aOTCStock","displayArrayName":"cti.store.variables.otcStockJobSearchResults","displayListIfNoSearch":1,"maxResults":30,"minCharacters":3,"locationFilter":"cti.store.variables.selectedLocation.sLocation"},"expressions":{"show":"$store.variables.menuOption === \"schedules\""},"actions":[]},{"name":"html_otcstockcodesadded","type":"content","item-type":"html","_auto_id_":"2f12f0c1-eedb-4a95-855b-368f44394765","content":"<br>\n<p style=\"padding-top:10px\">Please confirm quantities for the below Purchase Order Stock codes added to this PO.</p>","expressions":{"show":"$store.variables.menuOption === \"schedules\""}},{"name":"list_otcstocksummary","type":"content","item-type":"list","_auto_id_":"14c6b905-9a1f-4ff5-b467-85bac4f34305","search":"","classes":"","expressions":{"show":"$store.variables.menuOption === \"schedules\""},"theme":"bootstrap","model":"$store.variables.otcStockJobSearchResults","actions":[],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_otcstocksummary_html","_auto_id_":"6fa53464-31a4-4162-b29e-427b5b7190a0","content":"<div style=\"display:block;width:100%\">\n  <div style=\"font-weight:bold;margin-bottom:15px;\">Catalogue Stock Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>\n<hr>"},{"name":"HeaderQuantityDone","type":"content","item-type":"html","_auto_id_":"41b7c43f-46e7-4916-8f90-918d2b77bcdc","content":"<div style=\"display:inline-block;width:100%\">\n  <div style=\"display:inline-block;float:right;\">Cost Price: {{$data.$item.sCostPrice}}</div>\n  <div style=\"display:inline-block;float:left;\">Sell Price: {{$data.$item.sSellPrice}}</div>\n</div>\n<div class=\"sor-list-header\">Quantity Required</div>","expressions":{},"classes":""},{"name":"qntyDoneRow","type":"area","item-type":"row","_auto_id_":"a66e0729-db53-470f-b235-a6cfa40c3d08","content":[{"name":"btnUsedMinus","type":"button","item-type":"button","_auto_id_":"a84e77a8-4163-4762-88d4-0881882d3266","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQuantity <1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nOrderQty = $data.$item.nOrderQty - 1;"},"_auto_id_":"0b84d436-032b-464c-99b5-a51b8ba72353"}]},{"name":"QuantityDone","type":"content","item-type":"html","_auto_id_":"9d3b0ce1-9d37-433c-b0c9-d834a62b0d91","content":"{{$data.$item.nOrderQty}}","expressions":{},"classes":"sor-value"},{"name":"btnUsedPlus","type":"button","item-type":"button","_auto_id_":"85b31935-08b7-4e94-9ca9-5ca0d5f97b93","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nOrderQty = $data.$item.nOrderQty + 1;"},"_auto_id_":"efa5b650-8178-4ee8-b764-ce904780a859"}]}],"expressions":{}}]},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"03c6f0e4-7db1-424f-b650-02be9e7a3416","content":"Save","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ndelete cti.store.variables.otcStockSearchResults;\ndelete cti.store.variables.otcStockJobSearchResults;\ndelete cti.store.variables.selectedLocation;\ndelete cti.store.variables.menuOption;\n\ncti.utils.callAction('go-to-page', { \"name\": \"OTCLocationSelect\" });"},"_auto_id_":"83c58ae6-b6a2-4e9a-a200-1cb40ab4719d"}],"classes":"confirm-bar-btn"}],"_auto_id_":"be6746c7-f4e1-4add-a835-1c8c3a350c16","expressions":{}}]},{"start":false,"name":"OTCLocationSelect","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"f0220c96-b1eb-43b4-9437-cc25ed29f5f1","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"$( \"#otcLocationFetch\" ).click(function() {\n  cti.utils.callAction('call-actionflow',{'name':'OnlineStockLocations'});\n});\n\ncti.fnOrderOTCLocations();\n$success();"},"_auto_id_":"3a1a0aea-3ea5-4087-bfa8-fc0b03f35ebf"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"c9294ce5-edfc-462b-9017-917f39cb47c1","content":"<h4 class=\"title\">Purchase Order Location</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"03dcae2a-b9cb-4667-8e88-c611d200e868","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"OTCLocationSelect","componentInstanceId":"eb6fab68-773e-4795-a994-3d4c4a8cdb29","function":"open"},"_auto_id_":"6b450a48-82ce-4ff9-9abf-ba58a3674487"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"daf49122-b727-4d7b-b9d0-b468c60401de","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"0104a76a-524f-4a25-8549-d3b8df25a4ac"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"9c204610-b32a-4cbc-ae56-1805585c5540","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"1745c3e9-caf0-472a-824f-7605a1b2c2ec"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"ab0bbf03-703b-4056-a936-eb6d6d790d7a","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ba0331da-9413-4496-8ea4-72c91cb5c916"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"2c8d53c1-acca-4282-a899-e45539874956","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"Warnings","componentInstanceId":"19d66f33-fd24-4e81-a674-468947fe1091","function":"show"},"_auto_id_":"3dd583e9-cbd0-4a1e-9b2b-4360e9213f35"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"06aa4a40-8a6d-453b-b2db-2f9f60195bc2"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"61f5bd11-7d02-4038-976d-acc1344178aa","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"89635210-5236-4cbc-b2af-838e6224aa96"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"e5732256-70ee-4a21-bc86-5b286f80d50d","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"3f89c554-468f-4ddc-aee1-92b3ebe767ba"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"9adab348-6453-41f8-b6de-cc7851171f8c","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"1106ec04-d42c-4ddb-8acc-1cc67289b89d"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"eb6fab68-773e-4795-a994-3d4c4a8cdb29","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"4bcad911-be66-4611-a459-62a3ef3dc7b4","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"34847e99-114a-446e-a359-7331fe895db8","attributes":{},"expressions":{}},{"name":"html_otcheader","type":"content","item-type":"html","_auto_id_":"dbd94a11-e5f1-4aef-a366-739df0ce8dc5","content":"<div class=\"codes-icon\">\n\t<i class=\"fa fa-file-powerpoint-o\"></i>\n</div>\n<h4 class=\"codes-icon-header\">Order Catalogue Stock Codes</h4>","expressions":{}},{"name":"jobLocationsEmpty","type":"content","item-type":"html","_auto_id_":"63b4c211-3e4a-4588-b779-0568c6555940","content":"<h4 style=\"text-align:center;\">Failed to Download Purchase Order Stock</h4><p style=\"text-align:center;\">Currently you do not have any available Purchase Order Stock on device. Please contact your Supervisor or try downloading the Purchase Order Stock by tapping the below icon.</p>\n<div style=\"color:#0072C6;text-align:center;font-size:30pt;width:100%\" id=\"otcLocationFetch\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.jobLocations == false"}},{"name":"list_location","type":"content","item-type":"list","_auto_id_":"c8aa5d73-1e4a-4551-a3f5-42452c9279dc","search":"","classes":"","theme":"bootstrap","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Loading Order Catalogue...');\n\ncti.store.variables.selectedLocation = {{$data.$item}};\n\nwindow.appManager.loadFromDatabase('otcdatafull', function (doc) {\n  var fullStock = doc.data;\n  var stock = [];\n  var filter = cti.store.variables.supplierOTCFilter;\n  \n  for(var i in fullStock) {\n    var stockItem = fullStock[i].sAttrib1.trim();\n    \n    if(filter === \"\" || filter === undefined) {\n      stock.push(fullStock[i]);\n    } else if(stockItem === filter) {\n      stock.push(fullStock[i]);\n    }\n  }\n\n  window.appManager.saveToDatabase(\"otcdata\", stock, function(rev) {\n      window.appManager.loadFromDatabase('otcdata', function (doc) {\n        var otcStock = cti.store.jobs.selectedJob.aOTCStock;\n        var selectedLocation = cti.store.variables.selectedLocation;\n        \n        var exists = false;\n\n        for(var i in otcStock) {\n          if(otcStock[i].sLocation == selectedLocation.sLocation) {\n            exists = true;\n            break;\n          }\n        }\n\n        if(exists) {\n          cti.store.variables.menuOption = \"schedules\";\n        } else {\n          if(selectedLocation.sOTCStockQuantity != 0) {\n            cti.store.variables.menuOption = \"schedules\";\n          } else {\n            cti.store.variables.menuOption = \"search\";\n          }\n        }\n\n        cti.store.variables.otcStockSearchResults = [];\n        var count = 50;\n\n        for(var i in doc.data) {\n          if(count === 0) {\n            break;\n          } else {\n            count--;\n            cti.store.variables.otcStockSearchResults.push(doc.data[i]);\n          }\n        }\n        \n        cti.utils.callAction('go-to-page', { \"name\": \"OTCCodes\" });\n\n        $success();\n      }, function (reason, err) {\n        cti.fnCloseSpinner();\n        cti.utils.callAction('call-actionflow', { \"name\": \"OnlineOTCCodes\" });\n      });\n      $success();\n    }, function(reason, e) {\n      window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n      $success();\n  });\n}, function (reason, err) {\n  cti.fnCloseSpinner();\n  cti.utils.callAction('call-actionflow', { \"name\": \"OnlineOTCCodes\" });\n});"},"_auto_id_":"6657a6c6-db27-4472-9b53-4317c1157291","actions":[]}],"model":"$store.jobs.locationsOTCStock","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_location_html","_auto_id_":"5e8edf60-c2a6-4cf3-8276-55c04c7e3337","content":"<div class=\"list-item-container\">\n  <div class=\"list-location\">{{$data.$item.sDescription}} <span style=\"color:#0072C6\">{{$data.$item.sOTCStockQuantity}}</span></div>\n  <div class=\"{{$data.$item.sLocationClass}}\"></div>\n</div>"}]},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"b366072c-ff4a-43b7-8bda-411ffc51ed6b","content":"Show More","theme":"default","expressions":{"show":"$store.variables.showFullLocations === false || $store.variables.showFullLocations === undefined"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = true;\ncti.fnOrderOTCLocations();"},"_auto_id_":"e8eeb93b-4aaa-4571-b037-4b06ba46b5de"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"8ff9c232-763b-4ab2-af43-e0519d7d175c","content":"Show Less","theme":"default","expressions":{"show":"$store.variables.showFullLocations === true"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ncti.fnOrderOTCLocations();"},"_auto_id_":"f0e6f2be-086e-426e-ac84-a86a5a7daa58"}],"classes":"showlist-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"3f33ffc8-f8ab-4a55-808d-0ac946406e81","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"b6ac2161-4e32-4882-b3ce-8625708c3ef7","content":"Back","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.showFullLocations;\ndelete cti.store.variables.jobLocations;\n\ncti.utils.callAction('go-to-page', { \"name\": \"OTCPurchases\" });"},"_auto_id_":"1fa939e7-399a-49c2-9bef-0b3e894fff8e"}],"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"dc6bbda8-c8d7-4507-a3c4-6df38b8fa90b","expressions":{}}]},{"start":false,"name":"OTCPurchases","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"972ef8df-3fd7-4781-a824-2a73ab2c39bf","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var job = cti.store.jobs.selectedJob;\n\nif(job.aOTCStock === undefined) {\n  job.aOTCStock = [];\n}\n\nif(job.aOTCStock.length > 0) {\n  cti.store.variables.poStock = true;\n} else {\n  cti.store.variables.poStock = false;\n}\n\ncti.utils.updatePage();"},"_auto_id_":"990e5e34-b606-47cf-8889-398ed74790f5"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"e76dd9c0-d767-423a-8ffa-2291a4edf324","attributes":{},"expressions":{},"actions":[]},{"name":"html_header","type":"content","item-type":"html","_auto_id_":"cd91eb49-5053-4a39-87b4-94c05389eb2d","content":"<h4 class=\"title\">Purchase Order</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"592b8f88-65b9-48bf-8175-ee15197fd015","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"SpecialPurchases","componentInstanceId":"7fef754b-d586-4493-a200-855e51f4d3af","function":"open"},"_auto_id_":"c28adaef-4630-450b-bdfd-7ea80bc2be61"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"07ac675b-ca3e-48d2-962b-155f51a362ef","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"868bba34-a1be-45fe-99bf-d23517dcf6c5"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"2cfa7cce-395f-4f0d-b70c-a3c38f965e20","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"77e6c417-218d-4a5d-9f1b-47273c300e26"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"fa589497-ef48-479b-bcb5-7e3927dc89e1","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"61632dc6-1ee4-44d1-af3d-0247d914bc62"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"f49eb2ae-5ec9-4cbe-bf00-436bd87e74c9","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"75e889d7-7db4-4b28-b879-4911b2b6f470"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"c582d9a3-45a6-4146-b2b2-086422aaf1a8","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"361db3d8-0691-4015-ac25-a47d5a0c7feb"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"a85dc36f-6915-42de-9b86-fb7cc0175d85","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"9d8ebed0-b326-4acd-944f-3b659c19042c"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"adcacc8f-4bb4-4c6d-92d2-25332c7a72e3","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"ddc8e290-2450-4b1f-bc13-a51a5183a9f1"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"7fef754b-d586-4493-a200-855e51f4d3af","attributes":{},"expressions":{}}],"_auto_id_":"3539e05d-d92a-4b97-9d59-a187b7233e3f","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"7aa56b42-cdd7-44b1-8205-3bb6366a8f5f","content":[{"name":"html_specialorderheader","type":"content","item-type":"html","_auto_id_":"577361ef-6379-4f6a-b5bd-bfea587deed7","content":"<p>If you require a part to complete the job, please raise a PO for it here. You can add as many stock codes to the order as you wish, but can only submit 1 PO per job. Once the PO has been raised you can not raise another.</p>\n<hr>","expressions":{}},{"name":"html_poraised","type":"content","item-type":"html","_auto_id_":"417f618d-c3f7-437c-ad38-262b4867141f","content":"<div class=\"purchase-order\">\n\t<i class=\"fa purchase-order-icon\"></i>\n</div>\n<h4 class=\"purchase-order-header\">Purchase Order Raised</h4>","expressions":{"show":"$store.variables.poRaised === true"}},{"name":"specialorder_btn","type":"button","item-type":"button","_auto_id_":"5e1002d0-cdbd-4707-8980-8abc9ec83969","content":"Raise Purchase Order","theme":"default","expressions":{"show":"$store.variables.specialOrder != true && $store.variables.poRaised != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.specialOrder = true;\ncti.utils.updatePage();"},"_auto_id_":"b951bc85-f993-4716-bdc4-3342b99d6564"}],"classes":"travel-btn"},{"name":"html_jobnumber","type":"content","item-type":"html","_auto_id_":"902fd4a1-2af1-42d8-b4eb-f5336fa9a7ec","content":"<h4>Job No. {{'$store.jobs.selectedJob.aAccuServJobID.sJobNo'|store}}</h4>","expressions":{"show":"$store.variables.specialOrder == true"}},{"name":"orderSupplier","type":"choice","item-type":"select","_auto_id_":"f5e87259-5ece-4ae6-97da-1fee91e6759c","label":"Supplier:","required":true,"options":[],"expressions":{"show":"$store.variables.specialOrder == true"},"message":"This is a required field","option-source":"$store.staticData.stockSuppliers","label-property":"sName","value-property":"sName","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"var suppliers = cti.store.staticData.stockSuppliers;\nvar selectedSupplier = cti.store.pages.OTCPurchases.orderSupplier.value.replace(/ /g,'');\nvar deliveryMethod = cti.store.pages.OTCPurchases.orderDeliveryMethod;\nvar depots = [];\n\nfor(var i in suppliers) {\n  var thisSupplier = suppliers[i];\n  var supplierName = thisSupplier.sName.replace(/ /g,'');\n\n  if(supplierName === selectedSupplier) {\n    var depotsOnSupplier = thisSupplier.aSupplierDepots;\n\n    if(depotsOnSupplier.length > 0) {\n      for(var x in depotsOnSupplier) {\n        var thisDepot = depotsOnSupplier[x];\n        \n        var depot = {\n          \"sAddressLine1\" : thisDepot.sAddressLine1.trim() + ', ' + thisDepot.sPostcode.trim(),\n          \"sDepNo\" : thisDepot.sDepNo.replace(/ /g,'')\n        }\n        \n        depots.push(depot);\n      }\n    } else {\n      var dummyDepot = {\n        \"sAddressLine1\" : \"NO DEPOTS AVAILABLE\",\n        \"sDepNo\" : \"0\"\n      }\n\n      depots.push(dummyDepot);\n    }\n    break;\n  }\n}\n\ncti.store.staticData.stockSupplierDepots = depots;\ncti.store.pages.OTCPurchases.orderDepot = undefined;\n\ncti.utils.updatePage();"},"_auto_id_":"2ab7b571-eea6-4cf1-adba-33f29007caa7"}]},{"name":"orderDepot","type":"choice","item-type":"select","_auto_id_":"e1a88649-c2f6-4c73-b6ec-3771eb9d1c76","label":"Branch:","required":true,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"expressions":{"show":"$store.variables.specialOrder == true && $store.pages.OTCPurchases.orderSupplier != undefined"},"option-source":"$store.staticData.stockSupplierDepots","label-property":"sAddressLine1","value-property":"sDepNo","actions":[],"message":"This is a required field"},{"name":"orderDeliveryMethod","type":"choice","item-type":"select","_auto_id_":"251160cb-fc66-4268-9e4a-246622d4ec31","label":"Delivery Method:","required":true,"options":[{"label":"COLLECTION","value":"COLLECTION"},{"label":"DELIVERY TO SITE","value":"DELIVERY TO SITE"},{"label":"CONTRACT OPERATIVE","value":"CONTRACT OPERATIVE"}],"expressions":{"show":"$store.variables.specialOrder == true && $store.pages.OTCPurchases.orderDepot != undefined"},"message":"This is a required field","actions":[]},{"name":"orderDeliveryDate","type":"user-input","item-type":"date","_auto_id_":"6120d4f3-b7f9-4478-833d-b3d402c60623","label":"Requested Delivery Date: ","required":false,"left-icon":"fa-calendar","options":{"min":"current","selectYears":false,"selectMonths":false,"max":""},"validators":[],"actions":[],"expressions":{"show":"$store.variables.specialOrder == true"}},{"name":"orderDescription","type":"user-input","item-type":"text","_auto_id_":"0dff18f9-4a6a-4809-8256-324a098a6a81","label":"Order Description:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.variables.specialOrder == true"},"message":"This is a required field"},{"name":"addStock_btn","type":"button","item-type":"button","_auto_id_":"2576cb43-7ea8-446f-868f-773985eeb5e4","content":"Add Stock","theme":"default","expressions":{"show":"$store.variables.specialOrder == true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var suppliers = cti.store.staticData.stockSuppliers;\nsupplierSelected = \"\";\n\nif(cti.store.pages.OTCPurchases != undefined) {\n  if(cti.store.pages.OTCPurchases.orderSupplier != undefined) {\n\tvar value = cti.store.pages.OTCPurchases.orderSupplier.value;\n    supplierSelected = value.replace(/ /g,'');\n  }\n}\n\nfor(var i in suppliers) {\n  var thisSupplier = suppliers[i];\n  var thisSupplierName = thisSupplier.sName.replace(/ /g,'');\n  \n  if(thisSupplierName === supplierSelected) {\n    cti.store.variables.supplierOTCFilter = thisSupplier.sAttrib1.trim();\n    break;\n  }\n}\n\n\nif(cti.store.variables.supplierOTCFilter != undefined) {\n  cti.utils.callAction('go-to-page', { \"name\": \"OTCLocationSelect\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You must select a Supplier from the list above before adding any Catalogue stock to your Purchase Order.\"\n    }\n  );\n}"},"_auto_id_":"2b12ac01-42f6-4e1a-a6cb-36aef0a82901"}]},{"name":"html_nostock","type":"content","item-type":"html","_auto_id_":"da4e0eff-0ec7-484a-8dce-83a84584c5a8","content":"<div class=\"purchases-area\"><h4 class=\"centered-text\">You have 0 Stock Items added to the Purchase Order</h4><p class=\"centered-text\">Currently you do not have any Stock Codes added to your Purchase Order. Please add at least 1 code before continuing with the Purchase Order.</p>\n</div>","expressions":{"show":"$store.variables.specialOrder === true && $store.variables.poStock === false"}},{"name":"orderStock","type":"content","item-type":"list","_auto_id_":"2eb106fa-623f-4b46-af30-39f806a63961","search":"","classes":"","expressions":{"show":"$store.variables.specialOrder === true && $store.variables.poStock === true"},"theme":"bootstrap","model":"$store.jobs.selectedJob.aOTCStock","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"orderStock_html","_auto_id_":"9e76b890-a0b2-4380-82f4-6ab44cdfcbb6","content":"<div style=\"display:block;width:100%\">\n  <div style=\"font-weight:bold;\">Catalogue Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>\n<hr>\n<div style=\"display:block;width:100%\">\n  <div>Cost Price: {{$data.$item.sCostPrice}}</div>\n  <div style=\"float:right;\">Quantity: {{$data.$item.nOrderQty}}</div>\n  <div>Sell Price: {{$data.$item.sSellPrice}}</div>\n</div>"}],"actions":[]},{"name":"button_bar_nav","type":"area","item-type":"button-bar","_auto_id_":"470ee7f2-0c97-49cf-80a8-b0900a60b123","extends":{"type":"area","item-type":"row"},"content":[{"name":"cancel_btn","type":"button","item-type":"button","_auto_id_":"d788bd16-4bb7-458e-864d-b33dd37ef844","content":"Cancel","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.jobs.selectedJob.aOTCStock;\ndelete cti.store.jobs.selectedJob.aPurchaseOrder;\n\ncti.utils.destroyPageData('OTCPurchases');\ncti.store.variables.specialOrder = false;\ncti.utils.updatePage();"},"_auto_id_":"6195d49e-2065-4b9b-9cf5-acca6b8a2b9d"}],"classes":"deletephoto-btn"},{"name":"placeorder_btn","type":"button","item-type":"button","_auto_id_":"fb658566-9e20-41e1-9dbd-61b155f42028","content":"Raise PO","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.aPurchaseOrder == undefined) {\n  cti.store.jobs.selectedJob.aPurchaseOrder = {};\n}\n\nif(cti.store.jobs.selectedJob.aOTCStock == undefined) {\n  cti.store.jobs.selectedJob.aOTCStock = [];\n}\n\nvar job = cti.store.jobs.selectedJob;\nvar selectedSupplier = cti.store.pages.OTCPurchases.orderSupplier.value.replace(/ /g,'');\nvar suppliers = cti.store.staticData.stockSuppliers;\n\nfor(var i in suppliers) {\n  if(selectedSupplier == suppliers[i].sName.replace(/ /g,'')) {\n    var supplierCode = suppliers[i].sAccountCode1.replace(/ /g,'');\n    break;\n  }\n}\n\nvar purchaseOrder = {\n  \"sOperativeID\": job.aOperativeDetail.sOperativeID,\n  \"sSupplierCode\": supplierCode,\n  \"dOrderDate\": moment().format('YYYY-MM-DD'),\n  \"dDeliveryDate\": moment(cti.store.pages.OTCPurchases.orderDeliveryDate).format('YYYY-MM-DD'),\n  \"sDeliveryMethod\": cti.store.pages.OTCPurchases.orderDeliveryMethod.value,\n  \"sSpecicalInstructions\": cti.store.pages.OTCPurchases.orderDescription,\n  \"sCollectionDepNo\": cti.store.pages.OTCPurchases.orderDepot.value,\n  \"aAccuServJobID\": job.aAccuServJobID,\n  \"aAccuServPOItems\": job.aOTCStock\n};\n\n\nif(purchaseOrder.aAccuServPOItems.length > 0) {\n  cti.store.jobs.selectedJob.aPurchaseOrder = purchaseOrder;\n  cti.store.payloads.purchaseOrderPayload = purchaseOrder;\n  cti.utils.callAction('call-actionflow', { \"name\": \"PurchaseOrder\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You must add at least 1 OTC Stock Item to the Purchase Order.\"\n    }\n  );\n}"},"_auto_id_":"1b3f7e8a-a949-4064-83ca-69f7bbc35f65"}],"classes":"confirm-bar-btn"}],"expressions":{"show":"$store.variables.specialOrder == true && $store.jobs.selectedJob.bJobStartWork === true"}},{"name":"button_bar_order","type":"area","item-type":"button-bar","_auto_id_":"1fb607bc-3dd8-4495-ae57-af5253f79e52","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"bfb62a9d-52e8-453c-a2cf-dae921860c75","content":"Back","theme":"default","expressions":{"show":"$store.variables.poNav === false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.lastPOPage;\n\nif(lastPage == \"VanLocationSelect\") {\n  cti.fnNavigateVanStock(cti.store.state.currentPage);\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": lastPage });\n}"},"_auto_id_":"164ba4f9-1cd5-4a8b-8f8c-0ac9afbbe416"}],"classes":"button-bar-btn"},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"be5c36df-62f5-46f3-90db-83ba74a4fe0c","content":"Previous","theme":"default","expressions":{"show":"$store.variables.poNav === true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigateVanStock(cti.store.state.currentPage);"},"_auto_id_":"84993342-3e6e-4b5b-b465-21ade7f5e704"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"d2849328-14d2-448b-82f6-0b6e70a812c6","content":"Next","theme":"default","expressions":{"disabled":"$store.variables.specialOrder === true","show":"$store.variables.poNav === true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"go-to-page","data":{"name":"Completion","isConditional":false},"_auto_id_":"564e7042-aab0-4476-aaae-4d5f89988ee8"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"VanStockCodes","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"96531333-33f0-47e5-b2c4-5c0795ee7ea2","actions":[{"event":"onload","type":"call-function","data":{"name":"fnSearchPanel","params":{"menuOption":"{{$store.variables.menuOption}}"}},"_auto_id_":"66b6871c-288a-4705-8d60-74863b890082"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"84495cfd-346b-46e9-a89b-f4a76bf3060e","content":"<h4 class=\"title\">Van Stock</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"3bb1ae0a-55d9-44c6-a07b-82448ebebdd9","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"2f659247-5b8c-4994-a47d-7fd7dce0cea3","function":"open"},"_auto_id_":"46506fcf-928b-4b25-8c0c-b496d5d9c5d5"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"268134be-130f-4544-8e04-c843233ab0af","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"3ebeb07c-0fb3-4c5c-9098-adc3c0ed4d02"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"f7c1ee89-a607-4b02-9bb1-3ac31731d7a6","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"c29727c2-bb3e-46c2-a16f-717894d157be"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"78f9f657-501d-4db2-a7ea-84e9bd1cd5d0","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d20f4812-208b-4a66-8c2c-52b44775ad9f"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"f4012068-7400-4877-9bff-bbd80c067b7c","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"VanStockCodes","componentInstanceId":"affaf783-baf1-4e77-aaf8-1baa35f29580","function":"show"},"_auto_id_":"b5957c8e-b416-402e-9a73-088d76b65e48"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"feb606db-b491-4a24-84f7-164b58544207"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"91047513-fcfd-41dd-a982-70f93ffc3f28","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"0e266464-cf3f-4b73-aa30-a8631de58d80"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"e605eb3e-b903-4595-a28e-dac82557e091","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"00c99757-ce88-4567-a9c2-6e86c38248b5"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"983fcfc9-1c50-46e9-96e7-6572dd861ae7","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"06d09414-9657-4c6a-9c8b-2aa99f4e5148"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"affaf783-baf1-4e77-aaf8-1baa35f29580","attributes":{},"expressions":{}}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"2f659247-5b8c-4994-a47d-7fd7dce0cea3","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"293ac4b9-5d1c-41d9-a3eb-d552cc589240","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_vanstocklocation","type":"content","item-type":"html","_auto_id_":"41a52e32-d9a8-4253-8834-25f9894c2922","content":"<h4>Van Stock Location: <span style=\"color:#0072C6;\">{{'$store.variables.selectedLocation.sLocation'|store}}</span></h4>\n<hr>\n<div id=\"panel\" class=\"sor-schedules-panel\">\n  <div id=\"schedules\" class=\"sor-schedules-schedules\" onclick=\"cti.fnSearchPanel('schedules');\">Van Stock</div>\n  <div id=\"search\" class=\"sor-schedules-search\" onclick=\"cti.fnSearchPanel('search');\">Search</div>\n</div>","expressions":{}},{"name":"SearchAllVanStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"55b24a7c-9cde-4da4-95b2-8ab725ae8165","_auto_id_":"14715663-a2a8-4f5d-babe-38acd6be58ae","attributes":{"sourceObjectArrayName":"cti.store.offlineApi.AccuServOffline.vanstock.aOperativeVanStock","displayArrayName":"cti.store.variables.vanStockSearchResults","displayListIfNoSearch":0,"maxResults":30,"minCharacters":3,"locationFilter":""},"expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[]},{"name":"htmlSearchHint","type":"content","item-type":"html","_auto_id_":"8c9dd287-8768-4cfb-af14-57b5cdb40a61","content":"<br>\n<p>Please use the search facility above to find Van Stock codes that your require. The search facility is free text.</p>","expressions":{"show":"($store.variables.vanStockSearchResults===undefined || $store.variables.vanStockSearchResults.length==0) && $store.variables.menuOption === \"search\""}},{"name":"list_vanstock","type":"content","item-type":"list","_auto_id_":"41078491-84e2-46d5-99eb-13cfb5162264","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Adding Van Stock...');\n\nif(cti.store.jobs.selectedJob.aVanStock == undefined) {\n  cti.store.jobs.selectedJob.aVanStock = [];\n}\n\nvar vanStock = cti.store.jobs.selectedJob.aVanStock;\nvar code = {{$data.$item}};\nvar exisits = false;\n\nvar codeObj = code;\ncodeObj.sLocation = cti.store.variables.selectedLocation.sLocation || \"NOLOCATION\";\ncodeObj.nQtyUsed = 1;\n\nfor(var i in vanStock) {\n  if(vanStock[i].sStockCode == codeObj.sStockCode) {\n    if(vanStock[i].sLocation == codeObj.sLocation) {\n      exisits = true;\n      break;\n    }\n  }\n}\n\nif(!exisits) {\n  vanStock.unshift(codeObj);\n  \n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodeadded\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"success\",\n      \"title\" : \"Van Stock Added\",\n      \"text\" : \"You have successfully added this Van Stock item to the Job.\"\n    }\n  );\n\n  cti.utils.callAction('call-component-function', { \"page\" : \"VanStockCodes\",\"componentInstanceId\":\"8d742a88-9c0d-4b70-b7bd-1b8ef96568eb\",\"function\":\"bind\"});\n  cti.utils.updatePage();\n  \n  cti.store.variables.menuOption = \"schedules\";\n  cti.fnSearchPanel(cti.store.variables.menuOption);\n} else {\n  cti.fnCloseSpinner();\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have already added this Van Stock Code to the Job.\"\n    }\n  );\n}"},"_auto_id_":"7dbe92b2-6254-4989-a05d-f9781aa1e612"}],"model":"$store.variables.vanStockSearchResults","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_vanstock_html","_auto_id_":"2849f39f-f8ab-470f-9af9-4cbfeca394b1","content":"<div style=\"display:block;width:100%\">\n  <div style=\"padding-bottom:10px;font-weight:bold;\">Van Stock Code: {{$data.$item.sStockCode}}</div>\n  <div>{{$data.$item.sStockDescription}}</div>\n</div>","expressions":{}}],"pagination":true,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":3},{"name":"SearchJobVanStockCodes","type":"component","item-type":"web-component","content":[],"componentId":"55b24a7c-9cde-4da4-95b2-8ab725ae8165","_auto_id_":"8d742a88-9c0d-4b70-b7bd-1b8ef96568eb","attributes":{"sourceObjectArrayName":"cti.store.jobs.selectedJob.aVanStock","displayArrayName":"cti.store.variables.vanStockJobSearchResults","displayListIfNoSearch":1,"maxResults":30,"minCharacters":3,"locationFilter":"cti.store.variables.selectedLocation.sLocation"},"expressions":{"show":"$store.variables.menuOption === \"schedules\""},"actions":[]},{"name":"html_vanstockcodesadded","type":"content","item-type":"html","_auto_id_":"091f6a3a-7ef5-4965-a514-98f8c17922d4","content":"<br>\n<p>Please confirm quantities for the below Van Stock codes added to this job.</p>","expressions":{"show":"$store.variables.menuOption === \"schedules\""}},{"name":"list_vanstocksummary","type":"content","item-type":"list","_auto_id_":"dee3e2ef-ff22-4580-83a0-8ba38d85992d","search":"","classes":"","expressions":{"show":"$store.variables.menuOption === \"schedules\""},"theme":"bootstrap","model":"$store.variables.vanStockJobSearchResults","actions":[],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_vansummary_html","_auto_id_":"48f729de-9806-4385-8abd-24440a0b0a19","content":"<div class=\"inlineblock-outer\">\n    <div class=\"inlineblock-outer\">\n        <div class=\"sor-header\">{{$data.$item.sStockCode}}</div>\n    </div>\n    <div>{{$data.$item.sStockDescription}}</div>\n</div>\n<hr>","expressions":{}},{"name":"HeaderQuantityDone","type":"content","item-type":"html","_auto_id_":"396b46b8-2b86-4b56-8752-7ebe391f5cad","content":"<div class=\"sor-list-header\">Quantity Done</div>","expressions":{},"classes":""},{"name":"qntyDoneRow","type":"area","item-type":"row","_auto_id_":"fc1f0de6-30be-46a3-b9da-26a80ac0ea97","content":[{"name":"btnUsedMinus","type":"button","item-type":"button","_auto_id_":"f9c8e463-4887-4a95-8955-2d040ba79ec3","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQtyDoneThisVisit<1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyUsed = $data.$item.nQtyUsed - 1;"},"_auto_id_":"d0900607-15e0-4b03-8b05-9a2b53baf607"}]},{"name":"QuantityDone","type":"content","item-type":"html","_auto_id_":"bc355582-a902-4009-8a4e-6d211512c10e","content":"{{$data.$item.nQtyUsed}}","expressions":{},"classes":"sor-value"},{"name":"btnUsedPlus","type":"button","item-type":"button","_auto_id_":"bf7869c7-e3a8-4d0f-9501-62397d3c21dd","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyUsed = $data.$item.nQtyUsed + 1;"},"_auto_id_":"cb5b5294-fca0-4e71-a4e3-a13d1798147b"}]}],"expressions":{}}]},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"a501c120-5453-42fb-ab7c-eca9a3096d4a","content":"Save","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ndelete cti.store.variables.vanStockSearchResults;\ndelete cti.store.variables.vanStockJobSearchResults;\ndelete cti.store.variables.selectedLocation;\ndelete cti.store.variables.menuOption;\n\ncti.utils.callAction('go-to-page', { \"name\": \"VanLocationSelect\" });"},"_auto_id_":"5b6a9b31-2a29-4dcd-9172-d0d28b081516"}],"classes":"confirm-bar-btn"}],"_auto_id_":"a93eff0d-d41a-40fc-bcec-00071c6f2bc1","expressions":{}}]},{"start":false,"name":"VanLocationSelect","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"eb8f577d-0d62-4da6-8dcb-412c2fd03052","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"$( \"#vanLocationFetch\" ).click(function() {\n  cti.utils.callAction('call-actionflow',{'name':'OnlineStockLocations'});\n});\n\ncti.fnOrderVanLocations();\n$success();"},"_auto_id_":"4d62003b-2220-4e15-a52e-b714fdf4f533"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"97c8b480-d3a2-4462-8fa6-184bb57b3dce","content":"<h4 class=\"title\">Van Stock Select Location</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"3dbf88e9-cd0b-412a-9b80-b372e35cb474","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"4a45d9dd-1e30-4f52-86c8-81d0cfbab26a","function":"open"},"_auto_id_":"e875e6ec-76a9-46f5-a7ab-842641467172"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"779d2e60-06a0-4cf2-b25c-5fe1c0f75216","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"32ac459f-80d7-4bd8-ab66-4469ee3de696"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"cd73a980-58c2-4d8c-a86e-d14befca20f7","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"4aa0c85b-edc5-465c-906e-c56092dc9345"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"79436269-2edc-4461-8063-c1a5f52619dd","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"1c098b9b-5a6b-4bae-9fde-bf83815b9ee1"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"d5b6d9ea-3cac-4bba-8421-d78b176403a5","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"VanLocationSelect","componentInstanceId":"8c0c893f-849f-479e-bcce-2ea1f9d75068","function":"show"},"_auto_id_":"ee308bff-0914-47c2-b92e-1f21109a35a6"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"443a73dc-f6b6-49a6-b8f4-104f8a48b4b9"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"b930d18a-efed-4be6-ae65-0a8b59e35c40","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"27f851d6-4a6b-43b1-989f-01f9917900b1"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"236c55b1-6f69-43f9-9410-84b60b78847e","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"55fd33e3-50df-4e4c-a2b5-e8ac1519e641"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"6eac6285-b43e-4c14-a7b1-d36ba7d0b181","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"5bc24606-98ac-4cbf-90d0-100c95bbd6b3"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"4a45d9dd-1e30-4f52-86c8-81d0cfbab26a","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"94939e7d-94da-4e61-8213-0fb9dfc7ba1d","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"8c0c893f-849f-479e-bcce-2ea1f9d75068","attributes":{},"expressions":{}},{"name":"html_vanheader","type":"content","item-type":"html","_auto_id_":"f2a5ce5a-1461-4ba4-a2a2-7ea084f6962e","content":"<div class=\"codes-icon\">\n\t<i class=\"fa fa-truck\"></i>\n</div>\n<h4 class=\"codes-icon-header\">Van Stock Codes</h4>","expressions":{}},{"name":"jobLocationsEmpty","type":"content","item-type":"html","_auto_id_":"5e2f1bc5-685e-4c46-af2b-d2607ec56c1b","content":"<h4 style=\"text-align:center;\">Failed to Download Van Stock Locations</h4><p style=\"text-align:center;\">Currently you do not have any available Van Stock Locations on device. Please contact your Supervisor or try downloading the Stock by tapping the below icon.</p>\n<div style=\"color:#0072C6;text-align:center;font-size:30pt;width:100%\" id=\"vanLocationFetch\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.jobLocations == false"}},{"name":"vanStockEmpty","type":"content","item-type":"html","_auto_id_":"bb0d9000-0154-4c3b-8071-97b189ef3b46","content":"<h4 style=\"text-align:center;\">No Van Stock for Current Operative</h4><p style=\"text-align:center;\">{{'$store.variables.noVanStock'|store}}</p><p style=\"text-align:center;\">Currently you do not have any available Van Stock assigned to your operative ID. Please contact your Supervisor immediately.</p>","expressions":{"show":"$store.variables.noVanStock != undefined"}},{"name":"list_location","type":"content","item-type":"list","_auto_id_":"0d9e776a-b5c4-47c5-af4a-f31c0826214f","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.noVanStock === undefined"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Loading Van Stock...');\n\ncti.store.variables.selectedLocation = {{$data.$item}};\n\nif(cti.store.offlineApi.AccuServOffline.vanstock != undefined) {\n  var stock = cti.store.offlineApi.AccuServOffline.vanstock.aOperativeVanStock;\n  var vanStock = cti.store.jobs.selectedJob.aVanStock;\n  var selectedLocation = cti.store.variables.selectedLocation;\n  var exists = false;\n\n  for(var i in vanStock) {\n    if(vanStock[i].sLocation == selectedLocation.sLocation) {\n      exists = true;\n      break;\n    }\n  }\n\n  if(exists) {\n    cti.store.variables.menuOption = \"schedules\";\n  } else {\n    if(selectedLocation.sVanStockQuantity != 0) {\n      cti.store.variables.menuOption = \"schedules\";\n    } else {\n      cti.store.variables.menuOption = \"search\";\n    }\n  }\n\n  cti.store.variables.vanStockSearchResults = [];\n  var count = 10;\n  \n  for(var i in stock) {\n    if(count === 0) {\n      break;\n    } else {\n      count--;\n      cti.store.variables.vanStockSearchResults.push(stock[i]);\n    }\n  }\n  \n  cti.utils.callAction('go-to-page', { \"name\": \"VanStockCodes\" });\n\n  $success();\n} else {\n  cti.utils.callAction('call-actionflow', { \"name\": \"OnlineVanCodes\" });\n}\n\ncti.fnCloseSpinner();"},"_auto_id_":"6d0c7f56-3658-4d65-adb0-2a9abc7fee86","actions":[]}],"model":"$store.jobs.locationsVanStock","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_location_html","_auto_id_":"1ece46ae-79f3-4e0d-ad10-064ee56e63a7","content":"<div class=\"list-item-container\">\n  <div class=\"list-location\">{{$data.$item.sDescription}} <span style=\"color:#0072C6\">{{$data.$item.sVanStockQuantity}}</span></div>\n  <div class=\"{{$data.$item.sLocationClass}}\"></div>\n</div>"}]},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"347115f6-236e-4b0e-b0f6-b6e29b70bb8e","content":"Show More","theme":"default","expressions":{"show":"($store.variables.showFullLocations === false || $store.variables.showFullLocations === undefined) && $store.variables.noVanStock === undefined"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = true;\ncti.fnOrderVanLocations();"},"_auto_id_":"9a745b57-7341-4db8-a6a4-b1eab876555b"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"83a57cd2-2cba-449e-b84c-8424eca1a448","content":"Show Less","theme":"default","expressions":{"show":"$store.variables.showFullLocations === true && $store.variables.noVanStock === undefined"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ncti.fnOrderVanLocations();"},"_auto_id_":"22e70a1d-900f-412c-a885-9b74a619715c"}],"classes":"showlist-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"db2dd67c-b07c-4d22-831a-5ee6dd54d196","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"30de2846-b65c-4294-bef4-cc6d965833b9","content":"Back","theme":"default","expressions":{"show":"$store.variables.vanNav === false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var lastPage = cti.store.variables.lastVanStockPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"c68442ac-01a4-4431-a81a-a87a2ec578e0"}],"classes":"button-bar-btn"},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"98f4192d-a4f8-4d89-ae07-281ff9991fc3","content":"Previous","theme":"default","expressions":{"show":"$store.variables.vanNav === true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigateSORCodes(cti.store.state.currentPage, true);"},"_auto_id_":"90f7262f-9364-45cc-a954-570fdc875d44"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"1b36d39f-716d-45a6-8583-8ad5cfe75809","content":"Complete","theme":"default","expressions":{"show":"$store.variables.vanNav === true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigatePO(cti.store.state.currentPage);"},"_auto_id_":"34fcc4e4-afc4-4a46-b915-52daab7daac7"}]}],"expressions":{}}],"_auto_id_":"e3d59db4-2ed8-4f29-9b48-5eaab9e996a2","expressions":{}}]},{"start":false,"name":"SORCodes","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"8a5400a3-797c-4dee-aa69-7b0912d83230","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"// Example of setting up handlers do deal with quantity changes from the numeric-toggler components\nfunction valueChangeHandler(e) {\n \te = e || window.event;\n\tvar targ = e.target || e.srcElement;\n    console.log(targ.id + ' has new value = ' + targ.quantity);\n}\n\nvar togglers = document.getElementsByTagName(\"numeric-toggler\");\nfor (var i = 0; i < togglers.length; i++) {\n  togglers[i].removeEventListener('changed', valueChangeHandler);\n  togglers[i].addEventListener('changed', valueChangeHandler, true);\n}\n$success();"},"_auto_id_":"c7affc47-9c33-46e1-970e-4df2eec6cb23","actions":[]},{"event":"onload","type":"call-function","data":{"name":"fnSearchPanel","params":{"menuOption":"{{$store.variables.menuOption}}"}},"_auto_id_":"cf5b5f67-903f-4afd-8fb2-8d3903d46f88"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"bd8c1703-d088-4bc6-a4bd-a9899c2efdf9","content":"<h4 class=\"title\">SOR Codes: <span style=\"color:#0072C6;\">{{'$store.variables.selectedLocation.sDescription'|store}}</span></h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"1a9986e5-459b-4bdf-bfdc-f4249663da2a","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"652dd14b-bd09-45bc-8dc1-81c85ca7ab07","function":"open"},"_auto_id_":"34476410-3ce2-4413-86e9-6870b5ca141c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"fe2b32fa-006d-40b5-aaca-18ceb47f1f37","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle"},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"bfa50128-d368-4653-b2ec-c97b034c0a81","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"e351a4a0-eaaa-4fc0-88c2-a0af90a397f4"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"e761ee3f-2de3-4e22-84c2-328db2fff73a","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"22d96a43-53f9-4187-b701-cf20342e9036"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"0a5812fb-afbf-4c7f-a60f-9cd7e1fd0ff3","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"SORCodes","componentInstanceId":"f95d7065-74cb-4a0b-9b54-2f7cd97c9f2f","function":"show"},"_auto_id_":"70c8c4f0-fc61-435f-8584-c730fc0a6e7c"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"508b8a34-ac78-4e6f-9c97-18fd3b101ff0"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"8a0f2742-3b5f-4677-83a6-fe75cd708a46","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"07d5e904-11b9-41c9-a26d-13ef5812ce52"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"1d0c8551-0461-46cd-a405-79d09e161e44","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"8a912d02-4c83-4953-810c-a048a781b0b7"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"ae33a7a9-aedd-48c2-8999-f3f646be26da","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"fb121f71-6fc2-4150-9701-7ed1047fc759"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"f95d7065-74cb-4a0b-9b54-2f7cd97c9f2f","attributes":{},"expressions":{}}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"652dd14b-bd09-45bc-8dc1-81c85ca7ab07","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"0b06e43c-aae5-47e2-b34b-47247cb7a08b","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"html_sorlocation","type":"content","item-type":"html","_auto_id_":"44dfe4fa-34ef-4dd1-949d-6e8a9968fd9b","content":"<div id=\"panel\" class=\"sor-schedules-panel\">\n  <div id=\"schedules\" class=\"sor-schedules-schedules\" onclick=\"cti.fnSearchPanel('schedules');\">Schedules</div>\n  <div id=\"search\" class=\"sor-schedules-search\" onclick=\"cti.fnSearchPanel('search');\">Search</div>\n</div>","expressions":{}},{"name":"SearchAllSORCodes","type":"component","item-type":"web-component","content":[],"componentId":"55b24a7c-9cde-4da4-95b2-8ab725ae8165","_auto_id_":"37052d11-d5cf-46b3-b86b-749e585e671f","attributes":{"sourceObjectArrayName":"","displayArrayName":"cti.store.variables.sorCodeSearchResults","displayListIfNoSearch":0,"maxResults":50,"minCharacters":3,"locationFilter":""},"expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[],"classes":"sors-all"},{"name":"htmlSearchHint","type":"content","item-type":"html","_auto_id_":"70d652d5-3556-429a-b52f-2c2fd2c3d49b","content":"<br>\n<p>Please use the search facility above to find Schedule Of Rates codes that your require. The search facility is free text.</p>","expressions":{"show":"($store.variables.sorCodeSearchResults===undefined || $store.variables.sorCodeSearchResults.length==0) && $store.variables.menuOption === \"search\""}},{"name":"list_sorcodes","type":"content","item-type":"list","_auto_id_":"41abdd29-6210-4217-9298-044d2d57d36d","search":"","classes":"","theme":"bootstrap","expressions":{"show":"$store.variables.menuOption === \"search\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var exceededBand = cti.fnSORAlgorithms(false, false);\ncti.store.variables.exceededBand = exceededBand;\n\nif(cti.store.variables.exceededBand) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have exceeded Band C for the Job Cost Variation Bandings. You are not permitted to add any more SOR codes, or increase the quanitity of your current SOR codes until you are back within Band B.\"\n    }\n  );\n} else {  \n  cti.fnOpenSpinner('Adding SOR Code...');\n\n  var sorCodes = cti.store.jobs.selectedJob.aItemGroups;\n  var code = {{$data.$item}};\n  var exists = false;\n\n  var codeObj = code;\n  codeObj.sLocation = cti.store.variables.selectedLocation.sLocation || \"NOLOCATION\";\n  codeObj.nQtyRequired = 1;\n  codeObj.nQtyDoneThisVisit = 0;\n  codeObj.nQtyRemaining = 1;\n  codeObj.bAccuServCode = false;\n\n  for(var i in sorCodes) {\n    if(sorCodes[i].sCode == codeObj.sCode) {\n      if(sorCodes[i].sLocation == codeObj.sLocation) {\n        exists = true;\n        break;\n      }\n    }\n  }\n\n  if(!exists) {\n    sorCodes.unshift(codeObj);\n\n    cti.fnCloseSpinner();\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodeadded\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"success\",\n        \"title\" : \"SOR Code Added\",\n        \"text\" : \"You have successfully added this SOR Code to the Job.\"\n      }\n    );\n\n    cti.utils.callAction('call-component-function', { \"page\" : \"SORCodes\",\"componentInstanceId\":\"506ab6a8-0172-4024-a0e6-ae59ed29f1ee\",\"function\":\"bind\"});\n    cti.utils.updatePage();\n\n    cti.store.variables.menuOption = \"schedules\";\n    cti.fnSearchPanel(cti.store.variables.menuOption);\n  } else {\n    cti.fnCloseSpinner();\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodematch\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"Warning\",\n        \"text\" : \"You have already added this SOR Code to the Job in this Location.\"\n      }\n    );\n  }\n}"},"_auto_id_":"d9c5bfd6-de00-4869-9dfb-ed0a92e26a5f"}],"model":"$store.variables.sorCodeSearchResults","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_sorcodes_html","_auto_id_":"590d591d-7c84-4221-811a-2792f462e3d3","content":"<div style=\"display:block;width:100%\">\n  <div style=\"padding-bottom:10px;font-weight:bold;\">SOR Code: {{$data.$item.sCode}}</div>\n  <div>{{$data.$item.sShortDescr}}</div>\n</div>"}],"pagination":true,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"","paginationNextLabel":"","paginationLastLabel":"Last","paginationPrevNext":true,"paginationPrevIcon":"fa-chevron-left","paginationNextIcon":"fa-chevron-right","paginationPagesToDisplay":3},{"name":"SearchJobSORCodes","type":"component","item-type":"web-component","content":[],"componentId":"55b24a7c-9cde-4da4-95b2-8ab725ae8165","_auto_id_":"506ab6a8-0172-4024-a0e6-ae59ed29f1ee","attributes":{"sourceObjectArrayName":"cti.store.jobs.selectedJob.aItemGroups","displayArrayName":"cti.store.variables.sorCodeJobSearchResults","displayListIfNoSearch":1,"maxResults":30,"minCharacters":3,"locationFilter":"cti.store.variables.selectedLocation.sLocation"},"expressions":{"show":"$store.variables.menuOption === \"schedules\""},"actions":[],"classes":"sors-on-job"},{"name":"html_sorcodes_schedules","type":"content","item-type":"html","_auto_id_":"21ad5add-8174-48a9-bebf-b7387683a5d4","content":"<br>\n<p>Please confirm quantities for the below SOR codes added to this job.</p>","expressions":{"show":"$store.variables.menuOption === \"schedules\""}},{"name":"list_sorsummary","type":"content","item-type":"list","_auto_id_":"cb539320-2cf6-46a8-a7a5-5ab144a3b043","search":"","classes":"","expressions":{"show":"$store.variables.menuOption === \"schedules\""},"theme":"bootstrap","model":"$store.variables.sorCodeJobSearchResults","actions":[],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_sorsummary_html","_auto_id_":"da1fd983-7ca7-4856-9c8c-29195c1001f3","content":"<div class=\"inlineblock-outer\">\n    <div class=\"inlineblock-outer\">\n        <div class=\"sor-header\">{{$data.$item.sCode}}</div>\n        <div class=\"estimated\">Estimated: {{$data.$item.nQtyRequired}}\t</div>\n    </div>\n    <div>{{$data.$item.sLongDescr}}</div>\n</div>\n<hr>"},{"name":"HeaderQuantityDone","type":"content","item-type":"html","_auto_id_":"3c5c0b3e-974a-4738-8e7c-6904935ad18a","content":"<div class=\"sor-list-header\">Quantity Done</div>","expressions":{},"classes":""},{"name":"qntyDoneRow","type":"area","item-type":"row","_auto_id_":"d125f7c0-52fa-4098-a641-1d475ae9da08","content":[{"name":"btnUsedMinus","type":"button","item-type":"button","_auto_id_":"7ad0aec1-da00-4bba-af3c-eafd4411ff89","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQtyDoneThisVisit<1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyDoneThisVisit = $data.$item.nQtyDoneThisVisit - 1;\n$data.$item.nQtyRemaining = $data.$item.nQtyRemaining + 1;\n\ncti.fnSORAlgorithms(false, false);"},"_auto_id_":"fa5bcad3-fef4-4a70-96e6-d59a91f7f030"}]},{"name":"QuantityDone","type":"content","item-type":"html","_auto_id_":"61c4e74d-e2fc-432f-b118-e4bc3b2823d2","content":"{{$data.$item.nQtyDoneThisVisit}}","expressions":{},"classes":"sor-value"},{"name":"btnUsedPlus","type":"button","item-type":"button","_auto_id_":"e79cfa3a-0d3e-4288-8c1c-ca55f465754b","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if($data.$item.nInitialQty === undefined) {\n  $data.$item.nInitialQty = $data.$item.nQtyRemaining;\n}\n\n$data.$item.nQtyDoneThisVisit = $data.$item.nQtyDoneThisVisit + 1;\nif($data.$item.nQtyRemaining > 0) {\n  $data.$item.nQtyRemaining = $data.$item.nQtyRemaining - 1;\n}\n\nvar exceededBand = cti.fnSORAlgorithms(false, false);\ncti.store.variables.exceededBand = exceededBand;\n\nif($data.$item.nQtyRemaining > 0 ) {\n  delete cti.store.variables.exceededBand;\n} else if($data.$item.nQtyDoneThisVisit <= $data.$item.nInitialQty) {\n  delete cti.store.variables.exceededBand;\n}\n\nif(cti.store.variables.exceededBand) {\n  $data.$item.nQtyDoneThisVisit = $data.$item.nQtyDoneThisVisit - 1;\n  if($data.$item.nQtyRemaining > 0) {\n    $data.$item.nQtyRemaining = $data.$item.nQtyRemaining + 1;\n  }\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"style\" : \"warning\",\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have exceeded Band C for the Job Cost Variation Bandings. You are not permitted to add any more SOR codes, or increase the quanitity of your current SOR codes until you are back within Band B.\"\n    }\n  );\n}"},"_auto_id_":"1c52f161-c54c-4d80-8a4f-bcdb25d9b3b3","actions":[]}]}],"expressions":{}},{"name":"HeaderQuantityRemaining","type":"content","item-type":"html","_auto_id_":"28c2ceb1-6aae-4b9c-adf7-efd3ddf2d4c0","content":"<div class=\"sor-list-header\">Remaining</div>","expressions":{},"classes":""},{"name":"qntyRemainingRow","type":"area","item-type":"row","_auto_id_":"b0e944de-ccf3-47ca-8926-3188e59a45da","content":[{"name":"btnRemainingMinus","type":"button","item-type":"button","_auto_id_":"a5f3e734-185b-4ec5-9fd4-8b444600ff07","content":"","theme":"default","left-icon":"fa-minus-circle","expressions":{"disabled":"$data.$item.nQtyRemaining<1"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"$data.$item.nQtyRemaining = $data.$item.nQtyRemaining -1;\n\n// Update the jobcost and ignore any band variation checks\ncti.fnSORAlgorithms(false, true);"},"_auto_id_":"c7555229-1bb0-4bc7-86f6-1b204b473d7d"}]},{"name":"QuantityRemaining","type":"content","item-type":"html","_auto_id_":"a29d0b5b-495a-445c-95d5-dccd235417f8","content":"{{$data.$item.nQtyRemaining}}","expressions":{},"classes":"sor-value"},{"name":"btnRemainingPlus","type":"button","item-type":"button","_auto_id_":"3fcf66d0-dfa4-44ea-a437-4aad4b555dd3","content":"","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if($data.$item.nInitialQty === undefined) {\n  $data.$item.nInitialQty = $data.$item.nQtyRemaining;\n}\n\n$data.$item.nQtyRemaining = $data.$item.nQtyRemaining + 1;\n\nvar exceededBand = cti.fnSORAlgorithms(false, false);\ncti.store.variables.exceededBand = exceededBand;\n\nvar total = $data.$item.nQtyRemaining + $data.$item.nQtyDoneThisVisit;\nif(total <=  $data.$item.nInitialQty) {\n  delete cti.store.variables.exceededBand;\n}\n\nif(cti.store.variables.exceededBand) {\n  $data.$item.nQtyRemaining = $data.$item.nQtyRemaining - 1;\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodematch\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warning\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You have exceeded Band C for the Job Cost Variation Bandings. You are not permitted to add any more SOR codes, or increase the quanitity of your current SOR codes until you are back within Band B.\"\n    }\n  );\n}"},"_auto_id_":"e87d8f62-e305-48d8-9c4b-c25d703632fc"}]}],"expressions":{}}]},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"08f2878c-de68-41c1-8291-c5c431e10676","content":"Save","theme":"default","expressions":{"disabled":"$form.invalid"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ndelete cti.store.variables.sorCodeSearchResults;\ndelete cti.store.variables.sorCodeJobSearchResults;\ndelete cti.store.variables.selectedLocation;\ndelete cti.store.variables.menuOption;\n\ncti.utils.callAction('go-to-page', { \"name\": \"SORLocationSelect\" });"},"_auto_id_":"4bc7f928-5e53-4723-90ea-d9d5f1665cee"}],"classes":"confirm-bar-btn"}],"_auto_id_":"111aed0d-21d8-401f-89d6-3a598cf677ee","expressions":{}}]},{"start":false,"name":"SORLocationSelect","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"f48f1bbf-55ee-4d17-9735-e2d008f89eb3","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"$( \"#sorLocationFetch\" ).click(function() {\n  cti.utils.callAction('call-actionflow',{'name':'OnlineStockLocations'});\n});\n\ncti.fnOrderSORLocations();\n$success();"},"_auto_id_":"60d68874-0151-4174-a18d-71e5316f3cf6"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"3b70d9f4-37a4-4f42-9119-eeab16a78703","content":"<h4 class=\"title\">SOR Select Location</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"435357a4-1a0e-4481-ab0f-4e9ee3d662aa","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleDetails","componentInstanceId":"08de0ec8-8c52-40cc-bd23-f8d4351ede39","function":"open"},"_auto_id_":"8edc7351-674b-41f9-b15a-9588c35f016f"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"112824d1-3674-4ea7-b7fc-fbd6fd70a904","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"efe03a67-b945-4e47-a2f8-8acff85ee95f"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"38d205f9-3935-40fb-9e38-279abd387bc2","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"03150384-4613-4ffe-9f50-d5f43795259b"}],"left-icon":"fa-list"},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"37d38a6d-dd90-4c0c-9dd4-0a36de5775ab","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8c6b72c1-332f-46ee-beca-1535b589adeb"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"78814fb1-fb09-4b95-9789-6a4446d5873e","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"SORLocationSelect","componentInstanceId":"889e7bd4-71c2-413b-9753-e8bed6218070","function":"show"},"_auto_id_":"d330eba9-7cca-4688-8a6a-7fb2ac762b48"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d043b5db-8330-4f21-8870-26a33952cd7a"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"01f189a7-17c3-4a98-b6ce-c3dae6722c22","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"203ee708-a173-427d-98c0-08a047647f88"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"b1c063c8-5c3c-4a92-b3ad-16875b3cd3db","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"55ea740c-8e4b-414e-a466-b1575e6e9af8"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"7898d20a-0ef6-4c4c-baaa-0ffdd8590c45","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"82710215-895e-4301-addc-bf9b523abcb3"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"08de0ec8-8c52-40cc-bd23-f8d4351ede39","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"d82ec700-9631-4989-9539-4e3b5889926d","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"889e7bd4-71c2-413b-9753-e8bed6218070","attributes":{},"expressions":{}},{"name":"html_sorheader","type":"content","item-type":"html","_auto_id_":"02c599c8-1096-4674-b4b4-2bc674c35945","content":"<div class=\"codes-icon\">\n\t<i class=\"fa fa-barcode\"></i>\n</div>\n<h4 class=\"codes-icon-header\">Schedule of Rate Codes</h4>","expressions":{}},{"name":"jobLocationsEmpty","type":"content","item-type":"html","_auto_id_":"c8f748dd-782a-46fc-832f-f1b684e85da9","content":"<h4 style=\"text-align:center;\">Failed to Download SOR Locations</h4><p style=\"text-align:center;\">Currently you do not have any available SOR Stock Locations on device. Please contact your Supervisor or try downloading the Stock by tapping the below icon.</p>\n<div style=\"color:#0072C6;text-align:center;font-size:30pt;width:100%\" id=\"sorLocationFetch\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.variables.jobLocations == false"}},{"name":"list_location","type":"content","item-type":"list","_auto_id_":"4e49a85f-c9e2-4fc7-aacd-007c19d4af4e","search":"","classes":"","theme":"bootstrap","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Loading SOR Codes...');\n\ncti.store.variables.selectedLocation = {{$data.$item}};\n\nif(cti.store.variables.selectedLocation.sLocation == \"NOLOCATION\") {\n  cti.store.variables.selectedLocation.sDescription = \"No Location\";\n}\n\nwindow.appManager.loadFromDatabase('sordata', function (doc) {\n  cti.fnCloseSpinner();\n\n  var sorCodes = cti.store.jobs.selectedJob.aItemGroups;\n  var selectedLocation = cti.store.variables.selectedLocation;\n  var exists = false;\n\n  for(var i in sorCodes) {\n    if(sorCodes[i].sLocation == selectedLocation.sLocation) {\n      exists = true;\n      break;\n    }\n  }\n\n  if(exists) {\n    cti.store.variables.menuOption = \"schedules\";\n  } else {\n    if(selectedLocation.sSORCodesQuantity != 0) {\n      cti.store.variables.menuOption = \"schedules\";\n    } else {\n      cti.store.variables.menuOption = \"search\";\n    }\n  }\n\n  cti.store.variables.sorCodeSearchResults = [];\n  var count = 50;\n  \n  for(var i in doc.data) {\n    if(count === 0) {\n      break;\n    } else {\n      count--;\n      cti.store.variables.sorCodeSearchResults.push(doc.data[i]);\n    }\n  }\n    \n  cti.utils.callAction('go-to-page', { \"name\": \"SORCodes\" });\n\n  $success();\n}, function (reason, err) {\n  cti.fnCloseSpinner();\n  cti.utils.callAction('call-actionflow', { \"name\": \"OnlineSORCodes\" });\n});"},"_auto_id_":"e4bdba8b-dd66-4c83-8d2b-88b8d3c77471","actions":[]}],"model":"$store.jobs.jobSORLocations","dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_location_html","_auto_id_":"5f708c5a-4bee-4d22-b3a2-102ccda78865","content":"<div class=\"list-item-container\">\n  <div class=\"list-location\">{{$data.$item.sDescription}} <span style=\"color:#0072C6\">{{$data.$item.sSORCodesQuantity}}</span></div>\n  <div class=\"{{$data.$item.sLocationClass}}\"></div>\n</div>"}],"pagination":false,"paginationItemsPerPage":5,"paginationBelow":true,"paginationFirstLabel":"First","paginationPrevLabel":"Prev","paginationNextLabel":"Next","paginationLastLabel":"Last","paginationPrevNext":false,"paginationFirstLast":false,"paginationPagesToDisplay":null},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"0a77ed78-5d1e-4653-a612-367df9207938","content":"Show More","theme":"default","expressions":{"show":"$store.variables.showFullLocations === false"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = true;\ncti.fnOrderSORLocations();"},"_auto_id_":"7108b7f1-b0e4-42d0-ab97-30d328df64db"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"ad7c4f4a-952d-44e9-8802-7ee2e4e97343","content":"Show Less","theme":"default","expressions":{"show":"$store.variables.showFullLocations === true"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullLocations = false;\ncti.fnOrderSORLocations();"},"_auto_id_":"d490aa3e-aa70-4f41-a9b9-a5d904398cf5"}],"classes":"showlist-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"99c867f7-971b-430c-b21e-8e8000b4f797","extends":{"type":"area","item-type":"row"},"content":[{"name":"back_btn","type":"button","item-type":"button","_auto_id_":"dece2336-b919-4330-9cae-216d7e19e3f9","content":"Back","theme":"default","expressions":{"show":"$store.variables.sorNav === false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\nvar lastJobCost = cti.store.variables.lastJobCost;\n\nif(jobCost != lastJobCost) {\n  cti.fnSORAlgorithms(true, false);\n} else {\n  cti.fnSORAlgorithms(false, false);\n}\n\ndelete cti.store.variables.lastJobCost;\nvar lastPage = cti.store.variables.lastSORPage;\ncti.utils.callAction('go-to-page', { \"name\": lastPage });"},"_auto_id_":"f2d98468-414c-4fc1-b5e0-2fd61e6a2ec9","actions":[]}],"classes":"button-bar-btn"},{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"40c34912-6aec-454d-b8eb-dca9e406216c","content":"Previous","theme":"default","expressions":{"show":"$store.variables.sorNav === true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\nvar lastJobCost = cti.store.variables.lastJobCost;\n\nif(jobCost != lastJobCost) {\n  cti.fnSORAlgorithms(true, false);\n} else {\n  cti.fnSORAlgorithms(false, false);\n}\n\ndelete cti.store.variables.lastJobCost;\ncti.store.variables.lastSORPage = \"CustomerSignature\";\ncti.utils.callAction('go-to-page', { \"name\": \"CustomerSignature\" });"},"_auto_id_":"d1cc2d6e-357a-4794-bd3c-17797297e07a"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"6363490d-21ef-4eda-b57a-ff58107721d1","content":"Complete","theme":"default","expressions":{"show":"$store.variables.sorNav === true"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var sorCodesOnJob = cti.store.jobs.selectedJob.aItemGroups;\nvar result = true;\n\nfor(var i in sorCodesOnJob) {\n  var currentSor = sorCodesOnJob[i];\n  \n  if(currentSor.nQtyRemaining != 0) {\n    result = false\n    break;\n  }\n}\n\nif(result) {\n  var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\n  var lastJobCost = cti.store.variables.lastJobCost;\n\n  if(jobCost != lastJobCost) {\n    cti.fnSORAlgorithms(true, false);\n  } else {\n    cti.fnSORAlgorithms(false, false);\n  }\n  \n  delete cti.store.variables.lastJobCost;\n  cti.fnNavigateVanStock(cti.store.state.currentPage);\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodesfailed\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning\",\n      \"text\" : \"There are still SOR Codes that need completing on the job.\"\n    }\n  );\n}"},"_auto_id_":"5144c824-c173-4447-a06c-11e9c11e7999"}]}],"expressions":{}}],"_auto_id_":"163427c0-5d98-4380-b0ff-976be5f11fbb","expressions":{}}]},{"start":false,"name":"CustomerSignature","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"b91accd5-c0b6-4858-936a-5f05a0498160","content":"<h4 class=\"title\">Customer Signature</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"9bc01824-92a5-4db5-b95a-4b7ad008d1d4","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"CustomerSignature","componentInstanceId":"ecad3756-23a1-4a06-83f1-53508b874418","function":"open"},"_auto_id_":"48a9a058-85c1-4136-a164-9cc212fb3cfc"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"1c6eb617-ad0c-4a57-bc2a-1ee6c53b250f","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"c72ef02d-9920-48e1-8297-2d5c5f06c492"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"ce0e02d3-a993-43cd-93f7-72f08047f3a9","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e17884ce-4a26-494b-8eff-3adf217cc936"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"3f5be9b6-f803-41fa-ab47-54c0c546b4bd","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"34573710-1663-4655-be00-958873b78359"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"3870d571-9eeb-423d-8cb1-d47cac3b006a","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d918449a-ed77-4121-a61b-f2deabfa4295"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"8923e4db-3ff2-4987-a80e-4403f8845b2b","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"fa23bab9-c7d5-4091-909b-7e443b308ed9"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"40a802c9-c4d7-47dc-b4e8-6953a2ac2e9e","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3dc09c72-b2f2-4fef-b558-a4cad939b0dd"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"2b07401f-d5f4-4d91-b684-b5200d91c55b","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6fccefb1-1dc8-4e8d-81d4-328b604f07e1"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"83acc065-b515-4a2f-9d76-3c860613d28b","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"8d6aa8bb-26d0-4b06-8993-a476d47f95bc","actions":[]}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"ecad3756-23a1-4a06-83f1-53508b874418","attributes":{},"expressions":{}}],"_auto_id_":"6ccae0e3-7db4-4b1c-b621-9b53b24804e4","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"b344f29d-77db-462d-b6c1-0b6fdc1bea2f","content":[{"name":"customerSignatureCheck","type":"choice","item-type":"radio","_auto_id_":"9a947c97-f835-43d2-abae-792a36734894","label":"Is the customer willing to sign?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.store.pages.CustomerSignature.reasonForNoSignature = undefined;\ncti.store.pages.CustomerSignature.customerSignature = undefined;\n\ncti.utils.updatePage();"},"_auto_id_":"47f8aaf0-aa39-40e1-8aca-5631950f8693"}]},{"name":"reasonForNoSignature","type":"choice","item-type":"select","_auto_id_":"26b625f8-2344-4d05-8ddb-d84b0903414d","label":"No signature reason:","required":false,"options":[{"label":"COMMUNAL REPAIR","value":"COMMUNAL REPAIR"},{"label":"TENANT REFUSED","value":"TENANT REFUSED"},{"label":"TENANT UNABLE TO SIGN","value":"TENANT UNABLE TO SIGN"}],"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"0\""}},{"name":"tenantHomeNumber","type":"user-input","item-type":"text","_auto_id_":"96e04dbf-6449-4ad6-819d-d14ad6e44b62","label":"Tenant Home Number:","required":false,"multiline":false,"debounce":250,"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""},"validators":[],"actions":[]},{"name":"tenantMobileNumber","type":"user-input","item-type":"text","_auto_id_":"45e720d6-7f91-4c03-a9ca-c856bd2ffea8","label":"Tenant Mobile Number:","required":false,"multiline":false,"debounce":250,"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""}},{"name":"customerSignature","type":"user-input","item-type":"signature","_auto_id_":"3d962e77-08e7-4377-8ae1-5864777e1093","label":"Tenant Signature","required":false,"expressions":{"show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"9df062bc-1116-409c-9745-c71e37e449ea","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"0f8106a7-2fa1-48a9-a658-b9e4dca5a825","content":"Previous","theme":"default","expressions":{"disabled":"$store.variables.selectedJob.travelended == false && $store.variables.selectedJob.lonedevice == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"8302221d-9808-4530-8aad-08748ab5034c","actions":[]}]},{"name":"next_nosignature_btn","type":"button","item-type":"button","_auto_id_":"1d2ae064-2a69-495d-b5a5-7877653bdef3","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.CustomerSignature.reasonForNoSignature == undefined","show":"$store.pages.CustomerSignature.customerSignatureCheck == \"0\" || $store.pages.CustomerSignature.customerSignatureCheck == undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnNavigateSORCodes(cti.store.state.currentPage, true);"},"_auto_id_":"63a0b192-08c8-4729-8ed8-2e101f4e8d7f"}]},{"name":"next_signature_btn","type":"button","item-type":"button","_auto_id_":"322cab6a-d68e-4766-a996-a827161ccf79","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.CustomerSignature.customerSignature == undefined","show":"$store.pages.CustomerSignature.customerSignatureCheck == \"1\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var homeNumber = cti.store.pages.CustomerSignature.tenantHomeNumber;\nvar mobNumber = cti.store.pages.CustomerSignature.tenantMobileNumber;\n\nif(homeNumber != undefined) {\n  homeNumber = homeNumber.replace(/\\s/g,'');\n}\n\nif(mobNumber != undefined) {\n  mobNumber = mobNumber.replace(/\\s/g,'');\n}\n\nvar propDetail = cti.store.jobs.selectedJob.aPropertyDetail;\nvar home = true;\nvar mob = true;\n\nif(homeNumber != \"\" && homeNumber != undefined) {\n  home = /^\\d+$/.test(homeNumber);\n  \n  if(home) {\n    if(homeNumber.length != 11) {\n      home = false;\n    }\n  }\n}\n\nif(mobNumber != \"\" && mobNumber != undefined) {\n  mob = /^\\d+$/.test(mobNumber);\n  \n  if(mob) {\n    if(mobNumber.length != 11) {\n      mob = false;\n    }\n  }\n}\n\nif(!home) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodesfailed\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning: Invalid Home Number\",\n      \"text\" : \"The Home Number entered is not a valid telephone number. Please make sure there are no letters or special characters in the text field.\"\n    }\n  );\n}\n\nif(!mob) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_sorcodesfailed\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Warning: Invalid Mobile Number\",\n      \"text\" : \"The Mobile Number entered is not a valid telephone number. Please make sure there are no letters or special characters in the text field.\"\n    }\n  );\n}\n\nif(home && mob) {\n  propDetail.sHome_No = cti.store.pages.CustomerSignature.tenantHomeNumber;\n  propDetail.sMobile_No = cti.store.pages.CustomerSignature.tenantMobileNumber;\n  \n  cti.fnNavigateSORCodes(cti.store.state.currentPage, true);\n}"},"_auto_id_":"7b43ca8a-eea2-4d19-9618-62e321ecd256"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"FollowOnContinued","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"97d5bca3-c11f-4334-afd1-9eb5724f1fa8","content":"<h4 class=\"title\">Follow On Appointment</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"2515a7d2-a60c-452b-8d14-fc7942073a07","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"FollowOnAppointment","componentInstanceId":"18daedf4-e358-4023-a22f-d8c982f19866","function":"open"},"_auto_id_":"19c2359c-bc6a-4d00-a9e3-e458c96fbf57"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"e6074326-9a27-4d5d-9721-667637142c4d","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"7a41709e-4202-42ba-b765-9adde0f3d26b"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"a553b7f1-97dd-4821-a5ba-500fc41a7b73","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"f9787ce2-5d6a-4a58-a696-9e4e26e33851"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"5deddd8e-a9ec-4495-9851-495a36593d74","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6d631731-6a67-41b2-906c-d1ccdc8026d0"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"1541bc1e-ccd7-4e7b-9e92-207ef0c22c20","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c03eddd8-7862-4a92-a064-c2f35d641bf5"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"336fa6aa-304e-4ccf-b8e8-d4252a1ea6a7","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"7ad29ec0-1eb9-42d9-9361-0338d7f4499b"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"213c314a-2561-4e52-9046-8f5466ffb137","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"2d36e5c3-7862-40ae-aa56-6bcfc695d84e"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"0a48c6ec-6f12-4c6c-afd8-a0d9e3ee7a52","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8da1f869-f927-4128-bf30-431382a2ce6a"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"05d7fecd-3f53-482b-8edc-b73743e1c5bb","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"028c2f44-c8f8-4816-9352-11012b5402d0"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"18daedf4-e358-4023-a22f-d8c982f19866","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"6f1553d3-66ee-43e5-acc5-5c8f2f33b7d3","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"4d82029a-a10d-4d65-a108-c1b0c102dcbc","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"e5346e21-89a8-4d12-8942-c772cc60599e","attributes":{},"expressions":{}},{"name":"html_followonbooking","type":"content","item-type":"html","_auto_id_":"ce8adafd-13c9-4567-99de-c13aa4a54d61","content":"<p>Please ask the customer the earlist date they are available.</p>","expressions":{}},{"name":"followOnDate","type":"user-input","item-type":"date","_auto_id_":"b6ffbdab-2a3d-4696-9900-ff64b553bb55","label":"Date to search from: ","required":true,"left-icon":"fa-calendar","expressions":{},"message":"This is a required field","options":{"min":"current"}},{"name":"followOnTradeReq","type":"choice","item-type":"select","_auto_id_":"e2889c91-0afc-4218-a2df-9b819963b63b","label":"Follow on trade required","required":true,"options":[],"expressions":{},"message":"This is a required field","option-source":"$store.staticData.tradesList","label-property":"sType","value-property":"sType","validators":[],"actions":[]},{"name":"followOnDays","type":"user-input","item-type":"number","_auto_id_":"26062a5a-d590-4161-9ce7-90793a72d4f4","label":"Days to search over:","required":true,"decimals":0,"expressions":{},"message":"This is a required field","validators":[{"type":"regex","content":"^([1-9]|[12]\\d|3[0-6])$","name":"Number of days over a month","message":"Please select a number of days greater than 0 and within the days of a month"}]},{"name":"followOnDuration","type":"choice","item-type":"select","_auto_id_":"61cba128-dce2-45d3-ba6e-1bfcae4f9d7a","label":"Estimated Duration:","required":true,"options":[{"label":"00:15","value":"15"},{"label":"00:30","value":"30"},{"label":"00:45","value":"45"},{"label":"01:00","value":"60"},{"label":"01:15","value":"75"},{"label":"01:30","value":"90"},{"label":"01:45","value":"105"},{"label":"02:00","value":"120"}],"expressions":{},"message":"This is a required field","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.utils.updatePage();"},"_auto_id_":"861319e5-de6d-42cf-bd2b-cc1cc3992dd0","actions":[]}]},{"name":"getavailability_btn","type":"button","item-type":"button","_auto_id_":"9b0322d3-27e2-4d3d-b973-353bba1c2ef8","content":"Get Availability","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"selecttime-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var today = moment().format('DD-MM-YYYY');\nvar selected = moment(cti.store.pages.FollowOnContinued.followOnDate).format('DD-MM-YYYY');\n\nif(today === selected) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_timeslot\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warning\",\n      \"title\" : \"Warning: Invalid Date Selected\",\n      \"text\" : \"You must select a date to search from that is not the current day. It must be in the future.\"\n    }\n  );\n} else {\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetFollowOnSlots\" });\n}"},"_auto_id_":"428c345d-6bf5-4ecd-a2b0-189b4d1e9340"}]},{"name":"html_availablebookings","type":"content","item-type":"html","_auto_id_":"077d8c89-8f9a-4789-a0b5-36967b8b734c","content":"<h4>Available Appointments</h4>","expressions":{"show":"false"}},{"name":"html_noappointments","type":"content","item-type":"html","_auto_id_":"fd9f96ba-fbd7-4018-8f03-84df7546f376","content":"<h4 style=\"text-align:center;\">No Appointments Available</h4><p style=\"text-align:center;\">Currently there are not appointments available for the selected date range. Please contact your Supervisor or try amending your search.</p>","expressions":{"show":"$store.variables.appointmentResults == false"}},{"name":"followOnAppointmentSlots","type":"content","item-type":"list","_auto_id_":"d3106d3a-429e-4236-ad47-0a588ad157c0","search":"","classes":"","expressions":{"show":"false"},"model":"$store.jobs.followOnTimeSlots","theme":"bootstrap","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var timeSlots = cti.store.jobs.followOnTimeSlots;\nvar selectedSlot = {{$data.$item}};\n\nfor(var i in timeSlots) {\n  var remove = document.getElementById(timeSlots[i].id);\n  remove.classList.remove('timeslot-item-selected');\n  \n  if(timeSlots[i].id == selectedSlot.id) {\n    timeSlots[i].selected = true;\n    cti.store.jobs.selectedJob.sFollowOnRequiredDetail = selectedSlot;\n  } else {\n    timeSlots[i].selected = false;\n  }\n}\n\nvar element = document.getElementById(selectedSlot.id);\nelement.classList.add('timeslot-item-selected');\n\ncti.utils.updatePage();"},"_auto_id_":"c1380734-1475-4b94-b548-881d28b02ddc","actions":[]}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"followOnAppointmentSlots_html","_auto_id_":"ebf320c9-c7b7-41ee-81ab-0bf8406fa509","content":"<div id=\"{{$data.$item.id}}\">{{$data.$item.description}}</div>"}]},{"name":"availableSlots","type":"choice","item-type":"select","_auto_id_":"bdaa6957-3944-4b44-bd59-e5419318a48e","label":"Available Slots:","required":false,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"Option 3","value":3}],"expressions":{"show":"$store.variables.appointmentResults == true"},"option-source":"$store.jobs.followOnTimeSlots","label-property":"description","value-property":"id"},{"name":"html_bookedfor","type":"content","item-type":"html","_auto_id_":"449d4e2a-cefe-4eff-a6e4-473e8a4c3937","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa complete\"></p></div>\n<h4 class=\"completeheader\">Booked</h4>\n<p style=\"color:#228B22;text-align:center;\">Follow on appointment booked for {{'$store.jobs.selectedJob.sFollowOnRequiredDetail.description'|store}}","expressions":{"show":"$store.jobs.selectedJob.bFollowOnRequired == true"}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"0ebfe6ff-a3ae-410c-a1e7-0e7f9504892c","extends":{"type":"area","item-type":"row"},"content":[{"name":"cancel_btn","type":"button","item-type":"button","_auto_id_":"91ae7fbc-f19b-496a-b34a-52158eea5a43","content":"Cancel","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.destroyPageData('FollowOnContinued');\n\ndelete cti.store.jobs.selectedJob.sFollowOnRequiredDetail;\ndelete cti.store.jobs.followOnTimeSlots;\ndelete cti.store.jobs.selectedJob.bFollowOnRequired;\ndelete cti.store.variables.appointmentResults;\n\ncti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"de7414f7-f46a-4e42-b99f-2f282cac8bdb"}],"expressions":{},"classes":"deletephoto-btn"},{"name":"bookfollowon_btn","type":"button","item-type":"button","_auto_id_":"858c9ad8-f1dd-4d37-af45-2f093d606efe","content":"Book Slot","theme":"default","expressions":{"disabled":"$store.pages.FollowOnContinued.availableSlots == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var timeSlots = cti.store.jobs.followOnTimeSlots;\nvar selectedSlot = cti.store.pages.FollowOnContinued.availableSlots.value;\nvar timeSlotData;\n\nfor(var i in timeSlots) {\n  if(timeSlots[i].id == selectedSlot) {\n    timeSlotData = timeSlots[i];\n    break;\n  }\n}\n\nif(cti.store.pages.FollowOnContinued.followOnDuration == undefined) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_timeslot\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"warning\",\n      \"title\" : \"Warning\",\n      \"text\" : \"You must select an Estimated Duration before continuing with booking the appointment.\"\n    }\n  );\n} else {\n  if(timeSlotData) {\n    cti.store.jobs.selectedJob.sFollowOnRequiredDetail = timeSlotData;\n    cti.utils.callAction('call-actionflow', { \"name\": \"BookFollowOnSlot\" });\n  } else {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_timeslot\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"warning\",\n        \"title\" : \"Warning\",\n        \"text\" : \"You must select an Available Time Slot before continuing with booking the appointment.\"\n      }\n    );\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"6d14e432-6343-4c84-abaa-65f3026c91b2"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"FollowOnAppointment","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"a361ae8f-468c-4332-92ef-2c2a09ac2d05","content":"<h4 class=\"title\">Follow On Work</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"22b7c840-9315-47d9-941e-9760a607c499","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"FollowOnAppointment","componentInstanceId":"d186b0ec-2fc8-4c7b-bf0d-c5c03c5a0159","function":"open"},"_auto_id_":"073b17b5-5010-4a28-8de0-2b6ab7bf84e2"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"92b589a8-469b-4893-978f-e8ebda3857e2","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"a503f1aa-d39e-4554-b920-86c15738701f"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"b9b1f0b0-1d6b-43ee-a1e8-6df4c0ecd3d7","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d36f7c89-30e3-411b-91be-1569ed21e327"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"16c179b4-ae01-4a5f-9ae9-5bf8a77ed07f","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"83606c56-ecf0-48d1-af24-bf94947502b4"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"67279478-97c5-4436-a40c-26e229ff2e2e","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e86145d9-9e0f-455d-a57c-4d694e6044fa"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"b0da1525-dac3-4849-b99c-eb6eb220c0a8","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"dd30c537-ff47-4694-bcc4-87a9bf7b6d6c"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"a2dbd05a-83c8-4dfc-8c7c-e33a70ef102d","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"5554b6b3-8c35-42e6-a20e-fdb90c9357bd"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"cc20ecdd-2a60-4eca-95e7-083d129defbb","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3033a79e-6c8d-4061-8e5d-5f3f16287c98"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"683dc6b4-2cae-4e6e-969f-4f3352a287d5","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"b2a68142-91f1-4de0-bac5-6bafb1c9e26b"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"d186b0ec-2fc8-4c7b-bf0d-c5c03c5a0159","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"2946253b-e4c2-45ec-9fa2-6f23e5a51a6d","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"d7f4b12d-1493-410a-b075-8d6e62bc70af","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"18caf413-191b-4dab-b923-b28e8b12f8eb","attributes":{},"expressions":{}},{"name":"jobCompletionCheck","type":"choice","item-type":"radio","_auto_id_":"a9d5d2c5-7020-4cea-a789-da14a7ea8cd4","label":"Is there any Follow On Work required for this Job?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"message":"This is a required field","classes":"cb-bias-first","actions":[]},{"name":"jobNotCompleteReason","type":"choice","item-type":"select","_auto_id_":"a1833c51-e8a6-4703-9408-a0b9fd70bd9a","label":"Reason job not complete","required":true,"options":[{"label":"Materials on order","value":"Materials on order"},{"label":"Other trade required","value":"Other trade required"},{"label":"Further time required (Me)","value":"Further time required (Me)"}],"expressions":{"show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\""},"message":"This is a required field","actions":[],"option-source":"$store.staticData.followOnList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"followOnComments","type":"user-input","item-type":"text","_auto_id_":"519516fa-9cfb-42a3-93e2-4770753d506c","label":"Follow on comments:","required":true,"multiline":true,"debounce":250,"expressions":{"show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\""},"message":"This is a required field"},{"name":"book_btn","type":"button","item-type":"button","_auto_id_":"8016cad5-e40b-4c30-9c4e-82baf434b4c0","content":"Book Follow On Appointment","theme":"default","expressions":{"disabled":"$form.invalid","show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnContinued\" });"},"_auto_id_":"6ca8421f-7ced-4c6a-a97b-c074e48a3e73"}],"classes":"bookappointment-btn"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"3d355f75-de63-4cd3-815e-ace29e15b616","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"70696f41-04b7-4327-a2f7-fbbfd6a2ab75","content":"Previous","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"PostWorkPhotos\" });"},"_auto_id_":"8993c80b-77a6-4553-990d-21c071c326ab"}]},{"name":"jobcomplete_btn","type":"button","item-type":"button","_auto_id_":"8e8a8c97-a098-42e2-b905-1e7365d8a652","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.FollowOnAppointment.jobCompletionCheck == undefined","show":"$store.pages.FollowOnAppointment.jobCompletionCheck == undefined || $store.pages.FollowOnAppointment.jobCompletionCheck == \"0\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.sResultSummary = \"JOB COMPLETE\";\ncti.store.jobs.selectedJob.sResultSummarySubReason = \"\";\ncti.store.jobs.selectedJob.sResultDetail = \"Job Information: \" + cti.store.pages.JobInformation.workCompleteDescription;\n\ncti.utils.callAction('go-to-page', { \"name\": \"CustomerSignature\" });"},"_auto_id_":"1ccef02c-86b2-484a-9576-11bee0773229"}]},{"name":"followon_btn","type":"button","item-type":"button","_auto_id_":"54e9d3ea-d5d5-4dc2-85cc-8c261d1679c1","content":"Next","theme":"default","expressions":{"show":"$store.pages.FollowOnAppointment.jobCompletionCheck == \"1\"","disabled":"$form.invalid"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.sResultSummary = \"FOLLOW ON REQUIRED\";\ncti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.FollowOnAppointment.jobNotCompleteReason.value;\ncti.store.jobs.selectedJob.sResultDetail = \"Job Information: \" + cti.store.pages.JobInformation.workCompleteDescription + \"\\nFollow On Required: \" + cti.store.pages.FollowOnAppointment.followOnComments;\n\ncti.utils.callAction('go-to-page', { \"name\": \"CustomerSignature\" });"},"_auto_id_":"07fb2353-d5a4-497e-acec-c283712307ca"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"PostWorkPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"293f6147-315f-42d7-bb75-84c7e35e7c2d","content":"<h4 class=\"title\">Post Work Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"65ba7fb8-be68-4683-8ba0-fb22766c5945","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"PostWorkPhotos","componentInstanceId":"4986e8ea-5488-4dcd-958a-606c8f464218","function":"open"},"_auto_id_":"940b185e-1a79-4988-873f-87a50fd541b2"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"5feb7932-4501-45c9-8b14-d56eeeba6ec9","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"5750a618-6b4f-4f48-b4e2-fd507e3fc344"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"32cf372f-2803-4762-a12b-b0c4aa974647","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"550b795a-552c-467b-a71a-3029771d59df"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"ef905248-4af2-4d58-9c7a-7e3595bb217e","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"5ff6bdcc-f5ac-473e-987b-397f98ce8fbb"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"804c0d49-dbc5-457e-9696-594118678d34","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"f870b0c5-c763-4dc7-a344-2f9b35dfa498"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"e3f184bc-d591-40ca-8ac9-8df705cb6783","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"42f4e74c-19f2-4f4f-8689-4865c8e87fc8"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"40c256a6-46a1-47fa-b360-2154b7c6d4ad","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"99f1bc81-1317-428b-ae23-d5a09d5e0a74"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"a6bbd75a-228f-4102-bc87-8501e6aa86ce","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"7c1fb3b2-a49c-4217-9741-b97703ec87f4"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"967d2ccf-a544-4e9f-b7f8-52ed437c22b6","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"2295efc3-59a8-44c9-8692-b3f2e9e0fa80"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"4986e8ea-5488-4dcd-958a-606c8f464218","attributes":{},"expressions":{}}],"_auto_id_":"22c2e50d-f4c3-4c19-aded-360593ccd176","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"da33d147-5074-4cdd-92e8-4e194a00fec4","content":[{"name":"noPermissionWarning","type":"content","item-type":"html","_auto_id_":"180be7be-a3b3-4d72-9e0a-49f71214c99d","content":"<h4 style=\"text-align:center;\">Warning</h4>\n<p style=\"text-align:center;\">You have selected on the Pre Work Photos page that you do not have permission to take photos. Please continue or obtain permission from tenant to take photos.</p>","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"N\""}},{"name":"preWorkPhotos","type":"content","item-type":"html","_auto_id_":"75d84f07-e089-4eca-8c9e-ce1c01d0bed0","content":"<h4>Post Work Photos</h4><p>Please take any photos relevent to the work carried out on the job.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('PostWorkPhotos','3c93f0f9-04ef-4534-bf67-0e25cb39f47f')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""}},{"name":"btnTakePhotoPostWork","type":"button","item-type":"button","_auto_id_":"0ee4d41c-702d-4679-ab3f-6d048a107c8a","content":"Take Photo","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""},"actions":[{"event":"click","type":"call-component-function","data":{"page":"PostWorkPhotos","componentInstanceId":"3c93f0f9-04ef-4534-bf67-0e25cb39f47f","function":"takePhoto"},"_auto_id_":"1c0e6060-8f11-44a8-8b3d-47d546107fff"}],"classes":"takephoto-btn"},{"name":"PostWorkPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"98807067-3c95-452a-9d3d-74d7a04fa651","_auto_id_":"3c93f0f9-04ef-4534-bf67-0e25cb39f47f","attributes":{"captureCategory":"Post Work","displayCategory":"Post Work","maxPhotos":3},"expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""},"actions":[{"event":"maxPhotosTaken","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"app_genericwarning","text":"You have taken the maximum number of photos for post-work evidence."},"_auto_id_":"e0fc770e-9539-40f3-af0c-2e8d0f6d3e89"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"ec8d309f-ad1c-466e-8f7b-dc93abb48d7a","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"17a0d670-8bec-4aea-88df-d0e7259bcbe8","content":"Previous","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"JobInformation\" });"},"_auto_id_":"d00aec56-b264-42f9-94a2-6456327b3624"}]},{"name":"next_nophotos_btn","type":"button","item-type":"button","_auto_id_":"47fd8d1e-cce2-4d02-869a-f169e3a1b88a","content":"Next","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"N\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"c7f42933-45a5-4c6b-94ae-2587a07b8a15"}]},{"name":"next_yespermission_btn","type":"button","item-type":"button","_auto_id_":"0af9cbed-2be4-4cab-bc2f-56b440167126","content":"Next","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bWorkPhoto == \"Y\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });"},"_auto_id_":"2b00d12c-78c9-46e8-9e27-4e2a684918ba"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobInformation","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"181693d9-0887-4883-9d5f-f3eeebc02513","content":"<h4 class=\"title\">Job Information</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"af5a75e8-dc88-49ba-9759-b8ffbfa61b18","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"4a60f80f-b746-477d-92c0-97648aeb341a","function":"open"},"_auto_id_":"c6c39450-90f5-4ae2-9796-8fed8716897a"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"959a5274-39eb-4cd2-8adf-ea2dd8bb61fd","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"65c82e6c-cf8e-4699-b0a6-15d7c90e2348"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"3d98bc16-6762-4798-a950-21fae0fd28fb","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"7af3f42e-1c77-4f53-ba5a-88e331ef14fd"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"ef7b5dd3-dd18-42e9-a67f-957436ccf733","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"085514d0-ab76-4bcc-81db-649f3db7f288"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"59645736-fc6a-4dc9-8b97-d2e8e35f5471","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e20dda25-bc58-4df5-b61a-412d575b9f68"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"c588c6cb-f263-4f49-a087-4cad0b4c0a9e","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b7ba8772-185c-44b9-986a-c389ec533dff"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"f1edfce4-a990-4be2-a70c-eb6c7fb48532","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"638efdb8-1536-4e11-a3a5-326f6ff4e755"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"e2f9e4ee-7322-4b42-a579-baf0461539c8","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a72580fa-8366-4c0b-9afc-f9c5315b5fd6"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"c64f5e2b-b8df-4a60-89d8-d8b8b7d628d3","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"b05b72a0-c01e-40c1-9212-09fe9d1f1616"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"4a60f80f-b746-477d-92c0-97648aeb341a","attributes":{},"expressions":{}}],"_auto_id_":"68d06738-9558-485c-8c81-18ea6e908806","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"46156afe-d3aa-4530-9dde-ea0ff06b2cd6","content":[{"name":"html_worktodo","type":"content","item-type":"html","_auto_id_":"c7f941c9-6b4d-49fc-bc2a-7edb72f6c6e7","content":"<h4>Work to be carried out</h4>\n<p>{{'$store.jobs.selectedJob.sWorkToBeDoneDetail'|store}}</p>\n<hr>","expressions":{}},{"name":"workCompleteDescription","type":"user-input","item-type":"text","_auto_id_":"f86cf4ee-98b8-4a3a-826a-65849c6f9961","label":"Description of work carried out to remedy the issue:","required":true,"multiline":true,"debounce":250,"expressions":{},"message":"This is a required field","actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"7379fa3a-24ce-479a-b75d-04a87779e2fd","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"317fa6da-2bb1-4573-9a77-2bb251baaeac","content":"Previous","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var sAccuservJobType = cti.store.jobs.selectedJob.sAccuservJobType;\n\nif(sAccuservJobType != undefined) {\n  sAccuservJobType = sAccuservJobType.replace(/\\s+/g, '').toLowerCase();\n}\n\nif(sAccuservJobType == 'gasservicing') {\n  cti.utils.callAction('go-to-page', { \"name\": \"CP12\" });\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n}"},"_auto_id_":"3494e9e4-495e-41a1-8c71-00f66a923125"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"42346708-d1aa-4dfe-b714-944b71d3915a","content":"Next","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.sResultDetail = cti.store.pages.JobInformation.workCompleteDescription;\n\ncti.utils.callAction('go-to-page', { \"name\": \"PostWorkPhotos\" });"},"_auto_id_":"a63530b6-bad7-42c8-a2bb-40e8283af927"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"PreWorkPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"3e6eb29f-c6d0-4825-93ec-7aa9edb56589","content":"<h4 class=\"title\">Pre Work Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"fee2922a-f98d-470e-9089-1b58a8722406","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"BeforePhotos","componentInstanceId":"14a98a91-e64c-4cba-a440-669fe91450e9","function":"open"},"_auto_id_":"4df0e568-49da-4ec5-a073-fea117f5a935"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"cc8bd233-139d-43a7-8739-a7fe08b231d6","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"f85d11bc-4a41-41cf-b9cb-1c7ef4e37b61"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"58680b26-b21e-41f4-bd79-93164e4e8915","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8e6b116b-f0b0-4da2-82ec-805873b2d7b5"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"39b259e5-72ea-46a4-b46e-7f617e343fcc","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"7ab68470-6692-4cc6-ad20-1aea6681e670"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"74763f20-6cea-4810-acdb-2ac11c7dd01f","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d6082f98-b6db-48ea-8373-ab91775f927c"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"f6927048-8c47-4370-a76d-3085e14ad685","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"5c3dc081-0f15-44f4-9bce-ce65563e6ea6"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"49081510-8c08-4cce-94b3-6da7131836e5","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b2ac683f-9583-4669-a3ae-cb9b6ff07fad"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"710c55fc-ded2-4d37-8f08-76083988c47b","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"23e5b6b2-862c-49fa-9a16-58dbcac9e365"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"d0b7ee81-51f4-4ff2-afa5-734cbb5e0261","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"41ca192c-8ce9-40a6-b4c4-620c68abe298"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"14a98a91-e64c-4cba-a440-669fe91450e9","attributes":{},"expressions":{}}],"_auto_id_":"61bdddc1-6aa9-467e-8077-ca694301f844","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"7385ff18-0ba5-413d-ab19-4206def1bf0c","content":[{"name":"preWorkPhotoPermission","type":"choice","item-type":"radio","_auto_id_":"31bec1b7-1993-428e-a209-abf193c7c4ff","label":"Have you got permission to take photos?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[]},{"name":"preWorkPhotoDescription","type":"user-input","item-type":"text","_auto_id_":"c51ced36-0d49-412a-b06d-c3ee58473e03","label":"Please enter any tenant comments below:","required":false,"multiline":false,"debounce":250,"expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == '0'"}},{"name":"preWorkPhotos","type":"content","item-type":"html","_auto_id_":"821af9f8-de17-4be2-9fa6-1029cd4f90ac","content":"<h4>Pre Work Photos</h4><p>Please take any photos relevent to the job prior to work being done.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('PreWorkPhotos','708d6621-8b2f-4843-a6cd-c0d7dd539537')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"1\""}},{"name":"btnTakePhotoPreWork","type":"button","item-type":"button","_auto_id_":"b48b7ee0-8e93-4b4d-ba30-e9c7d6f9de96","content":"Take Photo","theme":"default","expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"1\""},"actions":[{"event":"click","type":"call-component-function","data":{"page":"PreWorkPhotos","componentInstanceId":"708d6621-8b2f-4843-a6cd-c0d7dd539537","function":"takePhoto"},"_auto_id_":"51389501-1d7c-4a83-a533-185e5288a7de"}],"classes":"takephoto-btn"},{"name":"PreWorkPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"98807067-3c95-452a-9d3d-74d7a04fa651","_auto_id_":"708d6621-8b2f-4843-a6cd-c0d7dd539537","attributes":{"captureCategory":"Pre Work","displayCategory":"Pre Work","maxPhotos":3},"expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == '1'"},"actions":[{"event":"maxPhotosTaken","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"app_genericwarning","title":"Photos","text":"You have taken the maximum number of photos for pre-work evidence."},"_auto_id_":"ff8e7476-a19e-44a4-89a1-7fe75c2c25bd"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"29a1abeb-d4c0-4a51-b210-ece31c96d6af","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"da97e920-55a4-42b2-8128-93b4e0029c7b","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"StartingWork","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_yespermission_btn","type":"button","item-type":"button","_auto_id_":"47ed2aae-881a-4766-8384-1058da6c1261","content":"Next","theme":"default","expressions":{"show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"1\""},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.bWorkPhoto = \"Y\";\ncti.store.jobs.selectedJob.bWorkPhotoComment = \"Permission has been granted \";\n\nif(!cti.store.jobs.selectedJob.bTenantPhotDataCollection) {\n  cti.store.variables.jobCollectionType = \"tenantphoto\";\n  cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n}\n\nif(cti.store.jobs.selectedJob.cp12Enabled === undefined) {\n  cti.store.jobs.selectedJob.cp12Enabled = 'pending';\n}\n\nvar sAccuservJobType = cti.store.jobs.selectedJob.sAccuservJobType;\n\n// DEBUG START\n// if(cti.store.jobs.selectedJob.sAccuservJobType == \"\") {\n//\tcti.store.jobs.selectedJob.sAccuservJobType = \"Gas Servicing\";\n// }\n// DEBUG END\n\nif(sAccuservJobType != undefined) {\n  sAccuservJobType = sAccuservJobType.replace(/\\s+/g, '').toLowerCase();\n}\n\nif(sAccuservJobType == 'gasservicing') {\n  cti.utils.callAction('go-to-page', { \"name\": \"CP12\" });\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"JobInformation\" });\n}"},"_auto_id_":"d2772538-68c0-4d6d-a4cd-0e1592e4dee0"}]},{"name":"next_nopermission_btn","type":"button","item-type":"button","_auto_id_":"b49602e8-a406-4f05-8ccc-f9b63fac1dc3","content":"Next","theme":"default","expressions":{"disabled":"$store.pages.PreWorkPhotos.preWorkPhotoDescription == \"\" || $store.pages.PreWorkPhotos.preWorkPhotoDescription == undefined","show":"$store.pages.PreWorkPhotos.preWorkPhotoPermission == \"0\" || $store.pages.PreWorkPhotos.preWorkPhotoPermission == undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.bWorkPhoto = \"N\";\ncti.store.jobs.selectedJob.bWorkPhotoComment = cti.store.pages.PreWorkPhotos.preWorkPhotoDescription;\n\ncti.store.variables.jobCollectionType = \"tenantphoto\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n\nif(cti.store.jobs.selectedJob.cp12Enabled === undefined) {\n  cti.store.jobs.selectedJob.cp12Enabled = 'pending';\n}\n\nvar sAccuservJobType = cti.store.jobs.selectedJob.sAccuservJobType;\n\n// DEBUG START\n// if(cti.store.jobs.selectedJob.sAccuservJobType == \"\") {\n//\tcti.store.jobs.selectedJob.sAccuservJobType = \"Gas Servicing\";\n// }\n// DEBUG END\n\nif(sAccuservJobType != undefined) {\n  sAccuservJobType = sAccuservJobType.replace(/\\s+/g, '').toLowerCase();\n}\n\nif(sAccuservJobType == 'gasservicing') {\n  cti.utils.callAction('go-to-page', { \"name\": \"CP12\" });\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"JobInformation\" });\n}"},"_auto_id_":"d595c2c4-903c-4676-a031-add6b4ed5cc7"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"EstimatedOverride","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"8574dc54-fa46-4ca8-a6c3-9e0496bd9fc9","content":"<h4 class=\"title\">Warning!</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"4b2b997c-fc9a-45fd-b535-8bf329bfb933","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobInformation","componentInstanceId":"0a6cef24-b23d-48f9-8fc1-35e8fd780230","function":"open"},"_auto_id_":"f7c09af4-09d9-484d-9a90-39ce4f45966c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"5f68eef0-b09b-4ea2-aef0-00bb7c77a76d","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo","params":{"page":"JobList"}},"_auto_id_":"75497a3b-94cf-45db-9c7c-4606f14b02a9"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"fc9a1278-d18c-4ea1-ab49-f0fac86e5d71","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b4be10be-a2d1-43bb-8dc2-b06dc6f8e897"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"c7facf51-367e-4d31-b8ff-354eb48790e9","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"261ec6fe-269d-4ca3-990d-5da89f1341a1"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"cadb1b1d-d182-4bba-a967-3179a919521a","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3e01dd47-7fd5-4d20-b44d-d889ddb1a89d"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"1a1416b2-c477-450c-8df6-18deb4db90bb","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"aff7ff93-a665-4509-899c-7b38fcad4a3e"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"9db2bac9-c57c-4873-905e-f7c88a9e502c","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"749db2b3-2ce1-4458-b826-634c0f40ede8"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"77382ff4-f197-4953-9f73-1f5128603eb3","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"17115204-5dd9-4034-9f21-23e5d0e18022"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"e428d764-85ce-4855-8bf4-be2edc5a7b4c","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"e0825e82-22c8-4729-8a08-d00df48b75b7"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"0a6cef24-b23d-48f9-8fc1-35e8fd780230","attributes":{},"expressions":{}}],"_auto_id_":"226bacbb-b0a8-4b47-a6ff-9979e08e7c9d","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"cb802a6f-ced9-462f-acc6-c2a627830325","content":[{"name":"html_override","type":"content","item-type":"html","_auto_id_":"ed226ed0-b975-41b8-acb0-62b57149a8f2","content":"<h3>You have Overridden the Estimated Duration for this Job.</h3>\n<p>You are about to Override the Estimated Duration that has been set against this Job. Once you have Overridden this, it can not be reverted and any further changes/amendments to the SOR codes will have no impact on the calculated SMV.</p><p>Are you sure you wish to continue?</p>\n<hr>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"26a3b822-c443-4e99-ba11-acd6c089d666","extends":{"type":"area","item-type":"row"},"content":[{"name":"no_btn","type":"button","item-type":"button","_auto_id_":"a355d7ed-6282-40aa-bd18-40ddae6e4a81","content":"No","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"deletephoto-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.variables.estimatedOverride;\ndelete cti.store.variables.estimatedOverrideSelected;\ncti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });"},"_auto_id_":"15495bbe-eff4-42cd-8536-b2d3c0272954"}]},{"name":"yes_btn","type":"button","item-type":"button","_auto_id_":"7fb410b3-96ab-4236-a1bb-bd15280a3572","content":"Yes","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.estimatedOverride = true;\n\ncti.store.jobs.selectedJob.originalEstimatedValue = cti.store.pages.StartingWork.estimatedDuration.value;\ncti.fnCalcSMVChange();\n\nif(cti.store.jobs.selectedJob.bJobStartWork) {\n  cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n} else {\n  cti.fnStartJob();\n  cti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });\n}"},"_auto_id_":"f2e1c888-8ff6-4c09-a38a-b31c909202df"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"StartingWork","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"d9083b93-add4-4652-b153-c5d42624dbf0","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"cti.fnSORAlgorithms(true);\nvar jobExpected = cti.store.jobs.selectedJob.sExpected_Duration;\n\nif(cti.store.pages.StartingWork === undefined) {\n  cti.store.pages.StartingWork = {};\n}\n\nif(cti.store.pages.StartingWork.estimatedDuration === undefined) {\n  cti.store.pages.StartingWork.estimatedDuration = {};\n}\n\nif(jobExpected === undefined || jobExpected == \"\") {\n  jobExpected = \"0\";\n}\n\nvar time = parseInt(jobExpected);\n\nif(time === 0) {\n  var roundedExpected = time;\n} else if(time > 0 && time <= 120) {\n  var roundedExpected = 15 * Math.round(parseInt(jobExpected) / 15);\n} else if(time > 120 && time <= 240 ) {\n  var roundedExpected = 30 * Math.round(parseInt(jobExpected) / 30);\n} else if(time > 240 && time <= 480) {\n  var roundedExpected = 60 * Math.round(parseInt(jobExpected) / 60);\n}\n\nif(roundedExpected === 0) {\n  roundedExpected = 15;\n\n  if(cti.store.jobs.selectedJob.bJobStartWork != true) {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodesfailed\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"Warning\",\n        \"text\" : \"The Expected Duration of this job is less than 15 minutes, please make sure this is correct before starting the job.\"\n      }\n    );\n  }\n}\n\ncti.store.pages.StartingWork.estimatedDuration.value = roundedExpected;\ncti.store.jobs.selectedJob.iJobStartWorkEst = time;\n\nif(cti.store.jobs.selectedJob.bJobStartWork != true) {\n  if(cti.store.jobs.selectedJob.aItemGroups.length === 0) {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_sorcodesfailed\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"Warning\",\n        \"text\" : \"There are currently no SOR codes assigned to this job. Please check this and confirm before starting the job.\"\n      }\n    );\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"fc08dc62-687d-45ed-b526-ef7ae8a097fe"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"663d742a-b42d-43c7-9dff-56df79a9cb6e","content":"<h4 class=\"title\">Starting Work</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"61d7a66c-2d7a-483d-8947-0e34272f2f6a","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"StartingWork","componentInstanceId":"ac134ed8-9cc6-40cb-920f-1f3183b92a06","function":"open"},"_auto_id_":"ff637b38-6f7c-401f-a62d-01dd0ce27858"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"db703891-19d9-41ac-926f-265a2d18e7e8","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"a52cb4c5-78b4-4a5b-ba14-781dbdbff251"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"9028f1f3-6e41-4a18-a474-1f45f7d737a2","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"0ffa3db7-271a-4e3d-ba9d-719e9b362fb1"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"f6f60ed7-760f-4cc5-9068-95359e94973e","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"8b4ea5c4-17f9-45ef-8e0f-51f2959de49d"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"c922368b-494f-4a1a-9d2d-558db0712d7b","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"cb1a7957-e93e-4ab8-9156-05d9b3a4d81d"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"c4ac0aa5-f896-42d0-94b8-83e1afe89332","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"1a5b4738-593d-4a04-b9ad-91718eef975b"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"e24db191-d070-4bf0-837b-aea54201ad8a","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"dee311d4-3516-408e-9414-a39d21b9d7e4"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"a056bdd1-66d4-4db8-89ee-76733c3cc527","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c137826c-d4a3-43fc-ba50-d442165589fa"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"27d6f87c-e3c3-474b-a0b2-3a2a9d003736","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"f9e15883-0f05-473f-a86b-7beed1f8ca23"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"ac134ed8-9cc6-40cb-920f-1f3183b92a06","attributes":{},"expressions":{}}],"_auto_id_":"d8bf1505-b85e-49d6-bd9d-28c4d6fd960b","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"6115293c-a108-4f17-9195-18340abc9cea","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"6c930a81-c04e-4790-988c-90cbb05a8492","attributes":{},"expressions":{}},{"name":"workDescription","type":"user-input","item-type":"text","_auto_id_":"92ef38c0-9cc2-4435-8f91-279b2f49b6f6","label":"Description of work to be carried out:","required":true,"multiline":true,"debounce":250,"expressions":{},"message":"This is a required field","validators":[],"actions":[]},{"name":"estimatedDuration","type":"choice","item-type":"select","_auto_id_":"2e50af8e-8b57-431b-9072-1f8b6d5aff76","label":"Estimated Duration:","required":true,"options":[{"label":"00:15","value":"15"},{"label":"00:30","value":"30"},{"label":"00:45","value":"45"},{"label":"01:00","value":"60"},{"label":"01:15","value":"75"},{"label":"01:30","value":"90"},{"label":"01:45","value":"105"},{"label":"02:00","value":"120"}],"expressions":{},"message":"This is a required field","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.iJobStartWorkEst = cti.store.pages.StartingWork.estimatedDuration.value;\ncti.store.variables.estimatedOverrideSelected = true;\ncti.utils.updatePage();"},"_auto_id_":"f5d906be-edb0-488b-8269-2e87350df6f4","actions":[]}],"option-source":"$store.staticData.estimatedTimeSlots","label-property":"label","value-property":"value"},{"name":"html_totalmins","type":"content","item-type":"html","_auto_id_":"8d45d49c-bcb3-4ea8-994c-ff5c3307b885","content":"<p style=\"margin-bottom:2vh;margin-top:2vh;font-size: 12pt;\">Total Minutes: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobStartWorkEst'|store}}</span></p>\n<hr>","expressions":{}},{"name":"html_startjob","type":"content","item-type":"html","_auto_id_":"5184c942-8110-41a2-b021-3de683adf7b2","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa startjob\"></p></div>","expressions":{"show":"$store.jobs.selectedJob.bJobStartWork == false"}},{"name":"html_jobstarted","type":"content","item-type":"html","_auto_id_":"9ae7cc53-6b63-4da2-b012-cba72534108c","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa complete\"></p></div>\n<h4 class=\"completeheader\">Job Started</h4>","expressions":{"show":"$store.jobs.selectedJob.bJobStartWork == true"}},{"name":"startjob_btn","type":"button","item-type":"button","_auto_id_":"57009568-8071-4198-a98e-697095ac0182","content":"Start Job","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobStartWork == false","disabled":"$form.invalid"},"classes":"startjob-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var originalEstimated = cti.store.jobs.selectedJob.originalEstimatedValue;\nvar selectedEstimated = cti.store.pages.StartingWork.estimatedDuration.value;\n\nif(cti.store.variables.estimatedOverrideSelected) {\n  if(originalEstimated === selectedEstimated) {\n    cti.fnStartJob();\n  } else {\n    cti.utils.callAction('go-to-page', { \"name\": \"EstimatedOverride\" });\n  }\n} else {\n  cti.fnStartJob();\n}"},"_auto_id_":"ee86a47a-9713-4ff8-b629-ad171c6906f5"}]},{"name":"html_jobstartedtime","type":"content","item-type":"html","_auto_id_":"bb1b2b6f-0019-4e43-83eb-a1179cf44136","content":"<hr>\n<p style=\"font-size: 12pt;\">{{'$store.jobs.selectedJob.sJobStartWorkText'|store}}: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobStartWorkTime'|store}}</span></p>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"51ce9378-9778-4d4c-ad27-1a02242b52bf","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"8124d5d2-6415-4baa-99a2-c93d74426f38","content":"Previous","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobStartWork == true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"NoAccess\" });"},"_auto_id_":"9dc37750-0ee3-4084-a5c8-45c7466558b1"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"7ca4547a-2d97-4f10-9676-79cd2e9ae8f3","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobStartWork == false || $form.invalid"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var originalEstimated = cti.store.jobs.selectedJob.originalEstimatedValue;\nvar selectedEstimated = cti.store.pages.StartingWork.estimatedDuration.value;\n\nif(cti.store.variables.estimatedOverrideSelected) {\n  if(originalEstimated === selectedEstimated) {\n    cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n  } else {\n    if(cti.store.variables.estimatedOverride) {\n      cti.store.jobs.selectedJob.originalEstimatedValue = selectedEstimated;\n      cti.fnCalcSMVChange();\n      cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n    } else {\n      cti.utils.callAction('go-to-page', { \"name\": \"EstimatedOverride\" });\n    }\n  }\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });\n}\n\ncti.store.jobs.selectedJob.sWorkToBeDoneDetail = cti.store.pages.StartingWork.workDescription;"},"_auto_id_":"68a23321-fc8f-4877-b6ef-ee0359b03eb1"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"RiskAssessment","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"61252182-6921-49e3-ae64-7ccd7c3f0a0a","content":"<h4 class=\"title\">Risk Assessment</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"d791274f-74e3-4ae3-ba0f-6379920cdfe8","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"RiskAssessment","componentInstanceId":"ae6d683d-ed37-4524-a9a5-34ad1f8829be","function":"open"},"_auto_id_":"7fb2826b-d4c5-487c-85b3-be99829e3860"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"bc5189f5-af09-47db-8b1d-2270b19d779f","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"fac33efc-fcb5-4f10-bf5e-0a3f6ce4557f"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"93717d50-95a6-42b5-a7a0-ea5ad3e80a70","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"16317eb9-7064-4e06-bd36-b49d4ff0cff8"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"7d33380e-0c63-49d9-a7c9-05c4f47a5554","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6ee6f0fd-5811-4a44-9f58-aab9d04038eb"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"82828e5f-2250-4642-833b-e67043dc3faa","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"500a4884-c884-4509-a7f7-8eae76f0f2b5"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"b9709f73-6972-41ed-9b56-9ab5230c78f4","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"56946b71-dd07-4f73-9554-e4414539f2ee"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"20065d4d-bc04-4d14-a0bd-ec9909eba14e","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"RiskAssessment","componentInstanceId":"790c49a2-b33a-4b10-a151-4057862dcdce","function":"show"},"_auto_id_":"a49b23b5-a806-4d25-9810-f94249b0ed58"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9094b192-1ff6-479e-aff7-e35576396b31"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"df010049-2382-4904-8060-99767fdc3a31","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"88aaf061-8f74-4a82-8ae2-8d452b050b89"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"1197cb78-6b2d-4f1c-b8f3-63a9ba74f203","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"80f6c1ed-0dab-4d1e-b3c2-54f233d5f5c8"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"ae6d683d-ed37-4524-a9a5-34ad1f8829be","attributes":{},"expressions":{}}],"_auto_id_":"6a9c7e38-29cd-4c58-9801-f5f1658f15a2","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"36cb574f-8195-485c-ba38-a8728baa7c5c","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"790c49a2-b33a-4b10-a151-4057862dcdce","attributes":{},"expressions":{}},{"name":"html_riskassessment","type":"content","item-type":"html","_auto_id_":"b3a24983-4aab-45ab-99a0-48a6e96f5e3b","content":"<h4>The <span style=\"font-weight:bold\">Risk Assessment</span> must be completed prior to carrying out daily works.</h4>\n<hr>","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""}},{"name":"questionOne","type":"choice","item-type":"radio","_auto_id_":"24f3e04e-9de0-4f9c-9683-db576fd6fd49","label":"I have identified and put into place control measures for all the significant work I am required to carry out. I have referred to RA Guidance and generic RA as required.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[],"validators":[]},{"name":"questionTwo","type":"choice","item-type":"radio","_auto_id_":"f95b2d15-33bb-4c22-a9fd-20f52f9db494","label":"I have identified all the persons exposed to the work I am carrying out and have included them in my risk assessment having put in place any necessary control measures to protect them.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionThree","type":"choice","item-type":"radio","_auto_id_":"923c4a48-123b-4acc-9c4d-201813b5099e","label":"The tools and equipment I am planning to use are suitable for the task and to the best of my knowledge, free from faults and defects.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionFour","type":"choice","item-type":"radio","_auto_id_":"ff54026a-b66a-4b6d-b080-7b1ebb2c45bc","label":"I have identified all the PPE equipment and will ensure it is worn correctly.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionFive","type":"choice","item-type":"radio","_auto_id_":"890b8234-af86-4e54-ac35-3c4e1c712f04","label":"Access equipment used is within its period of inspection, will only be used by those that are trained to do so, and I will abide by the 'Working at Height' safety instructions.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionSix","type":"choice","item-type":"radio","_auto_id_":"502db474-0127-4520-a35f-e9336c19189e","label":"Access equipment used is within its period of inspection, will only be used by those that are trained to do so, and I will abide by the 'Working at Height' safety instructions.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionSeven","type":"choice","item-type":"radio","_auto_id_":"4aadee15-af3e-4e5d-885d-ff7d4cf965fd","label":"If the work involves manual handling I will ensure that the load is within my lifting capability.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"questionEight","type":"choice","item-type":"radio","_auto_id_":"eb2c8a36-37b3-40c6-b76e-9ce084d03751","label":"If the task involves the use of any hazardous substances (including asbestos) I will follow the COSHH safety data sheet/asbestos procedures as necessary and ensure all precautions are taken.","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"($store.payloads.riskAssessmentPayload == undefined || $store.payloads.riskAssessmentPayload == \"\") && $store.jobs.selectedJob.bRAStatus != \"Failed Risk Assessment\""},"message":"This is a required field","classes":"cb-bias-last","actions":[]},{"name":"confirmRiskAssessment","type":"choice","item-type":"radio","_auto_id_":"4aaa99a4-5e33-4216-9f25-56daf79d5845","label":"Have you read and understood the full Risk Assessment Policy relating to this type of work and is it safe to proceed to do the work?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.payloads.riskAssessmentPayload != undefined && ($store.jobs.selectedJob.bRAStatus == false || $store.jobs.selectedJob.bRAStatus == true)"},"message":"This is a required field","classes":"cb-bias-last","actions":[],"validators":[]},{"name":"confirmRASignature","type":"user-input","item-type":"signature","_auto_id_":"e64a165a-4e07-40d1-a02f-6b412ab41f90","label":"Operative Signature:","required":false,"expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"1\" && $store.payloads.riskAssessmentPayload != undefined && $store.payloads.riskAssessmentPayload != undefined && ($store.jobs.selectedJob.bRAStatus == false || $store.jobs.selectedJob.bRAStatus == true)"},"validators":[],"actions":[]},{"name":"html_rafailed","type":"content","item-type":"html","_auto_id_":"131656a4-f5a3-4147-adcc-4b65a201b48d","content":"<div onclick=cti.fnPhoneCall('manager') style=\"width:100%;text-align:center;\"><p class=\"fa supervisor\"></p></div>\n<h4 class=\"check-fail-header\">One or more of the above checks has failed. Please call your Supervisor by tapping on the icon above before continuing...</h4>","expressions":{"show":"($store.pages.RiskAssessment.questionOne == \"0\" || $store.pages.RiskAssessment.questionTwo == \"0\" || $store.pages.RiskAssessment.questionThree == \"0\" || $store.pages.RiskAssessment.questionFour == \"0\" || $store.pages.RiskAssessment.questionFive == \"0\" || $store.pages.RiskAssessment.questionSix == \"0\" || $store.pages.RiskAssessment.questionSeven == \"0\" || $store.pages.RiskAssessment.questionEight == \"0\") && $store.payloads.riskAssessmentPayload == undefined"}},{"name":"html_ra_abandon","type":"content","item-type":"html","_auto_id_":"9206befc-47e0-48e7-acdb-a15b8a798f58","content":"<div style=\"width:100%;text-align:center;\"><p class=\"fa raabandon\"></p></div>\n<h4 class=\"abandonheader\">Are you sure you want to fail the Risk Assessment and Abandon this job?</h4>","expressions":{"show":"$store.jobs.selectedJob.bRAStatus != true && $store.jobs.selectedJob.bRAStatus != false"}},{"name":"noAccessSafelyReason","type":"choice","item-type":"select","_auto_id_":"a85845ec-7467-4a1f-b8ef-6aef25f47417","label":"Abandon job reason?","required":false,"options":[{"label":"Abusive/Violent Tenant","value":"Abusive/Violent Tenant"},{"label":"Appliance Not Accessible","value":"Appliance Not Accessible"},{"label":"Appliance Under Warranty","value":"Appliance Under Warranty"},{"label":"Arrange for Another Day","value":"Arrange for Another Day"},{"label":"Called Away to Another Job","value":"Called Away to Another Job"},{"label":"Dirty House","value":"Dirty House"},{"label":"Incorrect Part Received","value":"Incorrect Part Received"},{"label":"Minor Only in Property","value":"Minor Only in Property"},{"label":"No Electric On","value":"No Electric On"},{"label":"No Gas Heating","value":"No Gas Heating"},{"label":"No Gas On","value":"No Gas On"},{"label":"No Meter Present","value":"No Meter Present"},{"label":"Office Cancelled","value":"Office Cancelled"},{"label":"Other","value":"Other"},{"label":"Personal","value":"Personal"},{"label":"Sharps","value":"Sharps"},{"label":"Unable to Finish","value":"Unable to Finish"},{"label":"Wrong Trade","value":"Wrong Trade"}],"expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"0\" && $store.jobs.selectedJob.bRAStatus == \"Failed Risk Assessment\""},"message":"This is a required field","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.NoAccess) {\n  if(cti.store.pages.NoAccess.noAccessSafelyReason != undefined) {\n    cti.store.jobs.selectedJob.bJobNoAccessSafely = true;\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"91408798-71d7-423f-9635-f3c3ffffe3d3"}],"option-source":"$store.staticData.abandonJobList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"44028248-b8c2-43f8-9d5e-f5163a2c4f9c","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"6d45ce84-18ad-485f-885f-ab3fa9586967","content":"Previous","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bRAStatus == true || $store.jobs.selectedJob.bRAStatus == false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"NoAccess\" });"},"_auto_id_":"be3736bc-238e-4eb7-a9b0-d52c51f7a9fa"}],"classes":"button-bar-btn"},{"name":"confirm_btn","type":"button","item-type":"button","_auto_id_":"df0ef22b-899e-45a4-ac98-bee881b1a2bb","content":"Confirm","theme":"default","expressions":{"disabled":"$form.invalid","show":"($store.pages.RiskAssessment.questionOne != \"0\" && $store.pages.RiskAssessment.questionTwo != \"0\" && $store.pages.RiskAssessment.questionThree != \"0\" && $store.pages.RiskAssessment.questionFour != \"0\" && $store.pages.RiskAssessment.questionFive != \"0\" && $store.pages.RiskAssessment.questionSix != \"0\" && $store.pages.RiskAssessment.questionSeven != \"0\" && $store.pages.RiskAssessment.questionEight != \"0\") && $store.payloads.riskAssessmentPayload == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\ndelete cti.store.saveActionPayload;\n\ncti.store.pages.RiskAssessment.confirmRiskAssessment = undefined;\n\ncti.utils.updatePage();"},"_auto_id_":"29a386fc-5f76-43d0-8630-c1e2a464db29"}]},{"name":"cancel_btn","type":"button","item-type":"button","_auto_id_":"371a4e2d-94b0-4e14-a522-1bc6bb500776","content":"Cancel","theme":"default","expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"0\" && $store.jobs.selectedJob.bRAStatus == \"Failed Risk Assessment\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.selectedJob.bRAStatus = false;\ncti.store.payloads.riskAssessmentPayload = undefined;\n//cti.utils.destroyPageData('RiskAssessment');\n\ncti.utils.updatePage();"},"_auto_id_":"bcec0525-8ed5-4fbf-8fbd-fb36c83bf980"}],"classes":"button-bar-btn"},{"name":"complete_proceed_btn","type":"button","item-type":"button","_auto_id_":"5fd24323-4bb6-4a90-a4ac-16efe5e33a47","content":"Complete","theme":"default","expressions":{"show":"$store.payloads.riskAssessmentPayload != undefined  && $store.pages.RiskAssessment.confirmRiskAssessment != \"0\"","disabled":"$store.pages.RiskAssessment.confirmRiskAssessment == undefined || $store.pages.RiskAssessment.confirmRASignature == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\nvar payload = cti.store.payloads.riskAssessmentPayload;\n\npayload.questionOne == 1 ? payload.questionOne = \"Y\" : payload.questionOne = \"N\";\npayload.questionTwo == 1 ? payload.questionTwo = \"Y\" : payload.questionTwo = \"N\";\npayload.questionThree == 1 ? payload.questionThree = \"Y\" : payload.questionThree = \"N\";\npayload.questionFour == 1 ? payload.questionFour = \"Y\" : payload.questionFour = \"N\";\npayload.questionFive == 1 ? payload.questionFive = \"Y\" : payload.questionFive = \"N\";\npayload.questionSix == 1 ? payload.questionSix = \"Y\" : payload.questionSix = \"N\";\npayload.questionSeven == 1 ? payload.questionSeven = \"Y\" : payload.questionSeven = \"N\";\npayload.questionEight == 1 ? payload.questionEight = \"Y\" : payload.questionEight = \"N\";\n\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = true;\ncti.store.jobs.selectedJob.bJobStartWork = false;\ncti.store.jobs.selectedJob.sJobStartWorkText = \"Not started yet\";\ncti.store.jobs.selectedJob.iJobStartWorkTime = \"\";\n\ncti.store.variables.jobCollectionType = \"riskassessment\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\ncti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });\n\nwindow.appManager.createTimeList();"},"_auto_id_":"9d30165d-f923-4293-8182-b32757a487de","actions":[]}]},{"name":"abandon_raquestions_btn","type":"button","item-type":"button","_auto_id_":"4d9d7d43-a2f4-4cc7-992e-5f60b01b4353","content":"Abandon RA","theme":"default","expressions":{"show":"($store.pages.RiskAssessment.questionOne == \"0\" || $store.pages.RiskAssessment.questionTwo == \"0\" || $store.pages.RiskAssessment.questionThree == \"0\" || $store.pages.RiskAssessment.questionFour == \"0\" || $store.pages.RiskAssessment.questionFive == \"0\" || $store.pages.RiskAssessment.questionSix == \"0\" || $store.pages.RiskAssessment.questionSeven == \"0\" || $store.pages.RiskAssessment.questionEight == \"0\") && $store.payloads.riskAssessmentPayload == undefined"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = \"Failed Risk Assessment\";\ncti.store.pages.RiskAssessment.confirmRiskAssessment = \"0\";\n\ncti.utils.updatePage();"},"_auto_id_":"d0213a9c-c439-410c-957b-ff9860a4b8ca"}],"classes":"abandon-bar-btn"},{"name":"abandon_confirmcheck_btn","type":"button","item-type":"button","_auto_id_":"573aaabb-f63f-4ec9-a267-f1469ee3503c","content":"Abandon RA","theme":"default","expressions":{"show":"$store.payloads.riskAssessmentPayload != undefined && $store.jobs.selectedJob.bRAStatus == false && $store.pages.RiskAssessment.confirmRiskAssessment == \"0\"","disabled":"$store.pages.RiskAssessment.confirmRiskAssessment == undefined"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = \"Failed Risk Assessment\";\n  \ncti.utils.updatePage();"},"_auto_id_":"83c058e3-5413-4507-9962-697ddd421f00"}]},{"name":"abandon_job_btn","type":"button","item-type":"button","_auto_id_":"f84c54fb-7d85-49b8-ba19-ad3e7680179c","content":"Confirm","theme":"default","expressions":{"show":"$store.pages.RiskAssessment.confirmRiskAssessment == \"0\" && $store.jobs.selectedJob.bRAStatus == \"Failed Risk Assessment\"","disabled":"$store.pages.RiskAssessment.noAccessSafelyReason == undefined"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var pages = [ 'RiskAssessment' ];\ncti.fnPreparePayload(pages);\n\ncti.store.payloads.riskAssessmentPayload = cti.store.saveActionPayload;\nvar payload = cti.store.payloads.riskAssessmentPayload;\n\nif(payload.questionOne != undefined) {\n  payload.questionOne == 1 ? payload.questionOne = \"Y\" : payload.questionOne = \"N\";\n} else {\n  payload.questionOne = \"N/A\";\n}\nif(payload.questionTwo != undefined) {\n  payload.questionTwo == 1 ? payload.questionTwo = \"Y\" : payload.questionTwo = \"N\";\n} else {\n  payload.questionTwo = \"N/A\";\n}\nif(payload.questionThree != undefined) {\n  payload.questionThree == 1 ? payload.questionThree = \"Y\" : payload.questionThree = \"N\";\n} else {\n  payload.questionThree = \"N/A\";\n}\nif(payload.questionFour != undefined) {\n  payload.questionFour == 1 ? payload.questionFour = \"Y\" : payload.questionFour = \"N\";\n} else {\n  payload.questionFour = \"N/A\";\n}\nif(payload.questionFive != undefined) {\n  payload.questionFive == 1 ? payload.questionFive = \"Y\" : payload.questionFive = \"N\";\n} else {\n  payload.questionFive = \"N/A\";\n}\nif(payload.questionSix != undefined) {\n  payload.questionSix == 1 ? payload.questionSix = \"Y\" : payload.questionSix = \"N\";\n} else {\n  payload.questionSix = \"N/A\";\n}\nif(payload.questionSeven != undefined) {\n  payload.questionSeven == 1 ? payload.questionSeven = \"Y\" : payload.questionSeven = \"N\";\n} else {\n  payload.questionSeven = \"N/A\";\n}\nif(payload.questionEight != undefined) {\n  payload.questionEight == 1 ? payload.questionEight = \"Y\" : payload.questionEight = \"N\";\n} else {\n  payload.questionEight = \"N/A\";\n}\n\ndelete cti.store.saveActionPayload;\n\ncti.store.jobs.selectedJob.bRAStatus = \"Failed Risk Assessment\";\ncti.store.pages.RiskAssessment.confirmRiskAssessment = \"0\";\n\ncti.store.variables.jobCollectionType = \"riskassessment\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n\ncti.store.variables.jobEventStatus = \"abandonjob\";\ncti.store.jobs.selectedJob.sResultSummary = \"ABANDON JOB\";\ncti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.RiskAssessment.noAccessSafelyReason.value;\n  \ncti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });"},"_auto_id_":"b2da2678-2570-4c18-9fa9-ea3f3384a737"}],"classes":"abandon-bar-btn"}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"NoAccess","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"d202ec5d-c137-4247-9e34-c731ae8cfa85","content":"<h4 class=\"title\">Access Check</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"c025dbb0-17e4-42e0-8187-61fe9d232a09","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"NoAccess","componentInstanceId":"47ea6fec-c1d6-4291-9eed-1c756646a89e","function":"open"},"_auto_id_":"90138590-cb2a-4544-b7e7-31e06b17342b"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"3cd7910e-5e0b-4124-b3b3-6a048447d58a","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"88325f97-2998-4108-9afe-b2a4de545ba7"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"0f609c11-7723-407d-bb38-1ebad32cf973","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ad50836f-12e2-4f30-9099-0998464e99ce"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"187bedbe-7053-4e63-b006-d850da7e31f1","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9fe9dfe6-da2f-4d6a-a55f-94b6204c0bfe"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"0a7e50cd-7e04-4f94-884b-8d90fd071924","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"158b269c-7d88-42f5-83e3-1be780820f66"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"3ccd4102-c2a4-4ea6-925c-b4355c0fbfdf","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"4af953d9-bd41-407f-b7cb-70989b31525a"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"3f78b29f-c266-4cf5-a081-dfa16aa68353","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"NoAccess","componentInstanceId":"095478d6-0f79-4b07-8cee-889d36307f55","function":"show"},"_auto_id_":"193ef361-7973-44bd-9ee1-0bb7213dc4d6"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b6c3a209-5055-4b03-9e16-068b30fc2a08"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"5d3a6bb9-18cb-4d98-ad8f-0697b945c094","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9d6ee441-9021-4ac4-af4c-1bb54a2ce7ae"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"184774da-ab03-45a0-8891-57e2f0377af6","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"d253405d-8902-45a1-b6da-70067f6fbbde"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"47ea6fec-c1d6-4291-9eed-1c756646a89e","attributes":{},"expressions":{}}],"_auto_id_":"235194ab-8ab6-418e-b574-d43f56874c02","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"2f2ec030-4ec7-4036-939c-5a5277014c64","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"095478d6-0f79-4b07-8cee-889d36307f55","attributes":{},"expressions":{},"actions":[]},{"name":"gainingAccess","type":"choice","item-type":"radio","_auto_id_":"c819b40b-dca4-41e3-94a3-1489325eb858","label":"Are you able to gain access to the property?","required":true,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob != undefined) {\n  cti.store.pages.NoAccess.gainingAccessSafely = undefined;\n  cti.store.pages.NoAccess.noAccessReason = undefined;\n  cti.store.pages.NoAccess.noAccessSafelyReason = undefined;\n  cti.store.jobs.selectedJob.photos = undefined;\n\n  cti.utils.updatePage();\n}"},"_auto_id_":"82b2642f-ec82-4ea3-9a89-400a8f934ad7"}],"message":"This is a required field","validators":[]},{"name":"gainingAccessSafely","type":"choice","item-type":"radio","_auto_id_":"5879693c-fee9-4653-ab2c-3a82484624c0","label":"Are you able to safely enter the property?","required":false,"options":[{"label":"Yes","value":1},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"1\""},"classes":"cb-bias-last","actions":[],"message":"This is a required field","validators":[]},{"name":"html_noaccessphoto","type":"content","item-type":"html","_auto_id_":"0d06f019-270c-481f-80de-015aba176511","content":"<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('NoAccess','5c61cee9-3f4f-442b-b436-8e9ceab7c9da')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""}},{"name":"btnTakePhotoNoAccess","type":"button","item-type":"button","_auto_id_":"2e12224d-ee1d-471f-83e8-47bca0fd430a","content":"Take Photo","theme":"default","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""},"classes":"takephoto-btn","actions":[{"event":"click","type":"call-component-function","data":{"page":"NoAccess","componentInstanceId":"5c61cee9-3f4f-442b-b436-8e9ceab7c9da","function":"takePhoto"},"_auto_id_":"5b354bc8-23e4-4a76-b651-6fbf2cd9ab50"}]},{"name":"NoAccessPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"98807067-3c95-452a-9d3d-74d7a04fa651","_auto_id_":"5c61cee9-3f4f-442b-b436-8e9ceab7c9da","attributes":{"captureCategory":"No Access","displayCategory":"No Access","maxPhotos":1},"expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""}},{"name":"noAccessReason","type":"choice","item-type":"select","_auto_id_":"5a5f2408-6bb6-4ec9-a50b-39fe7dd5c252","label":"No access reason?","required":false,"options":[{"label":"Demolished Property","value":"Demolished Property"},{"label":"No Answer At Door","value":"No Answer At Door"},{"label":"No Answer At Door - Entry System","value":"No Answer At Door - Entry System"},{"label":"No Keys Available","value":"No Keys Available"},{"label":"Not Convenient","value":"Not Convenient"},{"label":"Other","value":"Other"},{"label":"Other Trade On Site","value":"Other Trade On Site"},{"label":"Right To Buy","value":"Right To Buy"},{"label":"Tenant Away","value":"Tenant Away"},{"label":"Tenant Bereavement","value":"Tenant Bereavement"},{"label":"Tenant ill Or In Hospital","value":"Tenant ill Or In Hospital"},{"label":"Tenant Refused Access","value":"Tenant Refused Access"}],"expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\""},"message":"This is a required field","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.NoAccess) {\n  if(cti.store.pages.NoAccess.noAccessReason != undefined || cti.store.media.noAccessPhoto != undefined) {\n    cti.store.jobs.selectedJob.bJobNoAccess = true;\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"a8eca275-3f65-4490-8f80-ab53ca651678"}],"option-source":"$store.staticData.noAccessList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"noAccessSafelyReason","type":"choice","item-type":"select","_auto_id_":"ed14a74d-80fe-4e74-9d24-2654e4f2f20b","label":"Abandon job reason?","required":false,"options":[{"label":"Abusive/Violent Tenant","value":"Abusive/Violent Tenant"},{"label":"Appliance Not Accessible","value":"Appliance Not Accessible"},{"label":"Appliance Under Warranty","value":"Appliance Under Warranty"},{"label":"Arrange for Another Day","value":"Arrange for Another Day"},{"label":"Called Away to Another Job","value":"Called Away to Another Job"},{"label":"Dirty House","value":"Dirty House"},{"label":"Incorrect Part Received","value":"Incorrect Part Received"},{"label":"Minor Only in Property","value":"Minor Only in Property"},{"label":"No Electric On","value":"No Electric On"},{"label":"No Gas Heating","value":"No Gas Heating"},{"label":"No Gas On","value":"No Gas On"},{"label":"No Meter Present","value":"No Meter Present"},{"label":"Office Cancelled","value":"Office Cancelled"},{"label":"Other","value":"Other"},{"label":"Personal","value":"Personal"},{"label":"Sharps","value":"Sharps"},{"label":"Unable to Finish","value":"Unable to Finish"},{"label":"Wrong Trade","value":"Wrong Trade"}],"expressions":{"show":"$store.pages.NoAccess.gainingAccessSafely == \"0\""},"message":"This is a required field","validators":[],"actions":[{"event":"change","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.NoAccess) {\n  if(cti.store.pages.NoAccess.noAccessSafelyReason != undefined) {\n    cti.store.jobs.selectedJob.bJobNoAccessSafely = true;\n  }\n}\n\ncti.utils.updatePage();"},"_auto_id_":"be68559a-3d91-4be4-a842-0c5b6e840341"}],"option-source":"$store.staticData.abandonJobList","label-property":"sSubResultSummary","value-property":"sSubResultSummary"},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"c137dfd8-aa6e-493b-b36e-9d4f91c959d3","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"53e7c95d-2376-4f1c-ba58-1034ce0f4e0b","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"ArrivedOnSite","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"bb22a2c6-fda2-4900-9036-f0e4bd473c25","content":"Next","theme":"default","expressions":{"show":"($store.pages.NoAccess.gainingAccess === undefined || $store.pages.NoAccess.gainingAccess == \"1\") && ($store.pages.NoAccess.gainingAccessSafely === undefined || $store.pages.NoAccess.gainingAccessSafely == \"1\")","disabled":"$store.pages.NoAccess.gainingAccess === undefined || $store.pages.NoAccess.gainingAccessSafely === undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.bJobNoAccessSafely == undefined) cti.store.jobs.selectedJob.bJobNoAccessSafely = false;\ncti.store.jobs.selectedJob.bGainedAccess = true;\nif(cti.store.jobs.selectedJob.bRAStatus == undefined) cti.store.jobs.selectedJob.bRAStatus = false;\n\nif(cti.store.jobs.selectedJob.bRAStatus) {\n  cti.utils.callAction('go-to-page', { \"name\": \"StartingWork\" });\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"RiskAssessment\" });\n}"},"_auto_id_":"7d7c291f-9765-49da-89ea-a6304ee277fa"}]},{"name":"sendnoaccess_btn","type":"button","item-type":"button","_auto_id_":"26423c38-12a2-4180-bce7-53924f90cab0","content":"Send No Access","theme":"default","expressions":{"show":"$store.pages.NoAccess.gainingAccess == \"0\"","disabled":"$store.pages.NoAccess.noAccessReason === undefined"},"classes":"abandon-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var photos = cti.store.jobs.selectedJob.photos;\nvar exists = false;\n\nfor(var i in photos) {\n  if(photos[i].category === \"No Access\") { \n    exists = true; \n    break; \n  }\n}\n\nif(exists) {\n  cti.store.variables.jobEventStatus = \"noaccess\";\n  cti.store.jobs.selectedJob.sResultSummary = \"NO ACCESS\";\n  cti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.NoAccess.noAccessReason.value;\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_noaccessphoto\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning\",\n      \"text\": \"You must take a photo to provide alongside reason for No Access to the property.\"\n    }\n  );\n}"},"_auto_id_":"1e8b34c7-c70c-4289-b0ca-176df1e53b7e"}]},{"name":"abandonjob_btn","type":"button","item-type":"button","_auto_id_":"9a448c68-8f02-4f27-b812-e894ce32c3bc","content":"Abandon Job","theme":"default","expressions":{"show":"$store.pages.NoAccess.gainingAccessSafely == \"0\"","disabled":"$store.pages.NoAccess.noAccessSafelyReason === undefined"},"classes":"abandon-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.bJobNoAccessSafely) {\n  cti.store.variables.jobEventStatus = \"abandonjob\";\n  cti.store.jobs.selectedJob.sResultSummary = \"ABANDON JOB\";\n  cti.store.jobs.selectedJob.sResultSummarySubReason = cti.store.pages.NoAccess.noAccessSafelyReason.value;\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"SubmitPhotos\" });\n}"},"_auto_id_":"3be411ea-a746-4aad-8977-bbb507f834c0"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"ArrivedOnSite","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"5b711dcb-d4ba-404a-9a0a-c59ef12192fd","content":"<h4 class=\"title\">Arriving On Site</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"6564ad43-6800-4b2c-bf9c-0dcaadef9a68","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"ArrivedOnSite","componentInstanceId":"98906a8c-2c82-4116-b825-0fc8dbe5ec74","function":"open"},"_auto_id_":"d7889f07-1084-457b-9aea-abc2eb46f2dc"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"edd32389-80b3-4646-bc9e-bd79f683817a","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"4ff180c1-25b0-43d0-b590-91eca7ff56d7"}]},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"dff97923-a8d1-4178-bb55-56e7c7c4cad1","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"f0e79f77-1a80-48ab-bf3e-d935d4ff01ac"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"601df277-5e5d-45f2-8351-e40515e67d9d","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ec999f99-78ab-4e38-8019-7a502a495e2a"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"fc6f6089-1b18-4772-89f6-51a1ecefcab9","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"2e7a704b-866d-42f1-bc78-c14158bad134"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"c2bd9319-4bfe-4737-92bf-490861e0550a","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c4dc984a-0053-4538-a93c-a2f13a752866"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"1c583c17-1418-4e55-abe4-d9c76b0a1e09","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"ArrivedOnSite","componentInstanceId":"6bc5d457-b51e-4094-b2fd-f33fc704e431","function":"show"},"_auto_id_":"33129445-44c9-4529-97cb-d667fc1b94bf"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"c0c2af89-0f86-4f1f-abf7-a67b6f3ee8de"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"58c25e95-b8d0-4153-bda4-f1e95e46fbfe","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"6dea3704-afc0-4836-ad2b-63ee60253a73"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"fb5216d1-0b62-4f50-88f7-ccd1f234ab33","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"51ca0f5a-2983-4112-9c77-30524d21e6b8"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"98906a8c-2c82-4116-b825-0fc8dbe5ec74","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"88f24c76-80f6-4d44-91cf-3d7fdc6e6f76","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"f754c65b-6c2d-4c5c-bb1b-d9553d6f9657","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"6bc5d457-b51e-4094-b2fd-f33fc704e431","attributes":{},"expressions":{}},{"name":"html_arriving_pending","type":"content","item-type":"html","_auto_id_":"402500e2-a436-4d8c-bb45-f16ac081a260","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelEnded == false"}},{"name":"html_arriving_arrived","type":"content","item-type":"html","_auto_id_":"a691053d-7c54-4a97-98e5-293dc6eea1e2","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>\n<div class=\"arriving\">\n\t<i id=\"arriving-spinner\" class=\"fa arrived-ticked\"></i>\n</div>\n<h4 class=\"completeheader\">Arrived On-Site</h4>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelEnded == true"}},{"name":"sendArrivedMessage","type":"button","item-type":"button","_auto_id_":"0082348a-dacf-42da-b11d-16d4482c2692","content":"End Travel","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelEnded == false"},"classes":"travel-btn","actions":[{"event":"click","type":"call-function","data":{"name":"fnEndTravel"},"_auto_id_":"af457a51-a326-4a24-889a-28f3596115b9"}]},{"name":"html_travelstatus","type":"content","item-type":"html","_auto_id_":"9ff094f6-5b65-416a-8b1a-7247ed8cdb50","content":"<p style=\"font-size: 12pt;\">{{'$store.jobs.selectedJob.sJobTravelEndedText'|store}}: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobEndedTravelTime'|store}}</span></p>\n<hr>\n<h5 style=\"font-weight:bold;\">Contact Name</h5>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sTenant_Name'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Address</h5>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_1'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_4'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sPostcode'|store}}</p>\n<hr>","expressions":{}},{"name":"html_activatedlone","type":"content","item-type":"html","_auto_id_":"24b18a8e-7c4e-4300-9510-3b74dc4f0973","content":"<div class=\"arriving\">\n\t<i id=\"arriving-spinner\" class=\"fa arrived-ticked\"></i>\n</div>\n<h4 class=\"completeheader\">Activated Lone Working Device</h4>","expressions":{"show":"$store.jobs.selectedJob.bLoneDeviceStatus == true"}},{"name":"rdoLoneWorkingDevice","type":"choice","item-type":"radio","_auto_id_":"491f1e7b-a2b3-49a2-9c89-76cebd17cd8a","label":"Have you activated your Lone Working Device?","required":false,"options":[{"label":"Yes","value":"Yes"},{"label":"No","value":"No"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"false"},"classes":"cb-bias-last","actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"14480115-db13-4604-a7e8-ce46678fb82e","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"7e254149-d6da-430d-8448-df9b9c199c5a","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"StartTravel","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"2f0d35e5-f4fa-4ecc-9465-a498890ba2f0","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobTravelEnded == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.jobs.selectedJob.bJobNoAccess == undefined) cti.store.jobs.selectedJob.bJobNoAccess = false;\ncti.utils.callAction('go-to-page', { \"name\": \"NoAccess\" });"},"_auto_id_":"2f274b89-7bfb-4fd3-b9ee-8f3d071b6737"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"StartTravel","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"5016c264-2a62-4f9a-bba9-5caab70badd2","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var travelContainer = document.getElementById('travel-container');\nvar iconTravelContainer = document.getElementById('icon-travel-container');\n\ntravelContainer.href = \"geo:0,0?q=\" + cti.store.jobs.selectedJob.aPropertyDetail.sPostcode.replace(/\\s/g,'');\niconTravelContainer.href = \"geo:0,0?q=\" + cti.store.jobs.selectedJob.aPropertyDetail.sPostcode.replace(/\\s/g,'');"},"_auto_id_":"7a1c0052-15f2-41a3-bfd9-855ba9607e4c"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"bf39615a-beb4-43ea-af4f-d497120c3c17","content":"<h4 class=\"title\">Start Travel</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"d009218b-2cde-4805-93d9-0a3020d3e7d4","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"StartTravel","componentInstanceId":"3a4903de-ef6f-49bf-a237-f26069ad3ce0","function":"open"},"_auto_id_":"755e135a-9832-49a7-b253-c8d82415d382"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"eda532be-6225-49e8-bd7c-e82d3e6fa93c","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"136f0f59-27f9-406d-a4e3-bd98622cd3f8"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"b9f682e9-3eea-45b7-af2c-a020b12deb06","content":"Job List","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"3e3b0cb9-97e1-4176-8a44-fdcd7bba371c"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"e72c3dd0-d3ce-4c75-ab7a-16c9b79eaa52","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"ec3d4b1b-7dfd-4edd-8f20-b2b17f2dd9cb"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"eec33b3b-04cf-4fd5-9a71-8013b56267f2","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"34dcd414-c65d-47d1-918f-bdf4fdb425cc"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"447b7f05-7495-4651-b14f-0cb64633c90a","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b4ab90b0-d149-49a1-a36a-ee08b0f7a4be"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"6d7ff1a2-a42f-4cc6-bead-bc41fe4b0b17","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"1c6c1347-ad93-45e5-9788-f15f49e15ea4"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"fafd1618-c407-4277-a9f5-8019c1ce9ec6","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"StartTravel","componentInstanceId":"ace38191-5a84-42ef-955c-d91b48aefff2","function":"show"},"_auto_id_":"70f68410-a1a3-48bf-a20b-0e3bf8b07cd1"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"1d88c59c-f212-4edc-99b6-30ac74fad92f"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"84a7b7ce-5fbc-49a7-96a7-298686369fa7","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"443a8f30-95e5-454a-8318-3f52d74d0f52"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"c82d6181-5680-43e6-b110-896b7b7859c2","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"3b49d50e-a4f7-4fad-bab5-bafac1881457"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"e03073ed-ed3f-434b-a747-0e777d1b5bc4","content":"Logout","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted != true"},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"7e8f050c-af38-405c-9660-5f69e15fba47"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"3a4903de-ef6f-49bf-a237-f26069ad3ce0","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"e3106626-5d47-4820-b644-fbbf3e4c4570","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"ae829d68-3547-4bd3-8fb8-13e7b87f1492","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"ace38191-5a84-42ef-955c-d91b48aefff2","attributes":{},"expressions":{}},{"name":"html_travelling_pending","type":"content","item-type":"html","_auto_id_":"9e071cdf-b9e3-48df-921e-ed0e780770f2","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted == false"}},{"name":"html_travelling_started","type":"content","item-type":"html","_auto_id_":"9f770832-52ff-40b6-ba78-4e66073c9293","content":"<p style=\"margin-bottom:2vh;font-weight:bold;\">Appointment Slot: <span>{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>\n<div class=\"starting\">\n\t<i id=\"starting-spinner\" class=\"fa started-ticked\"></i>\n</div>\n<h4 class=\"completeheader\">En-Route Message Sent</h4>","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted == true"}},{"name":"sendEnrouteMessage","type":"button","item-type":"button","_auto_id_":"aa359135-c92b-49f5-8056-66101f00f366","content":"Send En-Route Message","theme":"default","expressions":{"show":"$store.jobs.selectedJob.bJobTravelStarted == false"},"classes":"travel-btn","actions":[{"event":"click","type":"call-actionflow","data":{"name":"ValidateJob"},"_auto_id_":"fe365262-a31c-44da-90c6-8c87ca96f60e"}]},{"name":"html_travelstatus","type":"content","item-type":"html","_auto_id_":"92079018-51fb-48c1-b9cd-4226e1d4294a","content":"<p style=\"font-size: 12pt;\">{{'$store.jobs.selectedJob.sJobTravelStartedText'|store}}: <span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.iJobStartedTravelTime'|store}}</span></p>\n<hr>\n<div style=\"width:100%;text-align:center;\"><a target=\"_blank\" class=\"fa getmethere buttonDisabled\" id=\"icon-travel-container\"></a></div>\n<div style=\"width:100%;text-align:center;\"><a target=\"_blank\" class=\"btn btn-default getmethere-btn\" id=\"travel-container\">Get Me There</a></div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"f1a32de4-191b-4481-88ed-241e6b201e86","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"549897ae-ac9b-4d9b-a29f-91f6b042851f","content":"Previous","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobTravelStarted === true"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var selectedJob = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\n\nif(selectedJob.length > 0) {\n  cti.utils.callAction('go-to-page', { \"name\": \"Warnings\" });\n} else {\n  cti.utils.callAction('go-to-page', { \"name\": \"JobAccessDetails\" });\n}"},"_auto_id_":"038cba69-a447-4d35-ab2a-8a2a929f8831"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"fa29ea78-1f51-45bc-aac7-57acd32c9618","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.bJobTravelStarted == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(!cti.store.jobs.selectedJob.bJobTravelEnded) {\n  cti.store.jobs.selectedJob.bJobTravelEnded = false;\n  cti.store.jobs.selectedJob.sJobTravelEndedText = \"Pending Arrival\";\n}\n\nif(cti.store.jobs.selectedJob.bLoneDeviceStatus == undefined) cti.store.jobs.selectedJob.bLoneDeviceStatus = false;\n\ncti.utils.callAction('go-to-page', { \"name\": \"ArrivedOnSite\" });"},"_auto_id_":"e451b410-4efb-4bb0-974f-de2ccb5067a0"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"Warnings","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"c0fd4618-383e-4d29-b3a7-9fbee422694b","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var warnings = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\nvar allChecked = true;\n\nfor(var i in warnings) {\n  var thisWarning = warnings[i];\n  \n  if(thisWarning.checked === \"unchecked-warning\") {\n    allChecked = false;\n    break;\n  }\n}\n\nvar element = document.getElementById('select-all');\n\nif(allChecked) {\n  element.classList.remove('all-unchecked-warning');\n  element.classList.add('all-checked-warning');\n  \n  var objDiv = document.getElementById(\"scrollable\");\n  objDiv.scrollTop = objDiv.scrollHeight;\n} else {\n  element.classList.remove('all-checked-warning');\n  element.classList.add('all-unchecked-warning');\n}\n\ncti.utils.updatePage();"},"_auto_id_":"47302035-7daa-43cc-a8a9-5318a8166a46"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"31e6b0f1-ee58-4476-b78e-056e857df3d4","content":"<h4 class=\"title\">Warnings</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"3b00ab4e-f7ff-4e48-a060-b022f13a866e","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobsList","componentInstanceId":"97135165-829c-46db-bd4a-7d7aa39f16fd","function":"open"},"_auto_id_":"85732849-9e33-4731-a110-b118561db3d6"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"a4d5c893-186e-430f-94f4-804619bcbaa6","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"72e8198e-5bd8-4781-8841-2e1541abe37e"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"f7eb4090-3d7e-4c5b-b750-355645508a8d","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"8fae09ab-8391-4ff5-b86c-6011ad21482b"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"953d474c-ce86-46ce-ada2-10fbdc3be712","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"cb2d9623-5b39-488b-bb45-1fe0a90f8b52"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"03a6d622-1d9f-4a42-b2c0-d285a17ec8ff","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"4b9861c7-a25a-4e59-b35a-2d9ad25b7288"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"5ab1c7d4-a8af-4e8a-9811-3ce9044899e4","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"b5deb981-640e-44e1-bd86-12ae038040d6"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"24d8be5e-e214-4be7-8b0e-00e0803e8d1c","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"89666725-bbe8-40c5-82f1-5f3b04403fe6"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"703f80f8-0367-4158-8d7f-f300d12617dd","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"Warnings","componentInstanceId":"19d66f33-fd24-4e81-a674-468947fe1091","function":"show"},"_auto_id_":"82380714-ccb9-4ec5-87f2-7f18504247fa"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"412f1e6f-492b-43e1-93f2-e0a28f321beb"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"4dc8f630-a048-4290-8e2f-b3b79f454c32","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"cb9d1364-7bf3-4f8b-9975-5fb34d9f522e"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"c3f46896-a7c6-4adc-95cc-93c36b4dc7ac","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"e117f51f-82d1-45e2-9d00-f21a3f0f3802"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"3851df42-9c16-40c2-bc9c-5c22f47ac049","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"d89cf0f0-d910-44ca-82f7-dc24cf15276a"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"cc87013b-3b36-4a6a-a471-46283b3ff0cb","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"171ab628-1ed0-445b-8a7d-8b105350903c","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","_auto_id_":"798d1e1a-5e69-4bf0-bede-a5f52ad504c6","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"19d66f33-fd24-4e81-a674-468947fe1091","attributes":{},"expressions":{}},{"name":"html_warnings","type":"content","item-type":"html","_auto_id_":"b2aecea6-1316-4677-969b-76a4eb9719df","content":"<p>Please check and select the below warnings to confirm you have read and confirmed them. Current number of Warnings for this property is: <strong><span style=\"color:#0072C6\">{{'$store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings.length'|store}}</span></strong></p>\n<hr>\n<div style=\"display:inline-block;width:100%;\">\n  <div class=\"fa fa-list\"></div>\n  <div class=\"warning-short\">Select All...</div>\n  <div id=\"select-all\" class=\"fa all-unchecked-warning\" onclick=\"cti.fnCheckAllWarnings();\"></div>\n</div>","expressions":{}},{"name":"list_warnings","type":"content","item-type":"list","_auto_id_":"810b5405-bc0b-4f70-9ab7-3195a9bea7a8","search":"","classes":"","expressions":{},"model":"$store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings","theme":"bootstrap","actions":[{"event":"click","type":"call-function","data":{"name":"fnCheckWarning","params":{"warning":"{{$data.$item}}","index":"{{$data.$item.index}}"}},"_auto_id_":"48ffce0c-75da-41db-8091-bc4258c93f88"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_warnings_html","_auto_id_":"382ff9e3-d7ac-4ee6-9f8d-5e3d52389798","content":"<div style=\"display:inline-block;width:100%;padding:5px;\">\n  <div style=\"display:inline-block;width:100%;\">\n    <div class=\"{{$data.$item.outerClass}} fa {{$data.$item.innerClass}}\"></div>\n  \t<div class=\"warning-short\">{{$data.$item.sWarnReason}}</div>\n    <div class=\"fa {{$data.$item.checked}}\"></div>\n  </div>\n  <div style=\"margin-bottom: 5px;\">{{$data.$item.sWarnCategory}}</div>\n  <div>{{$data.$item.sWarnText}}</div>\n</div>"}]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"029a340b-d676-4ce0-8f33-7b8b67c6907f","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"d21b8bac-62e3-46d6-abb7-c8b5c30d57ec","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"JobAccessDetails","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"33f97661-b74c-491b-a48c-202791f65509","content":"Next","theme":"default","expressions":{"disabled":"$store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked == false"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(!cti.store.jobs.selectedJob.bJobTravelStarted) {\n  cti.store.jobs.selectedJob.bJobTravelStarted = false;\n  cti.store.jobs.selectedJob.sJobTravelStartedText = \"Pending Start of Travel\";\n} else {\n  cti.store.jobs.selectedJob.sJobTravelStartedText = \"En-Route Time\";\n}\n\nif(!cti.store.jobs.selectedJob.aPropertyDetail.bPropertyWarningsDataCollection) {\n  cti.store.variables.jobCollectionType = \"warnings\";\n  cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n}\n\ncti.utils.callAction('go-to-page', { \"name\": \"StartTravel\" });"},"_auto_id_":"518a3bbd-6b95-4dd7-b25c-c8e147c5a385"}]}],"expressions":{}}],"expressions":{}}]},{"start":false,"name":"JobAccessDetails","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"3f32e125-9a29-424f-9850-0fcb328c82d3","content":"<h4 class=\"title\">Job and Access Detail</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"317e7f47-04be-410c-b38e-053b47fa96f5","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobAccessDetails","componentInstanceId":"155669c1-c374-4d1f-bf83-f3cdfbeb8f1c","function":"open"},"_auto_id_":"d3e344b6-ada6-4e77-b181-3275ae917b00"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"7061f15c-e9c3-441d-be47-860cd9cacf19","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"10739810-89b4-4e0c-bec1-0ba34a704798"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"9f8ccaa8-9b60-447c-94f1-3502050f6667","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"4a0d8543-d00c-4af2-9e68-278b94fe9a8e"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"79fcf8cf-7168-4d2d-bf92-0acd1e2be6f6","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"54870057-8bd8-41d7-9515-91cfcb0434f2"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"68e880d6-214a-47d3-bef4-232311240956","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"4f3f958c-3aa4-479d-97af-13c03a10958b"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"7b5f5a4f-2b93-481f-8d28-dc6ee9e0fde0","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"026a15bb-d17e-4101-a57e-124dbf24cbc9"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"87d70663-5d39-45f3-b204-4f3f3bf26796","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d2ce5247-3bfb-4d2b-af09-6e231e267fc5"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"9ee1c78e-0f3a-4098-b025-cf022dc4acf2","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobAccessDetails","componentInstanceId":"c9a5087e-b1e3-4b51-9201-2a8a1fa91022","function":"show"},"_auto_id_":"96df3b1c-2050-4535-b25a-0373f2f95904"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"9025da9f-b735-4125-8c47-eed79775aeef"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"06e90e5d-a61f-42f9-b899-74a3a3f47397","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"446afbd2-04e6-46ee-ac42-d5dcdac81240"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"f6626d3d-5079-41e1-b5b0-2fbc5404f362","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"46917abe-7f59-423d-a356-f00773641d6b"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"00d3bb1e-b3b9-448f-a6a7-ef10e95932be","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"be429dc8-91e2-4c2b-afc9-9a9163eb8d13"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"155669c1-c374-4d1f-bf83-f3cdfbeb8f1c","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"969ca65d-790f-42b8-b95a-d37a4a5e4b42","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"c9a5087e-b1e3-4b51-9201-2a8a1fa91022","attributes":{},"expressions":{}},{"name":"html_jobaccessdetail","type":"content","item-type":"html","_auto_id_":"955afef9-1b89-4513-b224-c17f61e0b041","content":"<h4>Order Details</h4>\n<hr>\n<h5 style=\"font-weight:bold;\">Summary:</h5>\n<p>{{'$store.jobs.selectedJob.sProblemSummary'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Description:</h5>\n<p>{{'$store.jobs.selectedJob.sProblemDetail'|store}}</p>\n<hr>\n<h5 style=\"font-weight:bold;\">Access Details:</h5>\n<p>{{'$store.jobs.selectedJob.sAccessDetail'|store}}</p>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"072e9387-de78-46c0-9b2c-100dca355330","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"nav-button","_auto_id_":"9faeda65-9401-4858-bd56-1a808729b3e0","extends":{"type":"button","item-type":"button"},"content":"Previous","actions":[{"event":"click","type":"go-to-page","data":{"name":"TenantDetails","isConditional":false,"expressions":{}}}],"expressions":{},"theme":"default","classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"b70cccf1-f953-42aa-a242-78fb1ab0d2be","content":"Next","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var propertyDetail = cti.store.jobs.selectedJob.aPropertyDetail;\nvar index = -1;\n\nif(propertyDetail.aPropertyWarningsChecked == undefined) { \n  propertyDetail.aPropertyWarningsChecked = false; \n}\n  \nif(propertyDetail.aPropertyWarnings) {\n  if(propertyDetail.aPropertyWarnings.length > 0) {\n    for(var i in propertyDetail.aPropertyWarnings) {\n      var warning = propertyDetail.aPropertyWarnings[i];\n      var iconClass = undefined;\n      \n      if(warning.checked == undefined) {\n        warning.checked = \"unchecked-warning\";\n      }\n      \n      if(warning.checked === \"unchecked-warning\") {\n        propertyDetail.aPropertyWarningsChecked = false;\n      }\n      \n      if(warning.sWarnText == undefined || warning.sWarnText == \"\") {\n        warning.sWarnText = \"No information was supplied with this warning, please proceed with caution.\";\n      }\n\n      classes = cti.fnReturnIconClass(warning.sWarnReason);\n      warning.innerClass = classes.iconClass;\n      warning.outerClass = classes.outerClass;\n      \n      index++;\n      warning.index = index;\n    }\n    \n    cti.utils.callAction('go-to-page', { \"name\": \"Warnings\" });\n  } else {\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\" : \"app_nowarnings\",\n        \"item-type\" : \"app-notification\",\n        \"style\" : \"error\",\n        \"title\" : \"No Warnings!\",\n        \"text\" : \"There are no Tenant or Property Warnings for this job.\"\n      }\n    );\n\n    if(!cti.store.jobs.selectedJob.bJobTravelStarted) {\n      cti.store.jobs.selectedJob.bJobTravelStarted = false;\n      cti.store.jobs.selectedJob.sJobTravelStartedText = \"Pending Start of Travel\";\n    }\n\n    cti.utils.callAction('go-to-page', { \"name\": \"StartTravel\" });\n  }\n}"},"_auto_id_":"1a5540f6-a655-40c2-ad46-e8c3aed9ee8f","actions":[]}],"expressions":{},"classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"b6c23901-ae18-4934-a10b-f47de2e4feb9"}]},{"start":false,"name":"TenantDetails","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"017a8fcf-7b1c-4540-90ba-e8421d1e7449","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var job = cti.store.jobs.selectedJob.aPropertyDetail;\n\nvar left = document.getElementById('left');\nvar right = document.getElementById('right');\nvar center = document.getElementById('center');\n\nvar leftText = document.getElementById('left-text');\nvar rightText = document.getElementById('right-text');\nvar centerText = document.getElementById('center-text');\n\nif(job.sHome_No == \"\" || job.sHome_No == undefined) {\n  left.classList.add('no-home');\n  leftText.classList.add('no-home');\n} else {\n  left.onclick = function() { cti.fnPhoneCall('tenanthome'); };\n}\n\nif(job.sMobile_No == \"\" || job.sMobile_No == undefined) {\n  right.classList.add('no-mobile');\n  rightText.classList.add('no-mobile');\n} else {\n  right.onclick = function() { cti.fnPhoneCall('tenantmob'); };\n}\n\nif(job.sWork_No == \"\" || job.sWork_No == undefined) {\n  center.classList.add('no-booked');\n  centerText.classList.add('no-booked');\n} else {\n  center.onclick = function() { cti.fnPhoneCall('user'); };\n}\n\ncti.utils.updatePage();"},"_auto_id_":"ece15a7a-0448-439c-b22a-242b6c2d6668"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"cd1cc12b-57e4-4913-90f0-cfa8ec77a69b","content":"<h4 class=\"title\">Tenant Details</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"903688de-5a6f-474d-bb0f-221c75ce67b5","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"TenantDetails","componentInstanceId":"c326b735-7c6d-4e7e-a871-1fa80e9c1e2d","function":"open"},"_auto_id_":"fb9b5c37-2fb2-442e-8af9-47fa8040b4d4"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"fd336526-5922-4aff-acb6-df0c549c35da","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"a8d1999d-1dde-4df7-81df-1cdd16ac661c"}]},{"name":"btnJobList","type":"button","item-type":"button","_auto_id_":"fecc3f67-530b-4c3d-a259-a9ed155e5859","content":"Job List","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnClearJobData();"},"_auto_id_":"97950a07-bdfd-4046-b57a-39a93d82ec87"}],"left-icon":"fa-list"},{"name":"btnSORCodes","type":"button","item-type":"button","_auto_id_":"db0ac7c9-08e3-406b-a1b2-a3b3d178bab1","content":"SOR Codes","theme":"default","expressions":{},"left-icon":"fa-barcode","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSORCodes","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"863faee3-b7f3-4713-87df-d4feca961da0"}]},{"name":"btnVanStockCodes","type":"button","item-type":"button","_auto_id_":"af2518aa-2faf-44fe-af3b-ba89f58373f7","content":"Van Stock Codes","theme":"default","expressions":{},"left-icon":"fa-truck","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateVanStock","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"e03ccf16-4123-4bbf-acbe-b46f3c755926"}]},{"name":"btnPO","type":"button","item-type":"button","_auto_id_":"7af2cd56-97c9-46f9-8eb2-0599003c9d78","content":"Purchase Order","theme":"default","expressions":{},"left-icon":"fa-shopping-cart","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigatePO","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"166132a8-f72a-42e4-bea2-35fff6061dd7"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"93d0b620-b2a5-49b1-bf09-ac5b86e2a428","content":"Job Map","theme":"default","expressions":{},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"d92a05c9-608b-420f-9d3a-ca52b9bd7ccf"}]},{"name":"btnJobHistory","type":"button","item-type":"button","_auto_id_":"94f2abeb-3492-4fb8-99e5-5ff4161d5acd","content":"Job History","theme":"default","expressions":{},"left-icon":"fa-history","actions":[{"event":"click","type":"call-component-function","data":{"page":"TenantDetails","componentInstanceId":"72217a43-8044-4ed8-8bdf-f171a9bf1244","function":"show"},"_auto_id_":"f4b19356-dbe7-4e6e-8aae-8dfd024d61fe"},{"event":"click","type":"call-function","data":{"name":"fnNavigateJobHistory","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"a391468f-9aae-4a7d-a931-5370d3960958"}]},{"name":"btnJobSummary","type":"button","item-type":"button","_auto_id_":"29d7479e-9bab-460b-8584-087e74a59f2b","content":"Job Summary","theme":"default","expressions":{},"left-icon":"fa-file-text","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobSummary","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"3f470fad-1fe7-499d-ba44-cf2ee6237940"}]},{"name":"btnTakePhoto","type":"button","item-type":"button","_auto_id_":"af50bb3f-a8cd-4e7f-9da0-e20766be357b","content":"Take Photo","theme":"default","left-icon":"fa-camera","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.lastTakePhotoPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { name: \"AdHocPhotos\" });"},"_auto_id_":"5b382369-ea2e-4196-97f6-3321e6722af4"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"16ade345-8ee9-4e0d-8050-77f9ff4ad805","content":"Logout","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"a3d66ae4-ec13-4802-8b8d-117b16b04209"}],"left-icon":"fa-sign-out"}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"c326b735-7c6d-4e7e-a871-1fa80e9c1e2d","attributes":{},"expressions":{}}],"_auto_id_":"49889c61-0a4c-4245-8639-e54d69be7d37","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"72217a43-8044-4ed8-8bdf-f171a9bf1244","attributes":{},"expressions":{},"actions":[]},{"name":"html_tenantdetails","type":"content","item-type":"html","_auto_id_":"339b35b3-f180-461e-9e48-779d9d6a7250","content":"<p style=\"font-weight:100;\">Tenant Name: <span style=\"font-weight:bold;\">{{'$store.jobs.selectedJob.aPropertyDetail.sTenant_Name'|store}}</span></p>\n<p style=\"font-weight:100;\">Attend On: <span style=\"font-weight:bold;\">{{'$store.jobs.selectedJob.dAttendOnDate'|store}}</span></p>\n<p style=\"font-weight:100;\">Appointment Slot: <span style=\"font-weight:bold;\">{{'$store.jobs.selectedJob.sAssignedType'|store}}</span></p>\n<hr>\n<h5 style=\"font-weight:bold;\">Address</h5>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_1'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sAddress_4'|store}}</p>\n<p>{{'$store.jobs.selectedJob.aPropertyDetail.sPostcode'|store}}</p>\n<hr>\n<div class=\"centered-max\">\n  <div class=\"tenant-contacts\">Call Telephone Number:</div>\n  <div class=\"inlineblock-default\">\n    <div id=\"left\" class=\"fa home\"></div>\n    <div id=\"right\" class=\"fa mobile\"></div>\n    <div id=\"center\" class=\"fa booked\"></div>\n  </div>\n  <div class=\"inlineblock-default\">\n    <div id=\"left-text\" class=\"home-text\">Tenant Home</div>\n    <div id=\"right-text\" class=\"mobile-text\">Tenant Mobile</div>\n    <div id=\"center-text\" class=\"booked-text\">Booked By</div>\n  </div>\n</div>","expressions":{}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"408d4b28-288e-433b-a497-fd03f3f95a29","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"4e1a0e1d-64a4-4bc0-8704-daa8468730e2","content":"Previous","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Returning to Job List...');\nwindow.accuServFunctions.fnClearJobData();"},"_auto_id_":"a93bd025-eaa2-486f-b6de-cf4717482c4c"}],"classes":"button-bar-btn"},{"name":"next_btn","type":"button","item-type":"nav-button","_auto_id_":"58448035-e724-4732-9b8a-83a4719e13d5","extends":{"type":"button","item-type":"button"},"content":"Next","actions":[{"event":"click","type":"go-to-page","data":{"name":"JobAccessDetails","isConditional":false}}],"expressions":{},"theme":"default","classes":"button-bar-btn"}],"expressions":{}}],"_auto_id_":"1ca53e86-03fd-47a8-807b-6a5725daa0f1"}]},{"start":false,"name":"JobList","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"2c978fb7-c501-43a1-bf9c-8f37ddef0838","actions":[{"event":"onloaded","type":"inline-function","data":{"sync":true,"code":"if(cti.store.variables.reSyncJobList) {\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n}"},"_auto_id_":"82f961f9-18ce-4923-82a8-1e0611be364f"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"d6ebf8f1-e766-458f-b122-13e4232c4824","content":"<h4 class=\"title\">Job List</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"d3ff9606-4f43-48ce-b6ce-273178a1132f","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"JobsList","componentInstanceId":"97135165-829c-46db-bd4a-7d7aa39f16fd","function":"open"},"_auto_id_":"1caa6383-1dd4-4445-843b-e0ac1a42cb8d"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"100017e7-751f-46d2-a91e-855bc105ba5e","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"f918021d-03e6-4fef-af0b-877c12ecca7c"}]},{"name":"btnReSyncJob","type":"button","item-type":"button","_auto_id_":"25cd2a15-3ad5-41b2-a862-e452462507cc","content":"Re-Sync Job List","theme":"default","left-icon":"fa-refresh","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('call-actionflow',{'name':'GetJobList'});"},"_auto_id_":"1ed03fff-7626-4d59-b126-1dbd302d694c"}]},{"name":"btnJobMap","type":"button","item-type":"button","_auto_id_":"bde01553-ee2b-4237-a207-1285cd0ae75a","content":"Job Map","theme":"default","expressions":{"show":"$store.jobs.jobList.length > 0"},"left-icon":"fa-map-marker","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateJobMap","params":{"lastPage":"{{$store.state.currentPage}}"}},"_auto_id_":"498fb643-ba17-48fe-af9b-babe8c0b488f"}]},{"name":"btnRequestJob","type":"button","item-type":"button","_auto_id_":"ef26127d-616b-41c4-9cbd-184b99cdb15e","content":"Request a Job","theme":"default","left-icon":"fa-send-o","actions":[{"event":"click","type":"go-to-page","data":{"name":"RequestJob","isConditional":false},"_auto_id_":"898851ec-e9a2-420a-baea-a73a8c58e854"}],"expressions":{}},{"name":"btnRaiseIncident","type":"button","item-type":"button","_auto_id_":"6d5da263-8c0f-4e62-9dd5-179ff088033f","content":"Raise an Incident","theme":"default","left-icon":"fa-warning","actions":[{"event":"click","type":"go-to-page","data":{"name":"RaiseIncident","isConditional":false},"_auto_id_":"981357cc-717b-4405-9242-ffb55bf54c52"}],"expressions":{}},{"name":"btnPauseTask","type":"button","item-type":"button","_auto_id_":"608335ac-252b-444d-82f5-4522df104393","content":"Pause Task","theme":"default","expressions":{},"left-icon":"fa-pause","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"PauseTask\" });"},"_auto_id_":"64d4ea14-9fac-4530-a511-6b9d924788d0"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"2f56f0f6-ced8-4fc9-bf82-6b42b6cf4d3f","content":"Logout","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"ec34e97c-8353-492c-bbf2-cc2758ddcc04"}],"left-icon":"fa-sign-out"}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"97135165-829c-46db-bd4a-7d7aa39f16fd","attributes":{},"actions":[],"expressions":{}}],"_auto_id_":"6843dd9b-a3e0-4ddb-852e-53290fd74611","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"noJobsDisplay","type":"content","item-type":"html","_auto_id_":"5bd37f05-21c1-41c4-bfef-d5dd833a1284","content":"<h4 class=\"centered-text\">You have 0 Jobs</h4><p class=\"centered-text\">Currently you do not have any Jobs in your Job List. Please contact your Supervisor or re-sync your list by tapping the below icon.</p>\n<div class=\"retry-job\" onclick=\"cti.utils.callAction('call-actionflow',{'name':'GetJobList'});\">\n\t<i class=\"fa fa-refresh\"></i>\n</div>","expressions":{"show":"$store.jobs.jobList.length === 0"}},{"name":"list_joblistshort","type":"content","item-type":"list","_auto_id_":"c1d84ec7-d5c8-4056-8b5d-2bff5d377102","search":"internal","classes":"","expressions":{"show":"$store.jobs.jobListShort.length > 0 && $store.variables.showFullJobs !== true"},"model":"$store.jobs.jobListShort","theme":"bootstrap","actions":[{"event":"click","type":"call-function","data":{"name":"fnSelectJob","params":{"jobid":"{{$data.$item.aAccuServJobID.iJobEventNoKey}}"}},"_auto_id_":"36326077-0c96-4a3f-8420-51a61b4835b1"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_joblistshort_html","_auto_id_":"80c96e36-abe7-45a2-922e-ec53a6951745","content":"<div class=\"joblist-container\">\n  <div class=\"joblist-column-1 joblist-status\">\n    <div class=\"joblist-slot\">{{::$data.$item.sAssignedType}}</div>\n    <div class=\"joblist-day\">{{::$data.$item.sDay}}</div>\n    <div class=\"joblist-month\">{{::$data.$item.sMonth}}</div>\n  </div>\n  <div class=\"joblist-column-2\">\n    <div class=\"joblist-contract\">{{::$data.$item.sProblemDetailDisplay}}</div>\n    <br>\n    <div class=\"joblist-priority\">{{::$data.$item.sContract}}</div>\n    <div class=\"joblist-priority\">{{::$data.$item.sPriority}}</div>\n    <div class=\"joblist-address\">{{::$data.$item.sHouseNo}} {{::$data.$item.sAddress1}}, {{::$data.$item.sPostcode}}</div>\n  </div>\n  <div class=\"joblist-column-3\"></div>\n</div>","expressions":{}}],"searchFunctionExternal":"function (searchCriteria, item) {\n  // e.g., return item.name === searchCriteria.name;\n}","searchMode":"type","searchDebounce":500,"searchWithin":"","searchFunction":"function (searchTerm, item) {\n  // e.g., return item.name === searchTerm;\n}"},{"name":"list_joblistfull","type":"content","item-type":"list","_auto_id_":"001877cc-fa6d-4989-b743-74ae8ea3a608","search":"internal","classes":"","expressions":{"show":"$store.jobs.jobList.length > 0 && $store.variables.showFullJobs === true"},"model":"$store.jobs.jobList","theme":"bootstrap","actions":[{"event":"click","type":"call-function","data":{"name":"fnSelectJob","params":{"jobid":"{{$data.$item.aAccuServJobID.iJobEventNoKey}}"}},"_auto_id_":"7fd0aef6-b305-4331-b585-091e3a82ca03"}],"dataSource":"dynamic","data":"[]","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"list_joblistfull_html","_auto_id_":"37505751-3f5d-4fa5-9518-0e8d9da40a7b","content":"<div class=\"joblist-container\">\n  <div class=\"joblist-column-1 joblist-status\">\n    <div class=\"joblist-slot\">{{::$data.$item.sAssignedType}}</div>\n    <div class=\"joblist-day\">{{::$data.$item.sDay}}</div>\n    <div class=\"joblist-month\">{{::$data.$item.sMonth}}</div>\n  </div>\n  <div class=\"joblist-column-2\">\n    <div class=\"joblist-contract\">{{::$data.$item.sProblemDetailDisplay}}</div>\n    <br>\n    <div class=\"joblist-priority\">{{::$data.$item.sContract}}</div>\n    <div class=\"joblist-priority\">{{::$data.$item.sPriority}}</div>\n    <div class=\"joblist-address\">{{::$data.$item.sHouseNo}} {{::$data.$item.sAddress1}}, {{::$data.$item.sPostcode}}</div>\n  </div>\n  <div class=\"joblist-column-3\"></div>\n</div>","expressions":{}}],"searchFunctionExternal":"function (searchCriteria, item) {\n  // e.g., return item.name === searchCriteria.name;\n}","searchMode":"type","searchDebounce":500,"searchWithin":"","searchFunction":"function (searchTerm, item) {\n  // e.g., return item.name === searchTerm;\n}"},{"name":"btnShowMore","type":"button","item-type":"button","_auto_id_":"b70deed7-4311-48dc-b924-43783bfa546c","content":"Show More Jobs","theme":"default","expressions":{"show":"$store.variables.showFullJobs === false && $store.jobs.jobList.length >0"},"right-icon":"fa-plus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullJobs = true;\ncti.utils.updatePage();"},"_auto_id_":"ac9507cf-f680-42b1-9f9d-b30bda509fe1"}],"classes":"showlist-btn"},{"name":"btnShowLess","type":"button","item-type":"button","_auto_id_":"2fa0780a-c060-4b53-b2c6-dcb1d3bdd007","content":"Show Less Jobs","theme":"default","expressions":{"show":"$store.variables.showFullJobs === true && $store.jobs.jobList.length >0"},"right-icon":"fa-minus","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.variables.showFullJobs = false;\ncti.utils.updatePage();"},"_auto_id_":"33634ae5-accd-4f75-8e92-1e640adf41ba"}],"classes":"showlist-btn"},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"94b2f6ce-3f94-471a-a455-c4c284eef5a1","attributes":{},"expressions":{},"actions":[]}],"_auto_id_":"1f45f944-290f-4928-89ac-bc4c19827289"}]},{"start":false,"name":"VehicleChecksPhotos","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"67f3218f-8c82-43ca-bf6e-d35a52c340bd","content":"<h4 class=\"title\">Vehicle Checks - Photos</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"1f75cc11-956e-4ecf-bf53-66c4e31e3ad1","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecks","componentInstanceId":"9020e1be-ca24-49d9-9dbe-a9e05d31db7d","function":"open"},"_auto_id_":"75c80208-0df3-4ac4-9bd5-c202c413362b"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"b96ad323-6455-419e-a5d9-9a60d2290034","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"499547e5-c549-47a9-852a-8409a23079c1"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"8e511b70-7359-480c-a477-8e9136b299cb","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"457850bc-d4c5-4cd8-85b0-979c39db89db"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"9020e1be-ca24-49d9-9dbe-a9e05d31db7d","attributes":{},"expressions":{}}],"_auto_id_":"4d4c8a26-6a23-4a45-b073-6fcc489afffd","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"8a9ec025-6b4c-4ab7-a7a4-ea563ecc8da5","attributes":{},"expressions":{}},{"name":"html_vehiclecheckheader","type":"content","item-type":"html","_auto_id_":"3491e1b6-ef8a-4fb2-821e-88877ea8ab87","content":"<h4>Vehicle Check Photos</h4>\n<p>If you wish to take any photos to accompany the Vehicle Check, please do so here. You can take a maximum of 10 photos.</p>\n<hr>\n<div class=\"take-photo-div\" onclick=\"cti.fnLoadCamera('VehicleChecksPhotos','dba898e6-7afb-427a-884f-8e170d7507a3')\";>\n\t<i class=\"fa take-photo-fa\"></i>\n</div>","expressions":{}},{"name":"takePhoto_btn","type":"button","item-type":"button","_auto_id_":"5c047dcf-9758-46b5-a938-b4799583260e","content":"Take Photo","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecksPhotos","componentInstanceId":"dba898e6-7afb-427a-884f-8e170d7507a3","function":"takePhoto"},"_auto_id_":"07558071-6a73-40be-95be-3a0abe6e15dd"}],"classes":"takephoto-btn"},{"name":"VehicleCheckPhotoManager","type":"component","item-type":"web-component","content":[],"componentId":"98807067-3c95-452a-9d3d-74d7a04fa651","_auto_id_":"dba898e6-7afb-427a-884f-8e170d7507a3","attributes":{"captureCategory":"Vehicle Check","displayCategory":"Vehicle Check","maxPhotos":10},"expressions":{},"actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"d1c3de06-907b-4448-a4b6-34c539c6fb6b","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"ed3871ed-740f-463f-99ac-da698ca2309c","content":"Previous","theme":"default","expressions":{},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Return back to Vehicle Check Page */\ncti.utils.callAction('go-to-page', { name: \"VehicleChecks\" });"},"_auto_id_":"53ad046c-2e4b-46ca-8f7c-3a758cf7d030","actions":[]}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"1e26720b-4198-4d96-982c-d60b726f2812","content":"Complete","theme":"default","expressions":{"disabled":"$form.invalid || $store.pages.VehicleChecksPhotos.oilCheckOk == \"0\" || $store.pages.VehicleChecksPhotos.waterCheckOk == \"0\" || $store.pages.VehicleChecksPhotos.tyresCheckOk == \"0\" || $store.pages.VehicleChecksPhotos.lightsCheckOk == \"0\""},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Process StartOfDay and fetch StaticData and Jobs */\ncti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"StartOfDay\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });"},"_auto_id_":"70786888-ec86-4767-a6b3-e81176596be2","actions":[]}]}],"expressions":{}}],"_auto_id_":"d016dab4-11f9-471a-a088-f34ed6f63409","expressions":{}}]},{"start":false,"name":"VehicleChecks","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"47350d02-ef8f-4bec-9a16-1b0006d667cc","content":"<h4 class=\"title\">Vehicle Checks</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"6758d57d-bd11-416d-bbac-7cafbebe90bb","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"VehicleChecks","componentInstanceId":"e9b1cd15-da4e-4794-988b-f49da40c9f41","function":"open"},"_auto_id_":"075452e9-b3d6-46b0-878d-1a819ea8cc9c"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"9158f33e-c7cf-495c-8277-ce4dd0cc2784","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"07ff5fab-69ca-468b-a226-623782060f14"}]},{"name":"btnLogout","type":"button","item-type":"button","_auto_id_":"897b3fe3-4a2c-4a9c-a324-d4e93e79dbd5","content":"Logout","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.accuServFunctions.fnLogout();"},"_auto_id_":"5fc9d7a4-a395-4d2a-ad79-7ff10df68f0c"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"e9b1cd15-da4e-4794-988b-f49da40c9f41","attributes":{},"expressions":{}}],"_auto_id_":"76a446d2-9bf5-406d-b0e8-d0a51dfe0f89","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"2f080d69-ca58-4721-9a16-b85effe39adc","attributes":{},"expressions":{}},{"name":"rdoDrivingCheck","type":"choice","item-type":"radio","_auto_id_":"f0d1e4ae-d9b1-4572-b6f2-9a2ad3b79dd1","label":"Are you driving today?","required":false,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{},"classes":"cb-bias-last","actions":[]},{"name":"html_vehiclecheck","type":"content","item-type":"html","_auto_id_":"879773fb-fb39-48b5-999e-ad47aa75281e","content":"<h4>Please complete a Vehicle Check</h4><p>Fill out the vehicle check questions below and confirm the latest odometer reading before continuing.</p>","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""}},{"name":"vehicleRegistration","type":"user-input","item-type":"text","_auto_id_":"b5552f82-27d5-43c9-9288-c95aa91a7c3d","label":"Vehicle Registration Number","required":false,"multiline":false,"debounce":250,"message":"Please enter a Vehicle Registration Number","expressions":{"show":"false"},"validators":[],"actions":[],"placeholder":"E.g. TE66 EST","classes":"vehiclecheck-reg","default":""},{"name":"oilCheckOk","type":"choice","item-type":"radio","_auto_id_":"516ef751-94b2-4b2b-bbb9-7e5659949091","label":"Oil checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"waterCheckOk","type":"choice","item-type":"radio","_auto_id_":"7d571dc4-060c-4143-b8e4-0e5313e83101","label":"Water checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"tyresCheckOk","type":"choice","item-type":"radio","_auto_id_":"ed023ee2-b96e-41fe-8f66-d3295958ab19","label":"Tyres checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"lightsCheckOk","type":"choice","item-type":"radio","_auto_id_":"c7678af8-dcf1-46f4-ac3a-cc074f8915c0","label":"Lights checked and OK?","required":true,"options":[{"label":"Yes","value":"1"},{"label":"No","value":"0"}],"icon-selected":"fa-dot-circle-o","icon-unselected":"fa-circle-o","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"actions":[],"validators":[],"message":"This is a required field","classes":"cb-bias-last"},{"name":"html_vehiclecheckfailed","type":"content","item-type":"html","_auto_id_":"128cc254-1f2c-4261-9f04-61e61a3e98aa","content":"<div onclick=cti.fnPhoneCall('manager') class=\"centered-text\"><p class=\"fa supervisor\"></p></div>\n<h4 class=\"check-fail-header\">One or more of the above checks has failed. Please call your Supervisor by tapping on the icon above before continuing...</h4>","expressions":{"show":"($store.pages.VehicleChecks.oilCheckOk == \"0\" || $store.pages.VehicleChecks.waterCheckOk == \"0\" || $store.pages.VehicleChecks.tyresCheckOk == \"0\" || $store.pages.VehicleChecks.lightsCheckOk == \"0\") && $store.pages.VehicleChecks.rdoDrivingCheck == \"1\""}},{"name":"vehicleOdometer","type":"user-input","item-type":"number","_auto_id_":"02d9233b-bb4d-467b-854a-b7733c5d5688","label":"Vehicle Mileage","required":true,"decimals":2,"expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\""},"message":"Please enter the vehicle's mileage","actions":[],"placeholder":"E.g. 10000","classes":"vehiclecheck-reg","validators":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"b52f003b-e635-4422-963a-b8286c8fa87c","extends":{"type":"area","item-type":"row"},"content":[{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"7e354b61-764f-4bfb-9fd7-d4f0b70a5ef0","content":"Next","theme":"default","expressions":{"disabled":"$form.invalid || $store.pages.VehicleChecks.oilCheckOk == \"0\" || $store.pages.VehicleChecks.waterCheckOk == \"0\" || $store.pages.VehicleChecks.tyresCheckOk == \"0\" || $store.pages.VehicleChecks.lightsCheckOk == \"0\"","show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"1\" || $store.pages.VehicleChecks.rdoDrivingCheck == undefined"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Process Vehicle Check Function */\nvar enteredOdo = cti.store.pages.VehicleChecks.vehicleOdometer;\nvar lastOdo = cti.store.api.AccuServ.initialise.nlastRecordedMileage || 0;\nvar enteredDifference = enteredOdo - lastOdo;\n\nif(enteredOdo < lastOdo) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning!\",\n      \"text\": \"Input mileage can not be less than the last recorded reading.\"\n    }\n  );\n} else if(enteredOdo === 0) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning!\",\n      \"text\": \"Please ensure you enter your vehicle mileage. It must be more than 0.\"\n    }\n  );\n} else if(cti.store.staticData.vehicleMileageMaxEntry < enteredDifference) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"app_odometer\",\n      \"item-type\": \"app-notification\",\n      \"style\": \"Warning\",\n      \"title\": \"Warning!\",\n      \"text\": \"Please make sure the difference between the current entry and last entry is less than \" + cti.store.staticData.vehicleMileageMaxEntry + \" miles.\"\n    }\n  );\n} else {\n  delete cti.store.saveActionPayload;\n\n  cti.utils.callAction('go-to-page', { name: \"VehicleChecksPhotos\" });\n}"},"_auto_id_":"4c10a96a-6620-4131-bcb0-5ed85d9f5aff","actions":[]}]},{"name":"complete_btn","type":"button","item-type":"button","_auto_id_":"26025447-2849-443a-9158-03b690af65df","content":"Complete","theme":"default","expressions":{"show":"$store.pages.VehicleChecks.rdoDrivingCheck == \"0\""},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Skip Vehicle Check Function */\ncti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"StartOfDay\" });\ncti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });"},"_auto_id_":"9535294b-0a2b-469a-8bef-45f5f3c42523"}],"classes":"confirm-bar-btn"}],"expressions":{}}],"_auto_id_":"54285d21-7182-4fb1-abe2-741c54093052","expressions":{}}]},{"start":true,"name":"Login","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"a828a77e-84c3-4ac4-8a38-bd3bc2ee0ff0","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"if(window) {\n  if(!window.appManager) {\n    window.appManager = new AppManager();\n    setTimeout(window.appManager.pollingMonitor, 100);\n  }\n  if(!window.accuServFunctions) {\n    window.accuServFunctions = new AccuServFunctions();\n  }\n}\n\nif(cti.store.pages.AppSettings === undefined) {\n  cti.store.pages.AppSettings = {};\n}\n\nif(cti.store.webService === undefined) {  \n  cti.store.webService = {};\n  cti.store.webService.apiUrls = [];\n  \n  cti.store.webService.apiUrls.push({\"value\": cti.store.schema.metadata.accuservurl});\n}"},"_auto_id_":"d820a1e8-5f41-45f0-b295-c4ac343af5a2"}]}],"content":[{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"imgLogo","type":"media","item-type":"image-viewer","_auto_id_":"a05e6594-182b-46ca-9168-6cdd46b73703","scaleImage":false,"maxWidth":200,"maxHeight":200,"expressions":{},"fileName":"accuserv-logo.png","classes":"header-image","actions":[]},{"name":"htmlLoginPrompt","type":"content","item-type":"html","_auto_id_":"a661fd56-3ef2-42a9-84d9-73831eec6e51","content":"<p class=\"p-text\">Please enter your Username and Password and tap Login to proceed.</p>","expressions":{}},{"name":"Username","type":"user-input","item-type":"text","_auto_id_":"a0cd3700-8e4a-4a2b-8fe3-c6ba1c37567a","label":"","required":true,"multiline":false,"debounce":250,"expressions":{},"description":"","placeholder":"Username","validators":[],"actions":[],"classes":"credentials-input","message":"Please enter your Username"},{"name":"Password","type":"user-input","item-type":"password","_auto_id_":"8e830966-5454-432e-8750-ba4c66dc4e25","label":"","required":true,"message":"Please enter your Password","expressions":{},"placeholder":"Password","classes":"credentials-input","actions":[]},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"739e25ce-abfa-47d4-9653-5889d0e43101","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnLogin","type":"button","item-type":"button","_auto_id_":"68464c45-5713-4c9f-a905-135d3aba68f4","content":"Login","theme":"default","expressions":{"disabled":"$form.invalid"},"classes":"login-button","actions":[{"event":"click","type":"call-actionflow","data":{"name":"Login"},"_auto_id_":"1fb22064-40a4-460a-afcf-d458a66aa962"}]}],"expressions":{}},{"name":"htmlApplicationDetails","type":"content","item-type":"html","_auto_id_":"f90969fb-2934-4a34-9489-cf805fe4259a","content":"<div class=\"app-title\">AccuMobile<span class=\"version\">Version: {{'$store.schema.version' | store}}</span></div>","expressions":{}},{"name":"btnSettings","type":"button","item-type":"button","_auto_id_":"1bf3d2db-3ad6-44b3-864b-5e7c03d6abce","content":"","theme":"default","left-icon":"fa-gear","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":{"name":"AppSettings","isConditional":false},"_auto_id_":"d6c397ba-6f80-4269-9f65-74a82d08a69c"}]},{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"cf76a6af-5a1e-4b46-8c07-2afbd2c50003","attributes":{"message":"Attempting to log you in..."},"expressions":{},"actions":[]}],"_auto_id_":"8fb306b4-c75c-4242-a5bf-b67a3ecd97ec","expressions":{}}],"settings":{"auth":false}},{"start":false,"name":"CP12","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"html_header","type":"content","item-type":"html","_auto_id_":"d9c6328a-7a5d-4222-bc27-8b5c9b326a45","content":"<h4 class=\"title\">Gas Inspection</h4>","expressions":{}},{"name":"menu_btn","type":"button","item-type":"button","_auto_id_":"4251f8f8-721e-49f1-bcd1-d997711baafb","content":"","theme":"default","expressions":{},"classes":"header-button","right-icon":"fa-bars","actions":[{"event":"click","type":"call-component-function","data":{"page":"CP12","componentInstanceId":"a024fbb1-081f-49a8-8f53-11d813fb0fe6","function":"open"},"_auto_id_":"0a09acd9-82e0-4709-ba2a-d9753eee42a3"}]},{"name":"ContextMenu","type":"component","item-type":"web-component","content":[{"name":"btnVersion","type":"button","item-type":"button","_auto_id_":"36538831-b980-40a2-ae6d-e7a7cbad460a","content":"Version {{'$store.schema.version' | store}}","theme":"default","expressions":{},"left-icon":"fa-info-circle","actions":[{"event":"click","type":"call-function","data":{"name":"fnNavigateSupportInfo"},"_auto_id_":"c448d75d-1c5e-489b-865e-933345b11aa2"}]}],"componentId":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","_auto_id_":"a024fbb1-081f-49a8-8f53-11d813fb0fe6","attributes":{},"expressions":{}}],"_auto_id_":"6cf78046-5788-4ab5-896a-c70fc29a589c","expressions":{},"classes":""},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"ActivitySpinner","type":"component","item-type":"web-component","content":[],"componentId":"649dedf7-f246-460b-841c-df3adbdf6522","_auto_id_":"b9ef3f9a-8310-49f7-abfe-9e934ae93af4","attributes":{},"expressions":{}},{"name":"html_start","type":"content","item-type":"html","_auto_id_":"ee281bb7-3982-44d0-8b05-19846d2da966","content":"<div class=\"disclaimer-container-start\">\n  <h4>Warning: Gas Inspection Required</h4>\n  <p>You are required to complete a Gas Inspection for this job.</p>\n  <p style=\"color:red;font-weight:700\">Once you begin the Gas Inspection, all relevent information and each question must be completed/answered before you proceed with the rest \t\tof the job.</p>\n  <p>Are you sure you want to proceed?</p>\n</div>","expressions":{"show":"$store.jobs.selectedJob.cp12Enabled == 'pending'"}},{"name":"html_finish","type":"content","item-type":"html","_auto_id_":"e7268bc3-25b0-4af1-bade-31863ac1d5bf","content":"<div class=\"disclaimer-container\">\n  <div class=\"starting\">\n\t<i id=\"starting-spinner\" class=\"fa started-ticked\"></i>\n  </div>\n  <h4 class=\"completeheader\">Gas Inspection Completed</h4>\n</div>","expressions":{"show":"$store.jobs.selectedJob.cp12Enabled == 'completed'"}},{"name":"html_cp12","type":"content","item-type":"html","_auto_id_":"745727ca-a3a0-4023-83d6-7d0897308710","content":"<div id=\"cp12\"></div>","expressions":{"show":"$store.jobs.selectedJob.cp12Enabled == 'inprogress'"}},{"name":"button_bar","type":"area","item-type":"button-bar","_auto_id_":"f270e4f7-aef8-4191-83a8-a95f1182f2e5","extends":{"type":"area","item-type":"row"},"content":[{"name":"previous_btn","type":"button","item-type":"button","_auto_id_":"9128deef-ad48-4e3c-af61-67cd2d6748ec","content":"Previous","theme":"default","expressions":{"show":"$store.jobs.selectedJob.cp12Enabled != 'inprogress'"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"PreWorkPhotos\" });"},"_auto_id_":"e06959a2-6793-46c4-aec4-181fabb80b93"}]},{"name":"next_btn","type":"button","item-type":"button","_auto_id_":"f3d8c55a-10ce-4ee2-a1b6-8bfd811309ae","content":"Next","theme":"default","expressions":{"show":"$store.jobs.selectedJob.cp12Enabled == 'completed'"},"classes":"button-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.utils.callAction('go-to-page', { \"name\": \"JobInformation\" });"},"_auto_id_":"31ac40d1-e8cb-4842-b032-9b702da42f7f"}]},{"name":"start_btn","type":"button","item-type":"button","_auto_id_":"bd3ff497-ae78-4440-ab22-e49a289de704","content":"Proceed","theme":"default","expressions":{"show":"$store.jobs.selectedJob.cp12Enabled == 'pending'"},"classes":"confirm-bar-btn","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.AccuServManager.triggerBootstrap();  \ncti.store.jobs.selectedJob.cp12Enabled = 'inprogress';\n\n$success();"},"_auto_id_":"277c671a-35c0-4292-9466-f5e17844120a"}]}],"expressions":{"show":"$store.variables.cp12Enabled != 'inprogress'"}}],"_auto_id_":"62a02764-9f0d-4618-b6f6-945600f50aec","expressions":{}}]}],"actionflows":[{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var code = cti.store.payloads.eventStatusPayload.sStatus;\n\nif(code != \"70\" && code != \"71\" && code != \"72\" && code != \"74\") {\n\tcti.store.jobs.selectedJob.aInJobEventStatus.push(cti.store.payloads.eventStatusPayload);\n}\n\nif(cti.store.jobs.eventStatusLimit > 0) {\n  // Fetch the sendEventStatusHeaders to supply to the joblist request\n  cti.store.variables.sendEventStatusHeaders = window.appManager.newHeaderData();\n  $success();\n} else {\n  cti.fnCloseSpinner();\n}"},"_auto_id_":"ab9b2588-9589-41bf-b2f1-6242bb673334","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"jobstatus","params":{"applicationkey":"{{$store.variables.sendEventStatusHeaders.applicationkey}}","authtoken":"{{$store.variables.sendEventStatusHeaders.authtoken}}","messageid":"{{$store.variables.sendEventStatusHeaders.messageid}}","messagedate":"{{$store.variables.sendEventStatusHeaders.messagedate}}","data":"{{$store.payloads.eventStatusPayload}}"}},"_auto_id_":"4b012f0e-f120-4c80-917d-0665c946a8e8","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobstatus endpoint success callback */\n\nvar resp = cti.store.offlineApi.AccuServOffline.jobstatus;\nvar responseJob = 0;\nvar code;\n\nif(resp) {\n  if(resp.jobID !== undefined) {\n    responseJob = resp.jobID.iJobEventNoKey\n  }\n\n  if(cti.store.payloads.eventStatusPayload != undefined) {\n    code = cti.store.payloads.eventStatusPayload.sStatus;\n  } else {\n    code = \"Returned out of scope.\";\n  }\n\n  var job = cti.store.jobs.selectedJob;\n\n  if(job != undefined) {\n    if(responseJob === job.aAccuServJobID.iJobEventNoKey) {\n      cti.store.jobs.eventStatus = {\n          sStatus: resp.sStatus,\n          sCode: code\n      };\n\n      if(resp.bSuccess) {\n        cti.store.jobs.selectedJob.sStatus = resp.sStatus;\n\n        if(code == \"70\" || code == \"71\" || code == \"72\" || code == \"74\") {\n          cti.store.variables.reSyncJobList = true;\n          cti.store.jobs.lastJobEvent.aEventStatus = cti.store.jobs.eventStatus;\n        }\n      }\n    } else {\n      window.appManager.logEvent('Job Status Response returned outside scope of current job.' , 'info');\n    }\n  } else {\n    window.appManager.logEvent('Job Status Response returned outside scope of any job.' , 'info');\n  }\n} else {\n  window.appManager.logEvent('Job Status Response returned no response.' , 'error');\n}\n\ndelete cti.store.variables.sendEventStatusHeaders;\ndelete cti.store.payloads.eventStatusPayload;\ndelete cti.store.offlineApi.AccuServOffline.jobstatus;\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"6dac81a8-48b8-4c4f-977b-a4d4bff4b512"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"cti.store.jobs.eventStatusLimit = cti.store.jobs.eventStatusLimit - 1;\ncti.utils.callAction('call-actionflow', { \"name\": \"SendJobStatus\" });"},"_auto_id_":"e74c154b-ee0a-47f7-95e1-160bcc626d1b"}]}]}],"name":"SendEventStatus"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Validating Job...');\n\n// Set validation retry counter\nif(cti.store.variables.validateRetryCount === undefined) cti.store.variables.validateRetryCount = 3;\n\n// Fetch the validateJobHeaders to supply to the requestJob request\ncti.store.variables.validateJobHeaders = window.appManager.newHeaderData();\n\ncti.store.payloads.validateJobPayload = {\n  \"job\": cti.store.jobs.selectedJob.aAccuServJobID,\n  \"operative\": cti.store.jobs.selectedJob.aOperativeDetail.sOperativeID\n}\n\n// If retry counter is 0 then start job anyway\nif(cti.store.variables.validateRetryCount === 0) {\n  delete cti.store.variables.validateRetryCount;\n  \n  cti.fnCloseSpinner();\n  cti.fnStartTravel();\n} else {\n  $success();\n}"},"_auto_id_":"8ce6e028-4518-4ca4-9c77-24721a062adf","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"validatejobstatus","params":{"applicationkey":"{{$store.variables.validateJobHeaders.applicationkey}}","authtoken":"{{$store.variables.validateJobHeaders.authtoken}}","messagedate":"{{$store.variables.validateJobHeaders.messagedate}}","messageid":"{{$store.variables.validateJobHeaders.messageid}}","data":"{{$store.payloads.validateJobPayload}}"}},"_auto_id_":"22e1188c-45e8-45d1-9e77-bc7c0ab2cf2a","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.validatejobstatus;\n\nif(resp.bSuccess) {\n  cti.fnStartTravel();\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Invalid Job: \" + resp.sStatus,\n      \"text\" : \"This job is no longer validated against your operative ID. Please return to the job list screen and re-sync your job list.\"\n    }\n  );\n}\n\ndelete cti.store.variables.validateJobHeaders;\ndelete cti.store.payloads.validateJobPayload;\ndelete cti.store.api.AccuServ.validatejobstatus;\ndelete cti.store.variables.validateRetryCount;\n\ncti.fnCloseSpinner();"},"_auto_id_":"cae4cb70-8c79-4f91-8d57-bfede41f8f99"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Validating Job Failed\",\n    \"text\": \"The request to Validate this Job failed to reach the server. Please check that you have internet connectivity or contact the AccuServ support. You have \" + cti.store.variables.validateRetryCount + \" retry attempts remaining.\"\n  }\n);\n\n// Delete purchaseOrderHeaders payload object\ndelete cti.store.variables.validateJobHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();\n\n// Take off a retry attempt\ncti.store.variables.validateRetryCount--;"},"_auto_id_":"0def9d1c-b935-4632-94fb-54e8c8092ce1"}]}]}],"name":"ValidateJob"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Do some init stuff\ncti.store.currentProfile.refreshingToken  = true;\nwindow.appManager.logEvent('Refreshing auth token', 'debug');\n\ncti.store.variables.apiHeaders.refreshtoken = window.appManager.newHeaderData();\n\n$success();\n"},"_auto_id_":"ff52825e-f9fd-4a00-b7e0-51fd2d0c7f23","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"refreshtoken","params":{"messageid":"{{$store.variables.apiHeaders.refreshtoken.messageid}}","messagedate":"{{$store.variables.apiHeaders.refreshtoken.messagedate}}","applicationkey":"{{$store.variables.apiHeaders.refreshtoken.applicationkey}}","authtoken":"{{$store.variables.apiHeaders.refreshtoken.authtoken}}"}},"_auto_id_":"144879f8-c13a-4bb4-a969-4d58286c2897","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/*\n\tExample legit response:\n    {\n      \"errorCode\": 0,\n      \"errorDesc\": \"\",\n      \"token\": \"A6BE4685-BAD2-4E80-BBB8-5AB37FF459C3\",\n      \"expiresIn\": 3600,\n      \"messageid\": \"34\"\n    }\n\n*/\nvar response = cti.store.offlineApi.AccuServOffline.refreshtoken;\nif (response.errorCode == 0) {\n  // Update the token - the function will take care of everything\n  window.accuServFunctions.fnUpdateAuthToken(response.token, response.expiresIn);\n}\nelse {\n  window.appManager.logEvent('Failure to refresh auth token: ' + response.errorDesc, 'warning');\n\tcti.store.currentProfile.refreshingToken  = false;\n}"},"_auto_id_":"9b60b432-8925-4705-8843-8481bfe73047","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Typically a transport level failure or timeout\nwindow.appManager.logEvent('Failure to refresh auth token (API call failed)', 'warning');\ncti.store.currentProfile.refreshingToken  = false;\n"},"_auto_id_":"506bad22-ca4e-4c99-8aab-66d25450fed5"}]}]}],"name":"RefreshToken"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Raising Job Incident...');\n\n// Fetch the raiseIncidentHeaders to supply to the requestJob request\ncti.store.variables.raiseIncidentHeaders = window.appManager.newHeaderData();\n$success();"},"_auto_id_":"2da27f3d-5e72-4d90-9ed1-7ecaa76d9df3","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"raiseincident","params":{"applicationkey":"{{$store.variables.raiseIncidentHeaders.applicationkey}}","authtoken":"{{$store.variables.raiseIncidentHeaders.authtoken}}","messageid":"{{$store.variables.raiseIncidentHeaders.messageid}}","messagedate":"{{$store.variables.raiseIncidentHeaders.messagedate}}","data":"{{$store.payloads.raiseIncidentPayload}}"}},"_auto_id_":"75e70f97-17d8-4fef-b272-9c5ca2989d9f","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.raiseincident;\n\nif(resp.bSuccess) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_specialordersent\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : \"Incident Raised!\",\n      \"text\" : resp.sStatus + resp.sAccuServReference\n    }\n  );\n}\n\ndelete cti.store.payloads.raiseIncidentPayload;\ndelete cti.store.variables.raiseIncidentHeaders;\n\ncti.utils.destroyPageData('RaiseIncident');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n\ncti.fnCloseSpinner(1500);"},"_auto_id_":"2b999026-af39-46be-9720-518b9dcd9f9c"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Requesting OOH Job Failed\",\n    \"text\": \"The request to send this OOH Job failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete oohHeaders payload object\ndelete cti.store.variables.oohHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"6c75efc7-55ea-4144-9ded-2134eece0bba","actions":[]}]}]}],"name":"RaiseIncident"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Requesting OOH Job...');\n\n// Fetch the oohHeaders to supply to the requestJob request\ncti.store.variables.oohHeaders = window.appManager.newHeaderData();\n$success();"},"_auto_id_":"dec8c44f-7439-4377-9f1e-82c3be54ae67","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"requestoutofhoursjob","params":{"applicationkey":"{{$store.variables.oohHeaders.applicationkey}}","authtoken":"{{$store.variables.oohHeaders.authtoken}}","messageid":"{{$store.variables.oohHeaders.messageid}}","messagedate":"{{$store.variables.oohHeaders.messagedate}}","data":"{{$store.payloads.requestJobPayload}}"}},"_auto_id_":"67361f16-1865-4ae0-8aad-eb6f35a96c15","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.requestoutofhoursjob;\n\nif(resp.bSuccess) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_specialordersent\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : \"Out of Hours Job Raised!\",\n      \"text\" : resp.sStatus + resp.sAccuServReference\n    }\n  );\n}\n\ndelete cti.store.payloads.requestJobPayload;\ndelete cti.store.variables.oohHeaders;\n\ncti.utils.destroyPageData('RequestJob');\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n\ncti.fnCloseSpinner(1500);"},"_auto_id_":"046b50b1-3091-42f3-9020-f08c54b15b3c"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Requesting OOH Job Failed\",\n    \"text\": \"The request to send this OOH Job failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete oohHeaders payload object\ndelete cti.store.variables.oohHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"c449ea14-051e-432c-af70-2edb595e9343","actions":[]}]}]}],"name":"RequestJob"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Encode any jpegs to base64\nfunction toDataURL(thisPhoto, callback) {\n  var xhr = new XMLHttpRequest();\n  xhr.onload = function() {\n    var reader = new FileReader();\n    reader.onloadend = function() {\n      callback(reader.result, thisPhoto);\n    };\n    reader.readAsDataURL(xhr.response);\n  };\n  xhr.open(\"GET\", thisPhoto.src);\n  xhr.responseType = \"blob\";\n  xhr.send();\n}\n\n// Check that the photos element is undefined and define if needed\nif (cti.store.jobs.failedPhotosToSend.photos === undefined) {\n  cti.store.jobs.failedPhotosToSend.photos = [];\n}\n\n// Check that the signatures element is undefined and define if needed\nif (cti.store.jobs.failedPhotosToSend.signatures === undefined) {\n  cti.store.jobs.failedPhotosToSend.signatures = [];\n}\n\n// Check that we have any photos or signatures\nif (\n  cti.store.jobs.failedPhotosToSend.photos.length > 0 ||\n  cti.store.jobs.failedPhotosToSend.signatures.length > 0\n) {\n  var photoLength = cti.store.jobs.failedPhotosToSend.photos.length;\n\n  // If we have any photos then kick off the endcoding proccess ...\n  if (photoLength > 0) {\n    for (var i in cti.store.jobs.failedPhotosToSend.photos) {\n      var thisPhoto = cti.store.jobs.failedPhotosToSend.photos[i];\n\n      toDataURL(thisPhoto, function(dataUrl, thisPhoto) {\n        thisPhoto.content = dataUrl;\n        photoLength--;\n\n        if (photoLength === 0) {\n          $success();\n        }\n      });\n    }\n  } else {\n    // ... otherwise bypass this and submit the signautres only\n    $success();\n  }\n} else {\n  // No photos or signatures so just process the jobcomplete event\n  cti.fnClearPhotos(cti.store.jobs.failedPhotosToSend.photos, true);\n  cti.utils.callAction(\"call-actionflow\", { name: \"JobComplete\" });\n}"},"_auto_id_":"c8ee1e6d-6c54-4b7a-8439-6e03881fe06c","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"// fnUploadPhotos function callback to handle the response of the image/signature upload\nfunction uploadedCallbackEvent(ok) {\n  if (ok) {\n    for (var i in cti.store.jobs.failedPhotos) {\n      var thisPhoto = cti.store.jobs.failedPhotos[i];\n      if (\n        cti.store.jobs.failedPhotosToSend.job.aAccuServJobID.iJobEventNoKey ===\n        thisPhoto.job.aAccuServJobID.iJobEventNoKey\n      ) {\n        cti.store.jobs.failedPhotos.splice(i, 1);\n      }\n    }\n\n    cti.fnClearPhotos(cti.store.jobs.failedPhotosToSend.photos, false);\n    window.appManager.logEvent(\n      \"Photo/Signature re-submitted successfully from Job ID: \" +\n        cti.store.jobs.failedPhotosToSend.job.aAccuServJobID.sJobNo,\n      \"info\"\n    );\n\n    delete cti.store.jobs.failedPhotosToSend;\n    delete cti.store.variables.signatures;\n    delete cti.store.jobs.signaturesAssociatedJob;\n  } else {\n    for (var i in cti.store.jobs.failedPhotosToSend.photos) {\n      delete cti.store.jobs.failedPhotosToSend.photos[i].content;\n    }\n\n    window.appManager.logEvent(\n      \"Photo/Signature failed to send for Job ID: \" +\n        cti.store.jobs.failedPhotosToSend.job.aAccuServJobID.sJobNo +\n        \". Re-submitting...\",\n      \"error\"\n    );\n  }\n}\n\ncti.fnUploadPhotos(\n  cti.store.jobs.failedPhotosToSend,\n  cti.store.pages.AppSettings.accuservAPIAddress,\n  uploadedCallbackEvent,\n  false\n);"},"_auto_id_":"911d2d3e-dabd-4202-a60c-dd3c67b7ced1"}]}],"name":"SubmitPhotosOffline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Get jobEventStatus\nvar jobEventStatus = cti.store.variables.jobEventStatus;\ndebugger;\nif (jobEventStatus === \"jobcomplete\") {\n  cti.fnOpenSpinner(\"Preparing Job Complete to send to AccuServ...\");\n} else if (jobEventStatus === \"abandonjob\") {\n  cti.fnOpenSpinner(\"Preparing to Abandon Job to send to AccuServ...\");\n} else if (jobEventStatus === \"noaccess\") {\n  cti.fnOpenSpinner(\"Preparing to send No Access for Job to AccuServ...\");\n}\n\n// Encode any jpegs to base64\nfunction toDataURL(thisPhoto, callback) {\n  var xhr = new XMLHttpRequest();\n  xhr.onload = function() {\n    var reader = new FileReader();\n    reader.onloadend = function() {\n      callback(reader.result, thisPhoto);\n    };\n    reader.readAsDataURL(xhr.response);\n  };\n  xhr.open(\"GET\", thisPhoto.src);\n  xhr.responseType = \"blob\";\n  xhr.send();\n}\n\nvar opSig = false;\nvar riskSig = false;\nvar cusSig = false;\n\n// Set booleans to indicate any signatures present\nif (\n  cti.store.pages.Completion !== undefined &&\n  cti.store.pages.Completion.operativeSignature !== undefined\n) {\n  opSig = true;\n}\nif (\n  cti.store.pages.RiskAssessment !== undefined &&\n  cti.store.pages.RiskAssessment.confirmRASignature !== undefined\n) {\n  riskSig = true;\n}\nif (\n  cti.store.pages.CustomerSignature !== undefined &&\n  cti.store.pages.CustomerSignature.customerSignature !== undefined\n) {\n  cusSig = true;\n}\n\nif (cti.store.jobs.selectedJob.photos === undefined) {\n  cti.store.jobs.selectedJob.photos = [];\n}\n\n// Check if we have any signatures or photos\nif (\n  cti.store.jobs.selectedJob.photos.length > 0 ||\n  opSig ||\n  riskSig ||\n  cusSig\n) {\n  var photoLength = cti.store.jobs.selectedJob.photos.length;\n\n  // If we have any photos then kick off the endcoding proccess ...\n  if (photoLength > 0) {\n    for (var i in cti.store.jobs.selectedJob.photos) {\n      var thisPhoto = cti.store.jobs.selectedJob.photos[i];\n\n      toDataURL(thisPhoto, function(dataUrl, thisPhoto) {\n        thisPhoto.content = dataUrl;\n        photoLength--;\n\n        if (photoLength === 0) {\n          $success();\n        }\n      });\n    }\n  } else {\n    // ... otherwise bypass this and submit the signautres only\n    $success();\n  }\n} else {\n  // No photos or signatures so just process the jobcomplete event\n  cti.fnClearPhotos(cti.store.jobs.selectedJob.photos, true);\n\tdebugger;\n  cti.utils.callAction(\"call-actionflow\", { name: \"JobComplete\" });\n}\n"},"_auto_id_":"31da9bff-d4da-4118-8e51-5c48fb5f9bf8","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"// fnUploadPhotos function callback to handle the response of the image/signature upload\nfunction uploadedCallbackEvent(ok) {\n  if (ok) {\n    delete cti.store.variables.signatures;\n    delete cti.store.jobs.signaturesAssociatedJob;\n\n    cti.fnClearPhotos(cti.store.jobs.selectedJob.photos, true);\n    cti.utils.callAction(\"call-actionflow\", { name: \"JobComplete\" });\n  } else {\n    for (var i in cti.store.jobs.selectedJob.photos) {\n      delete cti.store.jobs.selectedJob.photos[i].content;\n    }\n\n    cti.store.payloads.failedPhotos = {\n      photos: cti.store.jobs.selectedJob.photos,\n      job: cti.store.jobs.selectedJob,\n      signatures: cti.store.variables.signatures\n    };\n\n    cti.fnStashPhotos();\n    delete cti.store.variables.signatures;\n  }\n}\n\ncti.fnOpenSpinner(\"Uploading photos and signatures to AccuServ...\");\ncti.fnUploadPhotos(\n  cti.store.jobs.selectedJob.photos,\n  cti.store.pages.AppSettings.accuservAPIAddress,\n  uploadedCallbackEvent,\n  true\n);"},"_auto_id_":"d532f297-b6e8-4fd6-bb02-b68c1691354b","actions":[]}]}],"name":"SubmitPhotos"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Fetch the jobCompleteOfflineHeaders to supply to the jobcompletion request\ncti.store.variables.jobCompleteOfflineHeaders = window.appManager.newHeaderData();\ncti.store.payloads.jobCompleteOffline = undefined;\n\nvar jobDetail = cti.store.jobs.failedJobToSend;\ncti.store.payloads.jobCompleteOffline = {};\n\nif(jobDetail.aItemGroups == undefined) jobDetail.aItemGroups = [];\nif(jobDetail.aVanStock == undefined) jobDetail.aVanStock = [];\n\nfor(var i in jobDetail.aItemGroups) { \n  delete jobDetail.aItemGroups[i].$index;\n}\n\nfor(var i in jobDetail.aVanStock) { \n  delete jobDetail.aVanStock[i].$index;\n}\n\nvar d = new Date();\nvar finishHours = (d.getHours()<10?'0':'') + d.getHours();\nvar finishMins = (d.getMinutes()<10?'0':'') + d.getMinutes();\n\nvar obj = {\n  \"bSuccess\" : jobDetail.bSuccess,\n  \"sStatus\" : jobDetail.sStatus,\n  \"sResultSummary\" : jobDetail.sResultSummary,\n  \"sResultSummarySubReason\" : jobDetail.sResultSummarySubReason,\n  \"sResultDetail\" : jobDetail.sResultDetail,\n  // ML Travel Date/Time Code\n  \"dStartTravelDate\" : jobDetail.dtJobTravelStartedDateTime,\n  \"iStartTravelHrs\" : parseInt(jobDetail.iJobStartedTravelHrs),\n  \"iStartTravelMins\" : parseInt(jobDetail.iJobStartedTravelMins),\n  //\n  \"dtArrivedOnDateTime\" : jobDetail.dtJobTravelEndedDateTime,\n  \"dArrivedOnDate\" : jobDetail.dtJobTravelEndedDateTime,\n  \"iArrivedOnHrs\" : parseInt(jobDetail.iJobEndedTravelHrs),\n  \"iArrivedOnMins\" : parseInt(jobDetail.iJobEndedTravelMins),\n  \"dtFinishedOnDateTime\" : moment().format(),\n  \"dFinishedOnDate\" : moment().format(),\n  \"iFinishedOnHrs\" : parseInt(finishHours),\n  \"iFinishedOnMins\" : parseInt(finishMins),\n  \"dtJobTargetDateTime\" : jobDetail.dtJobTargetDateTime,\n  \"dJobTargetDate\" : jobDetail.dtJobTargetDateTime,\n  \"iJobTargetHrs\" : parseInt(jobDetail.iJobTargetHrs),\n  \"iJobTargetMins\" : parseInt(jobDetail.iJobTargetMins),\n  \"aAccuServJobID\" : jobDetail.aAccuServJobID,\n  \"aOperativeDetail\" : jobDetail.aOperativeDetail,\n  \"aItemGroups\" : jobDetail.aItemGroups,\n  \"aStockItemsUsed\" : jobDetail.aVanStock,\n  \"aJobAdditionalDetail\" : jobDetail.aJobAdditionalDetail,\n  \"aInJobDataCollectionResponse\" : jobDetail.aInJobDataCollectionResponse,\n  \"aInJobEventStatus\" : jobDetail.aInJobEventStatus\n};\n\ncti.store.payloads.jobCompleteOffline = obj;\n$success();"},"_auto_id_":"02b4c772-178f-45ad-8350-1e2970fd3252","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobcompletion","params":{"messageid":"{{$store.variables.jobCompleteOfflineHeaders.messageid}}","messagedate":"{{$store.variables.jobCompleteOfflineHeaders.messagedate}}","authtoken":"{{$store.variables.jobCompleteOfflineHeaders.authtoken}}","applicationkey":"{{$store.variables.jobCompleteOfflineHeaders.applicationkey}}","data":"{{$store.payloads.jobCompleteOffline}}"}},"_auto_id_":"a7ea3774-b0b9-4650-a98b-6ef9ccc00b7e","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobcompletionoffline Endpoint - Returns:\n    {\n      \"bSuccess\": false, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message \n      \"messageid\": \"\" -- Unique message ID supplied from API\n    }\n*/\n\nvar resp = cti.store.api.AccuServ.jobcompletion;\n\nif(resp.bSuccess) {\n  var job = cti.store.payloads.jobCompleteOffline;\n  var jobId = job.aAccuServJobID.iJobEventNoKey;\n  var jobList = cti.store.jobs.jobList;\n  var jobDetails = cti.store.jobs.jobDetails;\n  var failedJobs = cti.store.jobs.failedJobs;\n  \n  for(var i in jobList) {\n    var thisJob = jobList[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobList.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in jobDetails) {\n    var thisJob = jobDetails[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobDetails.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in failedJobs) {\n    var thisJob = failedJobs[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      failedJobs.splice(i, 1);\n      break;\n    }\n  }\n  \n  window.appManager.logEvent('Offline job successfully re-submitted for Job ID: ' + job.aAccuServJobID.sJobNo, 'info');\n}\n\ndelete cti.store.payloads.jobCompleteOffline;\ndelete cti.store.variables.jobCompleteOfflineHeaders;\ndelete cti.store.jobs.failedJobToSend;\ndelete cti.store.api.AccuServ.jobcompletion;\n\ncti.utils.updatePage();"},"_auto_id_":"10f4311d-459d-4c59-8a5d-cb8570d932d4"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"delete cti.store.payloads.jobCompleteOffline;\ndelete cti.store.variables.jobCompleteOfflineHeaders;\ndelete cti.store.jobs.failedJobToSend;\n\ncti.utils.updatePage();"},"_auto_id_":"3420f0ef-5965-4036-8761-08dbd219c034"}]}]}],"name":"JobCompleteOffline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnOpenSpinner('Sending job details to AccuServ...');\n\n// Fetch the jobCompleteHeaders to supply to the jobDataCollection request\ncti.store.variables.jobCompleteHeaders = window.appManager.newHeaderData();\n\ncti.store.payloads.jobEventObject = undefined;\nvar jobDetail = cti.store.jobs.selectedJob;\nvar code;\n\nif(jobDetail.sResultSummary == \"ABANDON JOB\") {\n  code = \"71\";\n} else if(jobDetail.sResultSummary == \"NO ACCESS\") {\n  code = \"72\";\n} else if(jobDetail.sResultSummary == \"FOLLOW ON REQUIRED\") {\n  code = \"74\";\n} else {\n  code = \"70\";\n}\n\n// Send Event Status\ncti.fnSendEventStatus(code);\n\nvar completeEventStatus = cti.store.payloads.eventStatusPayload;\njobDetail.aInJobEventStatus.push(completeEventStatus);\n\nif(jobDetail.aItemGroups == undefined) jobDetail.aItemGroups = [];\nif(jobDetail.aVanStock == undefined) jobDetail.aVanStock = [];\n\nfor(var i in jobDetail.aItemGroups) { \n  delete jobDetail.aItemGroups[i].$index;\n}\n\nfor(var i in jobDetail.aVanStock) { \n  delete jobDetail.aVanStock[i].$index;\n}\n\nvar d = new Date();\nvar finishHours = (d.getHours()<10?'0':'') + d.getHours();\nvar finishMins = (d.getMinutes()<10?'0':'') + d.getMinutes();\n\nvar aSurveyName = {sSurveyName: \"LGSR\"};\nvar aSurveysCompleted = [aSurveyName];\n\ndebugger;\nvar obj = {\n  \"bSuccess\" : jobDetail.bSuccess,\n  \"sStatus\" : jobDetail.sStatus,\n  \"sResultSummary\" : jobDetail.sResultSummary,\n  \"sResultSummarySubReason\" : jobDetail.sResultSummarySubReason,\n  \"sResultDetail\" : jobDetail.sResultDetail,\n  // ML Travel Date/Time Code\n  \"dStartTravelDate\" : jobDetail.dtJobTravelStartedDateTime,\n  \"iStartTravelHrs\" : parseInt(jobDetail.iJobStartedTravelHrs),\n  \"iStartTravelMins\" : parseInt(jobDetail.iJobStartedTravelMins),\n  //\n  \"dtArrivedOnDateTime\" : jobDetail.dtJobTravelEndedDateTime,\n  \"dArrivedOnDate\" : jobDetail.dtJobTravelEndedDateTime,\n  \"iArrivedOnHrs\" : parseInt(jobDetail.iJobEndedTravelHrs),\n  \"iArrivedOnMins\" : parseInt(jobDetail.iJobEndedTravelMins),\n  \"dtFinishedOnDateTime\" : moment().format(),\n  \"dFinishedOnDate\" : moment().format(),\n  \"iFinishedOnHrs\" : parseInt(finishHours),\n  \"iFinishedOnMins\" : parseInt(finishMins),\n  \"dtJobTargetDateTime\" : jobDetail.dtJobTargetDateTime,\n  \"dJobTargetDate\" : jobDetail.dtJobTargetDateTime,\n  \"iJobTargetHrs\" : parseInt(jobDetail.iJobTargetHrs),\n  \"iJobTargetMins\" : parseInt(jobDetail.iJobTargetMins),\n  \"aAccuServJobID\" : jobDetail.aAccuServJobID,\n  \"aOperativeDetail\" : jobDetail.aOperativeDetail,\n  \"aItemGroups\" : jobDetail.aItemGroups,\n  \"aStockItemsUsed\" : jobDetail.aVanStock,\n  \"aJobAdditionalDetail\" : jobDetail.aJobAdditionalDetail,\n  \"aInJobDataCollectionResponse\" : jobDetail.aInJobDataCollectionResponse,\n  \"aInJobEventStatus\" : jobDetail.aInJobEventStatus,\n  \"aSurveysCompleted\" : aSurveysCompleted,\n  \"aPropertyDetail\" : jobDetail.aPropertyDetail\n};\n\ndebugger;\ncti.store.payloads.jobEventObject = obj;\n$success();"},"_auto_id_":"35f4b868-3994-40d2-90c3-9ef254b1b4e7","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobcompletion","params":{"messageid":"{{$store.variables.jobCompleteHeaders.messageid}}","messagedate":"{{$store.variables.jobCompleteHeaders.messagedate}}","authtoken":"{{$store.variables.jobCompleteHeaders.authtoken}}","applicationkey":"{{$store.variables.jobCompleteHeaders.applicationkey}}","data":"{{$store.payloads.jobEventObject}}"}},"_auto_id_":"e72eaa0d-10cd-444e-bc15-19b9a6b9961a","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobcompletion Endpoint - Returns:\n    {\n      \"bSuccess\": false, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message \n      \"messageid\": \"\" -- Unique message ID supplied from API\n    }\n*/\n\nvar resp = cti.store.api.AccuServ.jobcompletion;\nvar job = cti.store.payloads.jobEventObject;\n\nif(resp.bSuccess) { \n  var jobId = cti.store.payloads.jobEventObject.aAccuServJobID.iJobEventNoKey;\n  var jobList = cti.store.jobs.jobList;\n  var failedJobs = cti.store.jobs.failedJobs;\n  var jobDetails = cti.store.jobs.jobDetails;\n  var jobEventStatus = cti.store.variables.jobEventStatus;\n  var message;\n  var header;\n  \ndebugger;\n  \n  for(var i in jobList) {\n    var thisJob = jobList[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobList.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in jobDetails) {\n    var thisJob = jobDetails[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      jobDetails.splice(i, 1);\n      break;\n    }\n  }\n  \n  for(var i in failedJobs) {\n    var thisJob = failedJobs[i];\n    if(thisJob.aAccuServJobID.iJobEventNoKey === jobId) {\n      failedJobs.splice(i, 1);\n      break;\n    }\n  }\n  \n  if(jobEventStatus === \"jobcomplete\") {\n    header = \"Success: Job Complete\";\n    message = \"You have successfully Completed the following job: Job No. \";\n  } else if(jobEventStatus === \"abandonjob\") {\n    header = \"Success: Abandoned Job\";\n    message = \"You have successfully Abandoned the following job: Job No. \";\n  } else if(jobEventStatus === \"noaccess\") {\n    header = \"Success: No Access\";\n    message = \"You have successfully sent a No Access on the following job: Job No. \";\n  }\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_jobcomplete\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : header,\n      \"text\" : message + cti.store.jobs.selectedJob.aAccuServJobID.sJobNo\n    }\n  );\n  \n  cti.store.jobs.lastJobEvent = {\n    \"aAccuServJobID\" : cti.store.jobs.selectedJob.aAccuServJobID,\n    \"sPropertyID\" : cti.store.jobs.selectedJob.aPropertyDetail.sPropertyID,\n    \"sOperativeID\" : cti.store.jobs.selectedJob.aOperativeDetail.sOperativeID\n  };\n  \n  cti.store.variables.reSyncJobList = true;\n} else {\n  var jobFailed = JSON.parse(JSON.stringify(cti.store.jobs.selectedJob));\n  if(cti.store.jobs.failedJobs == undefined) cti.store.jobs.failedJobs = [];\n  cti.store.jobs.failedJobs.push(jobFailed);\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Job Failed to Send to Server\",\n      \"text\": resp.sStatus || \"AccuServ was unable to complete this Job.\"\n    }\n  );\n}\n\n// Clear job related data\ndelete cti.store.payloads.jobEventObject;\ndelete cti.store.variables.jobCompleteHeaders;\ndelete cti.store.variables.jobEventStatus;\n\n// Delete API response\ndelete cti.store.api.AccuServ.jobcompletion;\n\n// Clear all inscope data\nwindow.accuServFunctions.fnDataDestroy();\n\n// Close spinner\ncti.fnCloseSpinner(1000);\n\n// Get latest job list\ncti.utils.callAction('go-to-page', { \"name\": \"JobList\" });"},"_auto_id_":"2622fc1d-4187-4d2b-a1bd-5259815623a4","actions":[]},{"event":"fail","type":"call-function","data":{"name":"fnStashJob","params":{"job":"{{$store.jobs.selectedJob}}"}},"_auto_id_":"9edc80d8-f69b-4d4f-b529-d4de02d8ae27"}]}]}],"name":"JobComplete"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Requesting Purchase Order...');\n\n// Fetch the purchaseOrderHeaders to supply to the joblist request\ncti.store.variables.purchaseOrderHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"daecfd19-37f2-4540-a2af-203c0938f95b","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"purchaseorder","params":{"data":"{{$store.payloads.purchaseOrderPayload}}","applicationkey":"{{$store.variables.purchaseOrderHeaders.applicationkey}}","authtoken":"{{$store.variables.purchaseOrderHeaders.authtoken}}","messageid":"{{$store.variables.purchaseOrderHeaders.messageid}}","messagedate":"{{$store.variables.purchaseOrderHeaders.messagedate}}"}},"_auto_id_":"553e22dc-2e35-41f7-ae1d-116e056cefe9","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.purchaseorder;\nvar purchaseOrder = cti.store.jobs.selectedJob.aPurchaseOrder;\n\nif(resp.bSuccess) {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_specialordersent\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"info\",\n      \"title\" : \"Over The Counter Purchase Sent!\",\n      \"text\" : \"You have requested an Over the Counter Purchase from \" + cti.store.pages.OTCPurchases.orderSupplier.label + \" for Job Number \" + cti.store.jobs.selectedJob.aAccuServJobID.sJobNo\n    }\n  );\n  \n  delete cti.store.jobs.selectedJob.aOTCStock;\n  delete cti.store.jobs.selectedJob.aPurchaseOrder;\n  cti.utils.destroyPageData('OTCPurchases');\n  cti.store.variables.specialOrder = false;\n  cti.store.variables.poRaised = true;\n} else {\n  cti.store.jobs.failedPurchaseOrder = purchaseOrder;\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to place Purchase Order\",\n      \"text\": resp.sStatus || \"AccuServ was unable to place the requested Purchase Order\"\n    }\n  );\n}\n\ndelete cti.store.variables.purchaseOrderHeaders;\ndelete cti.store.payloads.purchaseOrderPayload;\ndelete cti.store.api.AccuServ.purchaseorder;\n\ncti.utils.updatePage();\ncti.fnCloseSpinner(1500);"},"_auto_id_":"3174974b-ff6c-4ccd-afcf-c478856b1d1b"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Sending Purchase Order Failed\",\n    \"text\": \"The request to send this Purchase Order failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete purchaseOrderHeaders payload object\ndelete cti.store.variables.purchaseOrderHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"856aec5b-3ae5-4954-a923-5b097476e5fc"}]}]}],"name":"PurchaseOrder"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading Order Catalogue...');\n\n// Fetch the otcHeaders to supply to the ordercatalogue request\ncti.store.variables.otcHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"61ab041f-56fc-4cf1-8920-0c1b0aab2af8","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"ordercatalogue","params":{"messageid":"{{$store.variables.otcHeaders.messageid}}","messagedate":"{{$store.variables.otcHeaders.messagedate}}","authtoken":"{{$store.variables.otcHeaders.authtoken}}","applicationkey":"{{$store.variables.otcHeaders.applicationkey}}"}},"_auto_id_":"76af2200-a35a-433b-ba63-59960d8fe15b","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* ordercatalogue Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aStockItemsFull\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar response = cti.store.api.AccuServ.ordercatalogue;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(response.bSuccess) {\n  // On success add the OTC data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"otcdata\", \n    response.aStockItemsFull, function(rev) {\n      window.appManager.logEvent('Saved OTC Stock data, revision: ' + rev);\n      var fullStock = response.aStockItemsFull;\n      var stock = [];\n      var filter = cti.store.variables.supplierOTCFilter;\n\n      for(var i in fullStock) {\n        var stockItem = fullStock[i].sAttrib1.trim();\n\n        if(filter === \"\" || filter === undefined) {\n          stock.push(fullStock[i]);\n        } else if(stockItem === filter) {\n          stock.push(fullStock[i]);\n        }\n      }\n\n      window.appManager.saveToDatabase(\"otcdata\", stock, function(rev) {\n        window.appManager.loadFromDatabase('otcdata', function (doc) {\n          var otcStock = cti.store.jobs.selectedJob.aOTCStock;\n          var selectedLocation = cti.store.variables.selectedLocation;\n          var exists = false;\n\n          for(var i in otcStock) {\n            if(otcStock[i].sLocation == selectedLocation.sLocation) {\n              exists = true;\n              break;\n            }\n          }\n\n          if(exists) {\n            cti.store.variables.menuOption = \"schedules\";\n          } else {\n            if(selectedLocation.sOTCStockQuantity != 0) {\n              cti.store.variables.menuOption = \"schedules\";\n            } else {\n              cti.store.variables.menuOption = \"search\";\n            }\n          }\n\n          cti.store.variables.otcStockSearchResults = [];\n          var count = 10;\n\n          for(var i in doc.data) {\n            if(count === 0) {\n              break;\n            } else {\n              count--;\n              cti.store.variables.otcStockSearchResults.push(doc.data[i]);\n            }\n          }\n            \n          cti.utils.callAction('go-to-page', { \"name\": \"OTCCodes\" });\n          $success();\n        }, function (reason, err) {\n          cti.fnCloseSpinner();\n          cti.utils.callAction('call-actionflow', { \"name\": \"OnlineOTCCodes\" });\n        });\n        \n        $success();\n      }, function(reason, e) {\n        window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n        $success();\n      });\n\n      $success();\n    }, function(reason, e) {\n      window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n      \n      // Close Spinner\n\t  cti.fnCloseSpinner();\n      \n      $success();\n    });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve OTC information\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide Order Catalogue lookup information.\"\n    }\n  );\n  window.appManager.logEvent('Failed to retrieve OTC data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete API response\ndelete cti.store.api.AccuServ.ordercatalogue;\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;"},"_auto_id_":"4cca62c0-a22d-463e-bbe3-605bac61e6d4"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve OTC information\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch Order Catalogue Stock information.\"\n  }\n);\nwindow.appManager.logEvent('Failed to retrieve OTC data (API connection).', 'warning');\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"7fec6a2f-b238-49a1-a690-0bee0167a7ee"}]}]}],"name":"OnlineOTCCodes"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading Van Stock Codes...');\n\n// Fetch the vanStockHeaders to supply to the vanstock request\ncti.store.variables.vanStockHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"0a7054fa-d2dd-4408-a92b-f90e5378e5ef","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"vanstock","params":{"messageid":"{{$store.variables.vanStockHeaders.messageid}}","messagedate":"{{$store.variables.vanStockHeaders.messagedate}}","authtoken":"{{$store.variables.vanStockHeaders.authtoken}}","applicationkey":"{{$store.variables.vanStockHeaders.applicationkey}}"}},"_auto_id_":"bcb0b07e-22f2-4617-b1ec-b1e617124d74","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* VanStock Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aOperativeVanStock\": [] -- Array of operative van stock\n    }\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.vanstock;\n\n// Check response for failure \n// Notify user with popup warning if the Van Stock failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(resp.bSuccess) {\n  // Re-package response into the offline store for future reference\n  cti.store.offlineApi.AccuServOffline.vanstock = JSON.parse(JSON.stringify(resp));\n  \n  // Timestamp the vanStockLastRetrievedDate\n  cti.store.staticData.vanStockLastRetrievedDate = moment().format();\n  \n  cti.store.variables.lastVanSelectPage = cti.store.state.currentPage;\n\n  var vanStock = cti.store.jobs.selectedJob.aVanStock;\n  var selectedLocation = cti.store.variables.selectedLocation;\n  var exists = false;\n\n  for(var i in vanStock) {\n    if(vanStock[i].sLocation == selectedLocation.sLocation) {\n      exists = true;\n      break;\n    }\n  }\n\n  if(exists) {\n    cti.store.variables.menuOption = \"schedules\";\n  } else {\n    if(selectedLocation.sVanStockQuantity != 0) {\n      cti.store.variables.menuOption = \"schedules\";\n    } else {\n      cti.store.variables.menuOption = \"search\";\n    }\n  }\n\n  delete cti.store.variables.vanStockSearchResults;\n  cti.utils.callAction('go-to-page', { \"name\": \"VanStockCodes\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve Van Stock\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide your Van Stock information.\"\n    }\n  );\n  window.appManager.logEvent('Failed to retrieve Van Stock. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete API response\ndelete cti.store.api.AccuServ.vanstock;\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"af29efc1-a318-4f47-bfc1-40a7c6180099"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve Van Stock\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch your Van Stock information.\"\n  }\n);\nwindow.appManager.logEvent('Failed to retrieve Van Stock data (API connection).', 'warning');\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;"},"_auto_id_":"7d828999-3c05-4897-b0ea-d94320ec777c"}]}]}],"name":"OnlineVanCodes"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading SOR Codes...');\n\n// Fetch the sorHeaders to supply to the SOR request\ncti.store.variables.sorHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"91708b02-791a-40a3-b319-94f6972836b0","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"sordata","params":{"messageid":"{{$store.variables.sorHeaders.messageid}}","messagedate":"{{$store.variables.sorHeaders.messagedate}}","authtoken":"{{$store.variables.sorHeaders.authtoken}}","applicationkey":"{{$store.variables.sorHeaders.applicationkey}}"}},"_auto_id_":"559f573c-26eb-464f-a799-0da8665f4f4f","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* SORCodes Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aSORCodesDetail\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.sordata;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(resp.bSuccess) {\n  // On success add the SOR data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"sordata\", \n    resp.aSORCodesDetail, function(rev) {\n      window.appManager.logEvent('Saved SOR data, revision: ' + rev);\n      cti.store.variables.lastSORSelectPage = cti.store.state.currentPage;\n      var sorCodes = cti.store.jobs.selectedJob.aItemGroups;\n      var selectedLocation = cti.store.variables.selectedLocation;\n      var exists = false;\n\n      for(var i in sorCodes) {\n        if(sorCodes[i].sLocation == selectedLocation.sLocation) {\n          exists = true;\n          break;\n        }\n      }\n\n      if(exists) {\n        cti.store.variables.menuOption = \"schedules\";\n      } else {\n        if(selectedLocation.sSORCodesQuantity != 0) {\n          cti.store.variables.menuOption = \"schedules\";\n        } else {\n          cti.store.variables.menuOption = \"search\";\n        }\n      }\n\n      cti.store.variables.sorCodeSearchResults = [];\n      var count = 10;\n\n      for(var i in doc.data) {\n        if(count === 0) {\n          break;\n        } else {\n          count--;\n          cti.store.variables.sorCodeSearchResults.push(doc.data[i]);\n        }\n      }\n\n      cti.utils.callAction('go-to-page', { \"name\": \"SORCodes\" });\n      \n      $success();\n    }, function(reason, e) {\n      window.appManager.logError('Failed to save SOR data - ' + reason, e);\n      \n      // Close Spinner\n\t  cti.fnCloseSpinner();\n      \n      $success();\n    });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve SOR information\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide Schedule or Rates lookup information.\"\n    }\n  );\n  window.appManager.logEvent('Failed to retrieve SOR data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete API response\ndelete cti.store.api.AccuServ.sordata;\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;"},"_auto_id_":"a4c8c9fd-aede-4db8-9bd8-e638a8c3107f"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve SOR information\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch Schedule of Rates lookup information.\"\n  }\n);\nwindow.appManager.logEvent('Failed to retrieve SOR data (API connection).', 'warning');\n\n// Delete API response\ndelete cti.store.api.AccuServ.sordata;\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"9d31669b-ac19-46c9-9c67-85ccfaeeeb56"}]}]}],"name":"OnlineSORCodes"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load spinner\ncti.fnOpenSpinner('Downloading Stock Locations...');\n\n// Define locations array\nif(cti.store.jobs.jobLocations == undefined) cti.store.jobs.jobLocations = [];\n\n// Fetch the jobLocationsHeaders to supply to the locations request\ncti.store.variables.jobLocationsHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"23e40e46-bf13-4032-88f6-1cdddfac877f","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"joblocations","params":{"messageid":"{{$store.variables.jobLocationsHeaders.messageid}}","messagedate":"{{$store.variables.jobLocationsHeaders.messagedate}}","authtoken":"{{$store.variables.jobLocationsHeaders.authtoken}}","applicationkey":"{{$store.variables.jobLocationsHeaders.applicationkey}}"}},"_auto_id_":"6b690ef1-2c49-4dba-a9f6-700941275e98","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* joblocations Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"aJobLocationDetail\": [],\n      \"messageid\": \"\"\n    }\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.joblocations;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var jobLocationsObj = JSON.parse(JSON.stringify(resp.aJobLocationDetail));\n  \n  cti.store.jobs.jobLocations = jobLocationsObj;\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Failed to retrieve Locations\",\n      \"text\": resp.sStatus || \"AccuServ was unable to provide location lookup information.\"\n    }\n  );\n\twindow.appManager.logEvent('Failed to retrieve Locations static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete jobLocationsHeaders payload object\ndelete cti.store.variables.jobLocationsHeaders;\n\n// Delete API response\ndelete cti.store.api.AccuServ.joblocations;\n\n// Close spinner\ncti.fnCloseSpinner();\n\n// Reorder Locations\ncti.fnOrderSORLocations();\ncti.fnOrderVanLocations();\ncti.fnOrderOTCLocations();"},"_auto_id_":"984dbaa0-f734-46ad-b010-b6f5d2bf9e02"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to retrieve Locations\",\n    \"text\": \"We couldn't reach the AccuServ server to fetch location lookup information.\"\n  }\n);\n\n// Log app manager warning\nwindow.appManager.logEvent('Failed to retrieve Locations static data (API connection).', 'warning');\n\n// Delete headers\ndelete cti.store.variables.jobLocationsHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();\n\n// Reorder Locations\ncti.fnOrderSORLocations();"},"_auto_id_":"3404a280-c6d6-47e1-9e71-20e88412b801"}]}]}],"name":"OnlineStockLocations"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobCollectionType = cti.store.variables.jobCollectionType;\nvar selectedJob = cti.store.jobs.selectedJob;\n\n// Fetch the jobDataCollectionHeaders to supply to the jobDataCollection request\ncti.store.variables.jobDataCollectionHeaders = window.appManager.newHeaderData();\n\n// Check the jobCollectionType to see what type of payload we need to package\nif(jobCollectionType === \"warnings\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"WarningsRead\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"WarningsRead\"\n      ],\n      \"asValues\": [\n        \"Y\"\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  $success();\n} else if(jobCollectionType === \"riskassessment\") {\n  var riskAssessment = cti.store.payloads.riskAssessmentPayload;\n  \n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"RiskAssessment\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"Q1\",\n        \"Q2\",\n        \"Q3\",\n        \"Q4\",\n        \"Q5\",\n        \"Q6\",\n        \"Q7\",\n        \"Q8\"\n      ],\n      \"asValues\": [\n        riskAssessment.questionOne,\n        riskAssessment.questionTwo,\n        riskAssessment.questionThree,\n        riskAssessment.questionFour,\n        riskAssessment.questionFive,\n        riskAssessment.questionSix,\n        riskAssessment.questionSeven,\n        riskAssessment.questionEight\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  $success();\n} else if(jobCollectionType === \"initialvisit\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"InitialVisitAssessment\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"EstimatedTime\",\n        \"OperativeComment\"\n      ],\n      \"asValues\": [\n        selectedJob.sExpected_Duration,\n        cti.store.pages.StartingWork.workDescription\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n  $success();\n} else if(jobCollectionType === \"tenantphoto\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"TenantPhotoConsent\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"TenantPhotoConsent\",\n        \"TenantPhotoComment\"\n      ],\n      \"asValues\": [\n        selectedJob.bWorkPhoto,\n        selectedJob.bWorkPhotoComment\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  $success();\n} else if(jobCollectionType === \"updatevisit\") {\n  cti.store.payloads.jobDataCollectionPayload = {\n    \"sCollectionName\": \"UpdatedVisitAssessment\",\n    \"dtCollectionDateTime\": moment().format(),\n    \"aAccuServJobID\": {\n      \"sJobNo\": selectedJob.aAccuServJobID.sJobNo,\n      \"iEventNo\": selectedJob.aAccuServJobID.iEventNo,\n      \"iJobEventNoKey\": selectedJob.aAccuServJobID.iJobEventNoKey,\n      \"sSchedulerID\": selectedJob.aAccuServJobID.sSchedulerID,\n      \"sOriginatorID\": selectedJob.aAccuServJobID.sOriginatorID\n    },\n    \"tPairs\": {\n      \"asKeys\": [\n        \"EstimatedTime\"\n      ],\n      \"asValues\": [\n        selectedJob.sExpected_Duration\n      ]\n    }\n  };\n  \n  cti.store.jobs.selectedJob.aInJobDataCollectionResponse.push(cti.store.payloads.jobDataCollectionPayload);\n  cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n  $success();\n}"},"_auto_id_":"b23a7e6f-e4c0-4862-918c-fc192fa00a1f","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"jobdatacollection","params":{"data":"{{$store.payloads.jobDataCollectionPayload}}","messageid":"{{$store.variables.jobDataCollectionHeaders.messageid}}","messagedate":"{{$store.variables.jobDataCollectionHeaders.messagedate}}","authtoken":"{{$store.variables.jobDataCollectionHeaders.authtoken}}","applicationkey":"{{$store.variables.jobDataCollectionHeaders.applicationkey}}"}},"_auto_id_":"b8c6575f-c6c6-40db-abf5-df3afcfcdda8","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* jobdatacollection endpoint returns\n  {\n    \"bSuccess\": boolean,\n    \"sStatus\": string,\n    \"messageid\": string\n  }\n*/\n\nvar resp = cti.store.offlineApi.AccuServOffline.jobdatacollection;\nvar jobCollectionType = cti.store.variables.jobCollectionType;\nvar job = cti.store.jobs.selectedJob;\n\nif(resp) {\n  if(resp.bSuccess) {\n    if(job != undefined) {\n      if(jobCollectionType === \"warnings\") {\n        job.aPropertyDetail.bPropertyWarningsDataCollection = true;\n      }\n      if(jobCollectionType === \"tenantphoto\") {\n        job.bTenantPhotDataCollection = true;\n      }\n      if(jobCollectionType === \"initialvisit\") {\n        job.bInitialVisitDataCollection = true;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n      if(jobCollectionType === \"updatevisit\") {\n        job.bUpdatedVisitDataCollection = true;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n    }\n  } else {\n    if(job != undefined) {\n      window.appManager.logEvent('Data collection failed: ' + resp, 'warning');\n      if(jobCollectionType === \"warnings\") {\n        job.aPropertyDetail.bPropertyWarningsDataCollection = false;\n      }\n      if(jobCollectionType === \"tenantphoto\") {\n        job.bTenantPhotDataCollection = false;\n      }\n      if(jobCollectionType === \"initialvisit\") {\n        job.bInitialVisitDataCollection = false;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n      if(jobCollectionType === \"updatevisit\") {\n        job.bUpdatedVisitDataCollection = false;\n        cti.store.jobs.expectedDurationData = cti.store.payloads.jobDataCollectionPayload;\n      }\n    }\n    window.appManager.logEvent('Data collection failed - no response.', 'warning');\n  }\n} else {\n  window.appManager.logEvent('Data collection response returned outside of job scope.', 'error');\n}\n\n// Clear variables relating to the data collection\ndelete cti.store.variables.jobDataCollectionHeaders;\ndelete cti.store.variables.jobCollectionType;\ndelete cti.store.payloads.jobDataCollectionPayload;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.jobdatacollection;"},"_auto_id_":"bab35c28-1475-48fb-989c-23a765cfbffa"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* jobdatacollection endpoint returns\n  {\n    \"bSuccess\": boolean,\n    \"sStatus\": string,\n    \"messageid\": string\n  }\n*/\n\nvar resp = cti.store.offlineApi.AccuServOffline.jobdatacollection;\n\n// TODO: Handle error response\n\n// Clear data collection information\ndelete cti.store.variables.jobDataCollectionHeaders;\ndelete cti.store.variables.jobCollectionType;\ndelete cti.store.payloads.jobDataCollectionPayload;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.jobdatacollection;"},"_auto_id_":"35b69b14-f4ee-49e3-863c-e95b78985745"}]}]}],"name":"JobDataCollection"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Booking Follow On Appointment...');\n\n// Fetch the followOnHeaders to supply to the joblist request\ncti.store.variables.followOnHeaders = window.appManager.newHeaderData();\n\nvar jobDetail = cti.store.jobs.selectedJob;\ncti.store.payloads.bookFollowOnPayload = {};\n\nvar data = {\n  \"iJobEventNoKey\": jobDetail.aAccuServJobID.iJobEventNoKey, \n  \"dApptDate\": jobDetail.sFollowOnRequiredDetail.dWorkDate, \n  \"sOperative\": jobDetail.sFollowOnRequiredDetail.sOperative,\n  \"sTrade\": cti.store.pages.FollowOnContinued.followOnTradeReq.label,\n  \"iDuration\": parseInt(cti.store.pages.FollowOnContinued.followOnDuration.value),\n  \"sComment\": cti.store.pages.FollowOnAppointment.followOnComments,\n};\n\ncti.store.payloads.bookFollowOnPayload = data;\n\n$success();"},"_auto_id_":"af616789-ff20-4fa4-af0f-517824152426","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"followonappointment","params":{"data":"{{$store.payloads.bookFollowOnPayload}}","messageid":"{{$store.variables.followOnHeaders.messageid}}","messagedate":"{{$store.variables.followOnHeaders.messagedate}}","authtoken":"{{$store.variables.followOnHeaders.authtoken}}","applicationkey":"{{$store.variables.followOnHeaders.applicationkey}}"}},"_auto_id_":"d490b44e-4276-4798-8142-cc5fd160fd86","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.followonappointment;\n\nif(resp.bSuccess) {\n  delete cti.store.jobs.selectedJob.sFollowOnRequiredDetail;\n  delete cti.store.jobs.followOnTimeSlots;\n  delete cti.store.variables.appointmentResults\n  cti.utils.destroyPageData('FollowOnContinued');\n  delete cti.store.jobs.selectedJob.bFollowOnRequired;\n  \n  cti.utils.callAction('go-to-page', { \"name\": \"FollowOnAppointment\" });\n  \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"app_followon\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Follow On Appointment Booked\",\n      \"text\" : \"Status: \" + resp.sStatus + \". Follow On Appointment successfully booked through AccuServ.\"\n    }\n  );\n} else {\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Error Booking Follow On Appointment\",\n      \"text\" : resp.sStatus || \"A problem occured when trying to retrieve the Follow On Time Slots\"\n    }\n  );\n}\n\ndelete cti.store.api.AccuServ.followonappointment;\ndelete cti.store.variables.followOnHeaders;\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"a3517e7c-0780-47aa-8a32-86bf64f2d2b8","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Booking Follow On Appointment Request to API Failed\",\n    \"text\": \"The request to Book the Follow On Appointment failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete followOnHeaders payload object\ndelete cti.store.variables.followOnHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"a713798e-f2ba-45a1-9eb7-6a51cdb4bd4d"}]}]}],"name":"BookFollowOnSlot"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\ncti.fnOpenSpinner('Fetching Available Appointments...');\n\n// Fetch the followOnHeaders to supply to the joblist request\ncti.store.variables.followOnHeaders = window.appManager.newHeaderData();\n\nvar jobDetail = cti.store.jobs.selectedJob;\ncti.store.payloads.timeSlotsPayload = {};\n\nvar data = {\n  \"job\" : {\n    \"sJobNo\": jobDetail.aAccuServJobID.sJobNo, \n    \"iEventNo\": jobDetail.aAccuServJobID.iEventNo, \n    \"iJobEventNoKey\": jobDetail.aAccuServJobID.iJobEventNoKey, \n    \"sSchedulerID\": jobDetail.aAccuServJobID.sSchedulerID, \n    \"sOriginatorID\": jobDetail.aAccuServJobID.sOriginatorID\n  },\n  \"sTrade\": cti.store.pages.FollowOnContinued.followOnTradeReq.label,\n  \"iMinutes\": parseInt(cti.store.pages.FollowOnContinued.followOnDuration.value),\n  \"dStartDate\": moment(cti.store.pages.FollowOnContinued.followOnDate).format('YYYY-MM-DD'),\n  \"iDays\": cti.store.pages.FollowOnContinued.followOnDays\n};\n\ncti.store.payloads.timeSlotsPayload = data;\n\n$success();"},"_auto_id_":"404de174-16e7-4361-9ee1-5a1beddef1fa","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"followonavailability","params":{"data":"{{$store.payloads.timeSlotsPayload}}","messageid":"{{$store.variables.followOnHeaders.messageid}}","messagedate":"{{$store.variables.followOnHeaders.messagedate}}","authtoken":"{{$store.variables.followOnHeaders.authtoken}}","applicationkey":"{{$store.variables.followOnHeaders.applicationkey}}"}},"_auto_id_":"c7c315db-00cd-412d-80f2-383996f1faa6","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var resp = cti.store.api.AccuServ.followonavailability;\nvar id = 1;\nvar timeSlots = [];\n\ndelete cti.store.jobs.followOnTimeSlots;\n\nif(resp.bSuccess) {\n  var returnedTimeSlots = resp.items;\n  \n  if(returnedTimeSlots.length === 0) {\n    cti.store.variables.appointmentResults = false;\n  } else {\n    cti.store.variables.appointmentResults = true;\n    for(var i in returnedTimeSlots) {\n      var thisSlot = returnedTimeSlots[i];\n      var description;\n      var date = moment(thisSlot.dWorkDate);\n      var slot = thisSlot.sOperative;\n\n      var timeSlot = moment(date).format('dddd DD-MMM-YYYY');\n\n      description = timeSlot + ' ' + slot;\n\n      var obj = {\n        id: id,\n        description: description,\n        selected: false,\n        sOperative: slot,\n        dWorkDate: thisSlot.dWorkDate,\n        sWeekDay: thisSlot.sWeekDay,\n        nMaxSlots: thisSlot.nMaxSlots,\n        nUsedSlots: thisSlot.nUsedSlots,\n        sStatus: thisSlot.sStatus\n      };\n\t\t\n      id++;\n      timeSlots.push(obj);\n    }\n  }\n} else {\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Error Retrieving Follow On Availability\",\n      \"text\" : resp.sStatus || \"A problem occured when trying to retrieve the Follow On Time Slots\"\n    }\n  );\n}\n  \ncti.store.jobs.followOnTimeSlots = timeSlots;\n\ndelete cti.store.api.AccuServ.followonavailability;\ndelete cti.store.variables.followOnHeaders;\n\ncti.store.jobs.selectedJob.bFollowOnRequired = false;\ncti.store.jobs.selectedJob.sFollowOnRequiredDetail = undefined;\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"8abb58a7-1b99-4e38-9340-44de5f4f3d2d"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Follow On Availability Request to API Failed\",\n    \"text\": \"The request to fetch the Follow On Time Slots failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete followOnHeaders payload object\ndelete cti.store.variables.followOnHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"2f1766f6-efe0-4160-aa0e-f5036de70fa0"}]}]}],"name":"GetFollowOnSlots"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Fetch the jobHistoryHeaders to supply to the joblist request\ncti.store.variables.jobHistoryHeaders = window.appManager.newHeaderData();\n\n// Package parameter payload for jobhistory API call\nvar jobID = cti.store.jobs.selectedJob.aAccuServJobID;\ncti.store.payloads.jobHistory = {\n  \"jobID\": {\n    \"sJobNo\": jobID.sJobNo,\n    \"iEventNo\": jobID.iEventNo,\n    \"iJobEventNoKey\": jobID.iJobEventNoKey,\n    \"sSchedulerID\": \"\",\n    \"sOriginatorID\": \"\"\n  },\n  \"contractType\": \"CURRENT\",\n  \"noOfJobs\": 9\n};\n\nvar exists = false;\n\nif(cti.store.jobs.jobHistory) {\n  for(var i in cti.store.jobs.jobHistory) {\n    var job = cti.store.jobs.jobHistory[i];\n    \n    if(job.aAccuServJobID.iJobEventNoKey == jobID.iJobEventNoKey) {\n      exists = true;\n      break;\n    }\n  }\n}\n\nif(!exists) {\n  $success();\n}"},"_auto_id_":"caf974de-17ab-4ef3-9e40-01fa972ccb51","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobhistory","params":{"authtoken":"{{$store.variables.jobHistoryHeaders.authtoken}}","applicationkey":"{{$store.variables.jobHistoryHeaders.applicationkey}}","messageid":"{{$store.variables.jobHistoryHeaders.messageid}}","messagedate":"{{$store.variables.jobHistoryHeaders.messagedate}}","data":"{{$store.payloads.jobHistory}}"}},"_auto_id_":"dc067f43-45c0-4171-bde4-af5cda1ded14","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Job History Endpoint - Returns:\n    {\n      \"bSuccess\": boolean,\n      \"sStatus\": string,\n      \"iNoOfJobsReturned\": int,\n      \"aAccuServJobsSummaryList\": [array]\n  \t}\n*/\n\n// Grab response\nvar resp = cti.store.api.AccuServ.jobhistory;\n\n// Check response for failure\n// Package jobhistory in variable and navigate\n// to JobHistory page if errorCode returns 0\nif(resp.bSuccess) {\n  var detailHistoryObj = JSON.parse(JSON.stringify(resp.aAccuServJobsSummaryList));\n\n  for(var i in detailHistoryObj) {\n    var history = detailHistoryObj[i];\n    var date = moment(history.dAttendOnDate);\n    \n    history.dAttendOnDate = moment(history.dAttendOnDate).format('Do MMMM YYYY');\n    history.sDay = date.format('Do');\n    history.sMonth = date.format('MMM');\n    \n    if(history.iAttendOnHrs < 10) { \n      history.iAttendOnHrs = \"0\" + history.iAttendOnHrs.toString(); \n    } else {\n      history.iAttendOnHrs = history.iAttendOnHrs.toString();\n    }\n    \n    if(history.iAttendOnMins < 10) { \n      history.iAttendOnMins = \"0\" + history.iAttendOnMins.toString(); \n    } else {\n      history.iAttendOnMins = history.iAttendOnMins.toString();\n    }\n    \n    if(history.iAttendOnHrs < 12) { \n      history.iAttendOnMins += \"AM\";\n    } else {\n      history.iAttendOnMins += \"PM\";\n    }\n  }\n  \n  cti.store.jobs.jobHistory = detailHistoryObj;\n  cti.utils.callAction('go-to-page', { \"name\": \"JobHistory\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Failed to fetch Job History data\",\n      \"text\" : resp.sStatus\n    }\n  );\n}\n\n// Delete API response package\ndelete cti.store.api.AccuServ.jobhistory;\n\n// Delete jobHistoryHeaders payload object\ndelete cti.store.variables.jobHistoryHeaders;\n\n// Delete jobHistory payload object\ndelete cti.store.variables.jobHistory;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"325beff4-c6dd-4780-b893-765fb5823929"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Job History Request to API Failed\",\n    \"text\": \"The request to fetch the Job History failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete jobHistoryHeaders payload object\ndelete cti.store.variables.jobHistoryHeaders;\n\n// Delete jobHistory payload object\ndelete cti.store.variables.jobHistory;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"4da8a904-b6bf-4622-8e59-108f2938ff3b"}]}]}],"name":"GetJobHistory"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Package jobId for API call\ncti.store.variables.jobDetailToFetch = {\n  \"iJobEventNoKey\" : cti.store.variables.selectedJobId\n};\n\n// Fetch the jobDetailHeaders to supply to the jobdetail request\ncti.store.variables.jobDetailHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"5b3fe1f1-7428-418c-aba3-19136f60c485","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"jobdetail","params":{"messageid":"{{$store.variables.jobDetailHeaders.messageid}}","messagedate":"{{$store.variables.jobDetailHeaders.messagedate}}","authtoken":"{{$store.variables.jobDetailHeaders.authtoken}}","applicationkey":"{{$store.variables.jobDetailHeaders.applicationkey}}","data":"{{$store.variables.jobDetailToFetch}}"}},"_auto_id_":"f2fc8f76-a775-48eb-b58f-79f39380aff1","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Job Detail Endpoint - Returns:\n    { \n      \"jobdetail\"\n    }\n*/\n\n// Grab response\nvar jobDetails = cti.store.jobs.jobDetails;\nvar resp = cti.store.api.AccuServ.jobdetail;\nvar detailIndex = undefined;\n\n// Check response for failure\n// Package jobdetail in variable and discard selectedJobId before continuing\n// to TenantDetails if errorCode returns 0\nif(resp.bSuccess) {\n  for(var j in jobDetails) {\n    if(resp.sJobNo == jobDetails[j].sJobNo) {\n      detailIndex = j;\n      break;\n    }\n  }\n\n  var detailObj = JSON.parse(JSON.stringify(resp));\n  var items = [];\n\n  for(var i in detailObj.aItemGroups) {\n    var thisItem = detailObj.aItemGroups[i]; \n    var str = JSON.stringify(thisItem);\n    \n    str = str.replace(/sLongDescription/g, 'sLongDescr');\n    str = str.replace(/sDescription/g, 'sShortDescr');\n\n    thisItem = JSON.parse(str);\n\n    delete thisItem.nQtyDoneToDate;\n    delete thisItem.sID;\n    delete thisItem.sPriceBook;\n    delete thisItem.sSpecialInstruction;\n    delete thisItem.sUnitOfMeasure;\n\n    if(thisItem.nSMVs == \"\" || thisItem.nSMVs == undefined) {\n      thisItem.nSMVs = 0;\n    }\n    if(thisItem.nSellPrice == \"\" || thisItem.nSellPrice == undefined) {\n      thisItem.nSellPrice = 0;\n    }\n    thisItem.sAttrib1 = \"\";\n    thisItem.sAttrib2 = \"\";\n    thisItem.sAttrib3 = \"\";\n    thisItem.sAttrib4 = \"\";\n    thisItem.sStockUnit = \"\";\n    thisItem.sTrade = \"\";\n    thisItem.nQtyRemaining = thisItem.nQtyRequired;\n\n    if(thisItem.sLongDescr == \"\" || thisItem.sLongDescr == undefined) {\n      thisItem.sLongDescr = thisItem.sShortDescr;\n    }\n\n    items.push(thisItem);\n  }\n\n  detailObj.aItemGroups = items;\n  \n  if(detailIndex == undefined) {\n    jobDetails.push(detailObj);\n  } else {\n    jobDetails[detailIndex] = detailObj;\n  }\n  \n  // Re-set the jobDetail store\n  cti.store.jobs.jobDetails = jobDetails;\n  \n  // Append selectedJob object\n  cti.store.jobs.selectedJob = detailObj;\n  \n  if(cti.store.jobs.selectedJob.aInJobDataCollectionResponse === undefined) {\n    cti.store.jobs.selectedJob.aInJobDataCollectionResponse = [];\n  }\n  if(cti.store.jobs.selectedJob.aInJobEventStatus === undefined) {\n    cti.store.jobs.selectedJob.aInJobEventStatus = [];\n  }\n\n  if(cti.store.staticData.jobLocations != undefined) {\n    if(cti.store.staticData.jobLocations.length > 0) {\n      cti.fnOrderSORLocations();\n      cti.fnOrderVanLocations();\n      cti.fnOrderOTCLocations();\n    }\n  }\n  \n  // Send job status\n  cti.fnSendEventStatus(\"30\");\n\n  // Navigate to Tenant Details page\n  cti.utils.callAction('go-to-page', { \"name\": \"TenantDetails\" });\n} else {\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Failed to fetch Job Detail data\",\n      \"text\" : resp.errorMessage\n    }\n  );\n}\n\n// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n\n// Delete API response package\ndelete cti.store.api.AccuServ.jobdetail;\n\n// Delete jobId parameter variable\ndelete cti.store.variables.jobDetailToFetch;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"1a17dbcb-6c37-4b7d-8489-63b601cad491","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Job Detail Request to API Failed\",\n    \"text\": \"The request to fetch the Job Detail failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"cd999520-e74a-45a0-9629-07b3d4d8388a","actions":[]}]}]}],"name":"GetJobDetailOnline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Fetch the jobDetailHeaders to supply to the joblist request\ncti.store.variables.jobDetailHeaders = window.appManager.newHeaderData();\n\n// Set our last job detail object to avoid calling twice\ncti.store.variables.pendingJobDetailToFetch = cti.store.variables.jobDetailToFetch;\n\n$success();"},"_auto_id_":"71347fa4-e705-4cc3-88b5-339dca209b6d","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"jobdetail","params":{"messageid":"{{$store.variables.jobDetailHeaders.messageid}}","messagedate":"{{$store.variables.jobDetailHeaders.messagedate}}","authtoken":"{{$store.variables.jobDetailHeaders.authtoken}}","applicationkey":"{{$store.variables.jobDetailHeaders.applicationkey}}","data":"{{$store.variables.jobDetailToFetch}}"}},"_auto_id_":"aae5af85-5890-48ab-a3fc-c850dbf3798c","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Job Detail Endpoint - Returns:\n    { \n      \"jobdetail\"\n    }\n*/\n\n// Grab response\nvar jobDetails = cti.store.jobs.jobDetails;\nvar resp = cti.store.offlineApi.AccuServOffline.jobdetail;\nvar detailIndex = undefined;\n\n// Check response for failure\n// Package jobdetail in variable and discard selectedJobId before continuing\n// to TenantDetails if errorCode returns 0\nif(resp.bSuccess) {\n  for(var j in jobDetails) {\n    if(resp.sJobNo == jobDetails[j].sJobNo) {\n      detailIndex = j;\n      break;\n    }\n  }\n\n  var detailObj = JSON.parse(JSON.stringify(resp));\n  \n  if(detailIndex == undefined) {\n    jobDetails.push(detailObj);\n  } else {\n    jobDetails[detailIndex] = detailObj;\n  }\n  \n  // Re-set the jobDetail store\n  cti.store.jobs.jobDetails = jobDetails;\n  \n  // Reset pending job\n  delete cti.store.variables.pendingJobDetailToFetch;\n} else {\n  // Remove a retry attempt from the retrieveJobRetry variable on failed call\n  cti.store.jobs.retrieveJobRetry = cti.store.jobs.retrieveJobRetry - 1;\n}\n\n// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n\n// Delete API response package\ndelete cti.store.offlineApi.AccuServOffline.jobdetail;"},"_auto_id_":"c90eef66-260c-4900-acfa-47a8ae5ca704","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Delete jobDetailHeaders payload object\ndelete cti.store.variables.jobDetailHeaders;\n// Remove a retry attempt from the retrieveJobRetry variable on failed call\ncti.store.jobs.retrieveJobRetry = cti.store.jobs.retrieveJobRetry - 1;"},"_auto_id_":"d32be868-3b2b-4206-a648-db58f2ef3cf8","actions":[]}]}]}],"name":"GetJobDetailOffline"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Load Spinner\nif(!cti.store.variables.reSyncJobListAuto) {\n  if(cti.store.variables.reSyncJobList) {\n    cti.fnOpenSpinner('Job List Updated: Syncing new Job List...');\n  } else {\n    cti.fnOpenSpinner('Fetching Job List...');\n  }\n}\n\n// Fetch the jobListHeaders to supply to the joblist request\ncti.store.variables.jobListHeaders = window.appManager.newHeaderData();\n\n// Fetch the current jobList from the store to send back to AccuServ\ncti.store.payloads.jobList = window.accuServFunctions.fnMapExportJobList(cti.store.jobs.jobList);\n\n$success();"},"_auto_id_":"27c82a06-b84f-4c0b-a744-6d73e6cfd9ef","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"joblist","params":{"applicationkey":"{{$store.variables.jobListHeaders.applicationkey}}","authtoken":"{{$store.variables.jobListHeaders.authtoken}}","messageid":"{{$store.variables.jobListHeaders.messageid}}","messagedate":"{{$store.variables.jobListHeaders.messagedate}}","data":"{{$store.payloads.jobList}}"}},"_auto_id_":"804d5a80-57d5-415f-832c-c543bcf98740","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* JobList Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success \n      \"sStatus\": \"\", -- Success message\n      \"dAssignedDate\": \"\", -- Date jobs were assigned to the operative\n      \"aAccuServJobsSummaryList\": [], -- Job summary list\n      \"messageid\": \"\" -- Unique message ID supplied from API\n    }\n*/\n\n// Sort function\nfunction compare(a,b) {\n  if (a.iDisplayOrder > b.iDisplayOrder) return 1;\n  if (a.iDisplayOrder < b.iDisplayOrder) return -1;\n  return 0;\n}\n\n// On the fly HTTP request to get the lat/long from address supplied\nfunction httpGetLatLong(theUrl, callback) {\n  var geocodeRequest = new XMLHttpRequest();\n  geocodeRequest.onreadystatechange = function() { \n    if (geocodeRequest.readyState == 4 && geocodeRequest.status == 200)\n      callback(geocodeRequest.responseText);\n  }\n  geocodeRequest.open(\"GET\", theUrl, true);\n  geocodeRequest.send(null);\n}\n\n// Fetchs the array index of a job from the jobList\nfunction findSummaryEntry(jobid, jobList) {\n  for (var k in jobList) {\n    var thisJob = jobList[k];\n    if (thisJob.aAccuServJobID.iJobEventNoKey == jobid) {\n      return k;\n    }\n  }\n  return undefined;\n}\n\n// Grab response\nvar resp = cti.store.api.AccuServ.joblist;\n\n// TODO Compare for entries in API resp jobList vs jobs.jobList\n// 1 If jobs.jobList is currently empty, no comparison to do\n// 2 If a job exists in jobs.jobList but not in resp.jobList we have lost a job. Inform the user that a job has been removed\n// 3 Overwrite jobs.jobList\n// 4 Clear the API results\n\n// Check response for failure \n// Proceed to JobList page if errorCode returns 0\nif(resp.bSuccess) {\n  var currentJobDetails = cti.store.jobs.jobDetails;\n  var jobListResponse = JSON.parse(JSON.stringify(resp.aAccuServJobsSummaryList));\n  cti.store.jobs.jobList = jobListResponse;\n\n  cti.store.jobs.mapLocations = [];\n  cti.store.jobs.jobListShort = [];\n\n  var jobListShort = cti.store.jobs.jobListShort;\n  var jobListOnDevice = cti.store.jobs.jobList;\n  \n  jobListResponse.sort(compare);\n  \n  for(var i in jobListOnDevice) {\n    var thisJob = jobListOnDevice[i];\n    var geocodeApi = \"https://maps.googleapis.com/maps/api/geocode/json?address=\" + thisJob.sPostcode + \"&key=AIzaSyD7SEAfX-pd_mRgCJW6LHYWBlmwVMBVBF0\";\n    var date = moment(jobListOnDevice[i].dAttendOnDate);\n    var index;\n\n    thisJob.sDay = date.format('Do');\n    thisJob.sMonth = date.format('MMM');\n\n    httpGetLatLong(geocodeApi, function(response) {\n      // On success response push results into a store array\n      var resp = JSON.parse(response);\n      var latlong = resp.results[0].geometry.location;\n\n      cti.store.jobs.mapLocations.push(latlong);\n    });\n\n    if(i == \"0\" || i == \"1\") {\n      jobListShort.push(thisJob);\n    }\n\n    if(thisJob.sProblemDetail.length >= 50) {\n      thisJob.sProblemDetailDisplay = thisJob.sProblemDetail.substring(0,50) + \"...\";\n    } else {\n      thisJob.sProblemDetailDisplay = thisJob.sProblemDetail;\n    }\n  }\n  \n  for (var k in currentJobDetails) {\n    var thisJob = currentJobDetails[k];\n    var summaryIndex = findSummaryEntry(thisJob.aAccuServJobID.iJobEventNoKey, jobListOnDevice);\n    if (summaryIndex === undefined) {\n      currentJobDetails.splice(k, 1);\n    }\n  }\n\n  if(cti.store.variables.reSyncJobListAuto) {\n    cti.store.variables.reSyncJobListAuto = undefined;\n  } else {\n    cti.store.variables.reSyncJobList = false;\n    // Navigate to the Job List page\n    cti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n  }\n\n  // Check to see if we have any jobs, and if so call the GetJobDetailOffline workflow\n  if(jobListOnDevice.length > 0) {\n    cti.store.variables.showFullJobs = false;\n    cti.store.jobs.retrieveJobRetry = 10;\n  } else {\n    cti.store.variables.showFullJobs = undefined;\n  } \n} else {\n  cti.store.variables.reSyncJobListAuto = undefined;\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Error Retrieving Job List\",\n      \"text\" : resp.sStatus || \"A problem occured when trying to retrieve the Job List\"\n    }\n  );\n  cti.store.variables.showFullJobs = undefined;\n}\n\n// Delete jobListHeaders payload object\ndelete cti.store.variables.jobListHeaders;\n\n// Delete API response package\ndelete cti.store.api.AccuServ.joblist;\n\n// Close spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"6820bdd0-5d94-4ef5-a2b8-45cf5831e0ab","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"item-type\": \"app-notification\",\n    \"style\": \"error\",\n    \"title\": \"Job List Request to API Failed\",\n    \"text\": \"The request to fetch the Job List failed to reach the server. Please contact support\"\n  }\n);\n\n// Delete jobListHeaders payload object\ndelete cti.store.variables.jobListHeaders;\n\nif(cti.store.variables.reSyncJobListAuto) {\n  cti.store.variables.reSyncJobListAuto = undefined;\n} else {\n  // Navigate to the Job List page\n  cti.utils.callAction('go-to-page', { \"name\": \"JobList\" });\n}\n\n// Close Spinner\ncti.fnCloseSpinner(1500);"},"_auto_id_":"f43a6587-7fff-4eab-8401-6cc3ce7fda0a","actions":[]}]}]}],"name":"GetJobList"},{"content":[{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* VanStock API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateVanStock) {\n  // Fetch the vanStockHeaders to supply to the vanstock request\n  cti.store.variables.vanStockHeaders = window.appManager.newHeaderData();\n  $success();\n} "},"_auto_id_":"7645de48-37aa-4316-8900-2c030cd1b6f0","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"vanstock","params":{"applicationkey":"{{$store.variables.vanStockHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.vanStockHeaders.authtoken}}","messagedate":"{{$store.variables.vanStockHeaders.messagedate}}","messageid":"{{$store.variables.vanStockHeaders.messageid}}"}},"_auto_id_":"2e474b71-3b41-458e-9901-824b1f851326","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* VanStock Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aOperativeVanStock\": [] -- Array of operative van stock\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.vanstock;\n\n// Check response for failure \n// Notify user with popup warning if the Van Stock failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(resp.bSuccess) {\n  cti.store.staticData.updateStatus.updateVanStock = false;\n} else {\n  cti.store.staticData.updateStatus.updateVanStock = false;\n  window.appManager.logEvent('Failed to retrieve Van Stock. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;"},"_auto_id_":"e2fd36fa-e4e1-4f33-bab7-71deac95ffea"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"cti.store.staticData.updateStatus.updateVanStock = true;\nwindow.appManager.logEvent('Failed to retrieve Van Stock data (API connection).', 'warning');\n\n// Delete vanStockHeaders payload object\ndelete cti.store.variables.vanStockHeaders;"},"_auto_id_":"ea554dbb-562c-49fb-bfb6-2421943f134b"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* OrderCatalogue API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateCatalogue) {\n  // Fetch the otcHeaders to supply to the catalogue request\n  cti.store.variables.otcHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"38f77219-781a-4aaa-9b4c-37f879b47107","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"ordercatalogue","params":{"applicationkey":"{{$store.variables.otcHeaders.applicationkey}}","messageid":"{{$store.variables.otcHeaders.messageid}}","messagedate":"{{$store.variables.otcHeaders.messagedate}}","authtoken":"{{$store.variables.otcHeaders.authtoken}}"}},"_auto_id_":"eb317a5d-1784-4575-9ff5-ba142af01db1","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* ordercatalogue Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aStockItemsFull\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar response = cti.store.offlineApi.AccuServOffline.ordercatalogue;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(response.bSuccess) {\n  // On success add the OTC data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"otcdatafull\", \n    response.aStockItemsFull, function(rev) {\n      // OTC data stored successfully\n      window.appManager.logEvent('Saved OTC Stock data, revision: ' + rev);\n      delete cti.store.offlineApi.AccuServOffline.ordercatalogue;\n      $success();\n    }, function(reason, e) {\n      // Failed to store, but makes no difference to workflow\n      delete cti.store.offlineApi.AccuServOffline.ordercatalogue;\n      window.appManager.logError('Failed to save OTC Stock data - ' + reason, e);\n      $success();\n  });\n\n  cti.store.staticData.updateStatus.updateCatalogue = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve OTC data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;"},"_auto_id_":"87a33868-b70a-4dee-8ea3-df8833050e49","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve OTC data (API connection).', 'warning');\n\n// Delete otcHeaders payload object\ndelete cti.store.variables.otcHeaders;"},"_auto_id_":"d334328a-fe2b-40f7-8a57-10de01a6c9fb"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* JobLocations API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateJobLocations) {\n  // Fetch the jobLocationsHeaders to supply to the vanstock request\n  cti.store.variables.jobLocationsHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"2614727a-7a45-4f11-aed7-332600516c7b","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"joblocations","params":{"applicationkey":"{{$store.variables.jobLocationsHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.jobLocationsHeaders.authtoken}}","messagedate":"{{$store.variables.jobLocationsHeaders.messagedate}}","messageid":"{{$store.variables.jobLocationsHeaders.messageid}}"}},"_auto_id_":"7c0599a6-0c82-4900-bb97-73dc143b9b0c","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* joblocations Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"aJobLocationDetail\": [],\n      \"messageid\": \"\"\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.joblocations;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var jobLocationsObj = JSON.parse(JSON.stringify(resp.aJobLocationDetail));\n  cti.store.staticData.jobLocations = jobLocationsObj;\n  cti.store.staticData.updateStatus.updateJobLocations = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Locations static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete jobLocationsHeaders payload object\ndelete cti.store.variables.jobLocationsHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.joblocations;"},"_auto_id_":"c9ce75ec-ddb3-4aef-818f-d84b7e29f7d9"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Locations static data (API connection).', 'warning');\n\ndelete cti.store.variables.jobLocationsHeaders;"},"_auto_id_":"342ff11d-82ac-4d66-95a1-85e92e887c9d"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* TradesList API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateTrades) {\n  // Fetch the tradesListHeaders to supply to the vanstock request\n  cti.store.variables.tradesListHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"01bb8541-e2c1-4c4c-929c-237b0212742e","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"tradeslist","params":{"applicationkey":"{{$store.variables.tradesListHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.tradesListHeaders.authtoken}}","messagedate":"{{$store.variables.tradesListHeaders.messagedate}}","messageid":"{{$store.variables.tradesListHeaders.messageid}}"}},"_auto_id_":"3528ec43-ea1d-4c1f-b176-9081d4be6e38","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* tradeslist Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"sStatus\": string\n      \"aAccuServTrades\": array,\n      \"messageid\": string\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.tradeslist;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var tradesList = JSON.parse(JSON.stringify(resp.aAccuServTrades));\n  \n  cti.store.staticData.tradesList = tradesList;\n  cti.store.staticData.updateStatus.updateTrades = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Trades List static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete tradesListHeaders payload object\ndelete cti.store.variables.tradesListHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.tradeslist;"},"_auto_id_":"e953fd3f-f881-4698-8632-dde042b074b1"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Locations static data (API connection).', 'warning');\n\ndelete cti.store.variables.tradesListHeaders;"},"_auto_id_":"733e41f7-489c-402a-b27f-c8f784ad6cb9"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* ResultSummaries API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateSummaries) {\n  // Fetch the resultSummaryHeaders to supply to the vanstock request\n  cti.store.variables.resultSummaryHeaders = window.appManager.newHeaderData();\n  $success();\n}"},"_auto_id_":"0c47332f-79e1-48a1-9484-e6233fba89ce","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"resultsummaries","params":{"applicationkey":"{{$store.variables.resultSummaryHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.resultSummaryHeaders.authtoken}}","messagedate":"{{$store.variables.resultSummaryHeaders.messagedate}}","messageid":"{{$store.variables.resultSummaryHeaders.messageid}}"}},"_auto_id_":"7bb94064-ead1-46f5-8b37-3020951113df","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* resultsummaries Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"sStatus\": string\n      \"aAccuServResultSummaries\": array,\n      \"messageid\": string\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.resultsummaries;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var resultSummaries = JSON.parse(JSON.stringify(resp.aAccuServResultSummaries));\n  \n  if(resultSummaries.length > 0) {\n    for(var i in resultSummaries) {\n      if(resultSummaries[i].sResultSummary == \"ABANDON JOB\") {\n        cti.store.staticData.abandonJobList = resultSummaries[i].aAccuServSubResultSummary;\n      }\n      if(resultSummaries[i].sResultSummary == \"NO ACCESS\") {\n        cti.store.staticData.noAccessList = resultSummaries[i].aAccuServSubResultSummary;\n      }\n      if(resultSummaries[i].sResultSummary == \"FOLLOW ON REQUIRED\") {\n        cti.store.staticData.followOnList = resultSummaries[i].aAccuServSubResultSummary;\n      }\n    }\n  } else {\n    if(cti.store.staticData.abandonJobList === undefined) {\n      cti.store.staticData.abandonJobList = [\n        {\"sSubResultSummary\":\"ABUSIVE/VIOLENT TENANT\"},\n        {\"sSubResultSummary\":\"FAILED RISK ASSESSMENT\"},\n        {\"sSubResultSummary\":\"MINORS ONLY IN PROPERTY - NO ADULTS\"},\n        {\"sSubResultSummary\":\"UNSAFE ENVIRONMENT\"},\n        {\"sSubResultSummary\":\"WRONG TRADE\"}\n      ];\n    }\n    if(cti.store.staticData.noAccessList === undefined) {\n      cti.store.staticData.noAccessList = [\n        {\"sSubResultSummary\":\"DEMOLISHED PROPERTY\"},\n        {\"sSubResultSummary\":\"NO ANSWER AT DOOR\"},\n        {\"sSubResultSummary\":\"TENANT REFUSED ENTRY\"}\n      ];\n    }\n    if(cti.store.staticData.followOnList === undefined) {\n      cti.store.staticData.followOnList = [\n        {\"sSubResultSummary\":\"FURTHER VISIT (ME)\"},\n        {\"sSubResultSummary\":\"FURTHER VISIT (OTHER)\"},\n        {\"sSubResultSummary\":\"MATERIALS REQUIRED\"},\n        {\"sSubResultSummary\":\"OTHER TRADE REQUIRED\"},\n        {\"sSubResultSummary\":\"TENANT STOP WORK REQUEST\"}\n      ];\n    }\n  }\n  \n  cti.store.staticData.updateStatus.updateSummaries = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Result Summaries static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete resultSummaryHeaders payload object\ndelete cti.store.variables.resultSummaryHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.resultsummaries;"},"_auto_id_":"93626ca5-1c2d-452e-bae0-4c39cead14ab"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Result Summaries static data (API connection).', 'warning');\n\ndelete cti.store.variables.resultSummaryHeaders;"},"_auto_id_":"0d2a7fe0-37e8-4ddd-b468-acdb98f7b439"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* SupplierList API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateSupplier) {\n  // Fetch the stockSuppliersHeaders to supply to the vanstock request\n  cti.store.variables.stockSuppliersHeaders = window.appManager.newHeaderData();\n  $success(true);\n}"},"_auto_id_":"ab23c551-87f4-4de0-9348-7a350cc4bb51","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"stocksuppliers","params":{"applicationkey":"{{$store.variables.stockSuppliersHeaders.applicationkey}}","token":"{{$store.currentProfile.token}}","authtoken":"{{$store.variables.stockSuppliersHeaders.authtoken}}","messagedate":"{{$store.variables.stockSuppliersHeaders.messagedate}}","messageid":"{{$store.variables.stockSuppliersHeaders.messageid}}"}},"_auto_id_":"fbefb600-2a40-4f54-a4ea-3cecc53b533b","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* stocksuppliers Endpoint - Returns:\n    {\n      \"bSuccess\": true,\n      \"sStatus\": string\n      \"aSupplierDetail\": array,\n      \"messageid\": string\n    }\n*/\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.stocksuppliers;\n\n// Check response for failure \nif(resp.bSuccess) {\n  var stockSuppliers = JSON.parse(JSON.stringify(resp.aSupplierDetail));\n  cti.store.staticData.stockSuppliers = stockSuppliers;\n  cti.store.staticData.updateStatus.updateSupplier = false;\n} else {\n  window.appManager.logEvent('Failed to retrieve Stock Suppliers static data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete stockSuppliersHeaders payload object\ndelete cti.store.variables.stockSuppliersHeaders;\n\n// Delete API response\ndelete cti.store.offlineApi.AccuServOffline.stocksuppliers;"},"_auto_id_":"81e67481-0311-4a70-adc7-1448594d2dc2"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve Result Summaries static data (API connection).', 'warning');\n\ndelete cti.store.variables.resultSummaryHeaders;"},"_auto_id_":"8ba8ee01-637a-4b17-86e4-a96502dc635c"}]}]},{"event":"click","type":"inline-function","data":{"sync":false,"code":"/* SORCode API Request Package Function */\n\nif(cti.store.staticData.updateStatus.updateSORCodes) {\n  // Fetch the sorHeaders to supply to the sordata request\n  cti.store.variables.sorHeaders = window.appManager.newHeaderData();\n  $success(true);\n}"},"_auto_id_":"9688ddd7-f068-4355-adf5-2feb943a34d9","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"sordata","params":{"applicationkey":"{{$store.variables.sorHeaders.applicationkey}}","messageid":"{{$store.variables.sorHeaders.messageid}}","messagedate":"{{$store.variables.sorHeaders.messagedate}}","authtoken":"{{$store.variables.sorHeaders.authtoken}}"}},"_auto_id_":"828033e3-bbdc-4a8a-a911-99b6a40e7643","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* SORCodes Endpoint - Returns:\n    {\n      \"bSuccess\": true, -- True or false returned on success\n      \"sStatus\": \"\", -- Success message\n      \"aSORCodesDetail\": [] -- Array of SOR Codes\n    }\n*/\n\n// Grab response\nvar response = cti.store.offlineApi.AccuServOffline.sordata;\n\n// Check response for failure \n// Notify user with popup warning if the SOR Codes failed to be retrieved\n// Will retry with a TTL of 60 minutes\nif(response.bSuccess) {\n  // On success add the SOR data to new Pouch DB instance\n  window.appManager.saveToDatabase(\n    \"sordata\", \n    response.aSORCodesDetail, function(rev) {\n      // SOR data stored successfully\n      window.appManager.logEvent('Saved SOR data, revision: ' + rev);\n      delete cti.store.offlineApi.AccuServOffline.sordata;\n      cti.store.staticData.updateStatus.updateSORCodes = false;\n      $success();\n    }, function(reason, e) {\n      // Failed to store, but makes no difference to workflow\n      delete cti.store.offlineApi.AccuServOffline.sordata;\n      window.appManager.logError('Failed to save SOR data - ' + reason, e);\n      $success();\n    });\n} else {\n  window.appManager.logEvent('Failed to retrieve SOR data. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;"},"_auto_id_":"cd4c2642-c762-464e-be0c-03a5f17e0b97","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"window.appManager.logEvent('Failed to retrieve SOR data (API connection).', 'warning');\n\n// Delete sorHeaders payload object\ndelete cti.store.variables.sorHeaders;"},"_auto_id_":"7102cc22-6125-4022-8619-bd78c6bfcb00"}]}]}],"name":"StaticData"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* StartOfDay API Request Package Function */\n\n// Fetch the startOfDayHeaders to supply to the startofday request\ncti.store.variables.startOfDayHeaders = window.appManager.newHeaderData();\n\n// Form the start of day request payload. Done inline here because it's the only place we need it\nvar tyresCheckOk= false,\n    oilCheckOk = false,\n    waterCheckOk = false,\n    lightsCheckOk = false,\n    rdoDrivingCheck = false;\n\ncti.store.pages.VehicleChecks.tyresCheckOk == \"1\" ? tyresCheckOk = true : tyresCheckOk = false;\ncti.store.pages.VehicleChecks.oilCheckOk == \"1\" ? oilCheckOk = true : oilCheckOk = false;\ncti.store.pages.VehicleChecks.waterCheckOk == \"1\" ? waterCheckOk = true : waterCheckOk = false;\ncti.store.pages.VehicleChecks.lightsCheckOk == \"1\" ? lightsCheckOk = true : lightsCheckOk = false;\ncti.store.pages.VehicleChecks.rdoDrivingCheck == \"1\" ? rdoDrivingCheck = true : rdoDrivingCheck = false;\n\nif(rdoDrivingCheck) {\n  cti.store.payloads.startOfDay = {\n    \"sOperativeID\": cti.store.currentProfile.username,\n    \"sVanReg\": cti.store.pages.VehicleChecks.vehicleRegistration,\n    \"nVanMileage\": cti.store.pages.VehicleChecks.vehicleOdometer,\n    \"bTyresOK\": tyresCheckOk,\n    \"bOilOK\": oilCheckOk,\n    \"bWaterOk\": waterCheckOk,\n    \"bLightsOk\": lightsCheckOk,\n    \"bDrivingToday\": true\n  }\n} else {\n  cti.store.payloads.startOfDay = {\n    \"sOperativeID\": cti.store.currentProfile.username,\n    \"sVanReg\": cti.store.pages.VehicleChecks.vehicleRegistration,\n    \"bDrivingToday\": false\n  }\n}\n\n$success();"},"_auto_id_":"30666bcc-5200-4b83-9dd0-624130666201","actions":[{"event":"success","type":"call-offline-api","data":{"name":"AccuServOffline","operation":"startofday","params":{"applicationkey":"{{$store.variables.startOfDayHeaders.applicationkey}}","authtoken":"{{$store.variables.startOfDayHeaders.authtoken}}","messageid":"{{$store.variables.startOfDayHeaders.messageid}}","messagedate":"{{$store.variables.startOfDayHeaders.messagedate}}","data":"{{$store.payloads.startOfDay}}"}},"_auto_id_":"b056bc5f-d877-4698-a26c-86f60254c9a9","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* StartOfDay API Success Response */\n\n// Grab response\nvar resp = cti.store.offlineApi.AccuServOffline.startofday;\n\n// Check response for failure \n// Notify user with popup warning if the Start of Day failed to send\n// Will retry with a TTL of 60 minutes\nif(!resp.bSuccess) {\n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\" : \"api_response_error\",\n      \"item-type\" : \"app-notification\",\n      \"style\" : \"error\",\n      \"title\" : \"Start of Day Checks Failed to Send\",\n      \"text\" : resp.sStatus || \"A problem occurred when trying to send Start of Day checks\"\n    }\n  );\n  window.appManager.logEvent('Problem submitting start of day checks: ' + resp.sStatus, 'warning');\n}\n\n// Delete startOfDayHeaders payload object\ndelete cti.store.variables.startOfDayHeaders;"},"_auto_id_":"43a7c794-94db-4e35-bafb-0203a423472e","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* StartOfDay API Fail Response */\n\n// Delete startOfDayHeaders payload object\ndelete cti.store.variables.startOfDayHeaders;\n\n// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Failed to submit Start of Day\",\n    \"text\": \"We couldn't reach the AccuServ server to supply your Start of Day checks. Please contact support\"\n  }\n);\nwindow.appManager.logEvent('Failed to submit start of day request (API connection).', 'error');\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"94c160ef-9eff-483c-8d20-3d21fbcbff16","actions":[]}]}]}],"name":"StartOfDay"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Initialise API Request Package Function */\n\n// Fetch the initialiseHeaders to supply to the initialise request\ncti.store.variables.initialiseHeaders = window.appManager.newHeaderData();\n\n$success();"},"_auto_id_":"d266ec9c-4f53-434a-8a22-3062883c0d4b","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"initialise","params":{"messageid":"{{$store.variables.initialiseHeaders.messageid}}","applicationkey":"{{$store.variables.initialiseHeaders.applicationkey}}","messagedate":"{{$store.variables.initialiseHeaders.messagedate}}","authtoken":"{{$store.variables.initialiseHeaders.authtoken}}"}},"_auto_id_":"ba21dbf3-b9c7-49de-8a27-e5ab4e40f93b","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Initialise API Success Response */\n\n// Grab response\nvar resp = cti.store.api.AccuServ.initialise;\n\n// Check response for failure \n// Proceed through workflow to VehicleChecks if errorCode returns 0\nif(resp.bSuccess) {\n  // Set StaticData update booleans\n  cti.store.staticData.updateStatus = {};\n  cti.store.staticData.updateStatus.updateSORCodes = resp.bSORDownloadRequired;\n  cti.store.staticData.updateStatus.updateVanStock = resp.bVanDownloadRequired;\n  cti.store.staticData.updateStatus.updateSupplier = resp.bSuppliersDownLoadRequired;\n  cti.store.staticData.updateStatus.updateJobLocations = resp.bJobLocationsRequired;\n  cti.store.staticData.updateStatus.updateCatalogue = resp.bCatalogDownLoadRequired;\n\n  cti.utils.callAction('go-to-page', { \"name\": \"VehicleChecks\" });\n} else {\n  // Set StaticData update booleans\n  cti.store.staticData.updateStatus = {};\n  cti.store.staticData.updateStatus.updateSORCodes = true;\n  cti.store.staticData.updateStatus.updateVanStock = true;\n  cti.store.staticData.updateStatus.updateSupplier = true;\n  cti.store.staticData.updateStatus.updateJobLocations = true;\n  cti.store.staticData.updateStatus.updateCatalogue = true;\n  \n  // Notify operative that the request failed \n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Initialisation failed\",\n      \"text\": resp.sStatus || \"AccuServ was unable to Initialise your Start of Day. Please contact support.\"\n    }\n  );\n  \n  cti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\n  cti.utils.callAction('call-actionflow', { \"name\": \"StartOfDay\" });\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n  \n  window.appManager.logEvent('Failed response from initialisation request. ' + (resp.sStatus || ''), 'warning');\n}\n\n// Store away Vehicle and stock specific data for future use\ncti.store.pages.VehicleChecks.vehicleRegistration = resp.sVanReg;\ncti.store.pages.VehicleChecks.vehicleOdometer = resp.nlastRecordedMileage;\ncti.store.currentProfile.managerTelephone = resp.sLineManagerMobile;\ncti.store.currentProfile.managerName = resp.sLineManager;\n\n// TODO - Dynamically driven\ncti.store.staticData.vehicleMileageMaxEntry = resp.nVehicleMileageMaxEntry || 1000;\n\ncti.store.staticData.updateStatus.updateSummaries = true;\ncti.store.staticData.updateStatus.updateTrades = true;\n\n// Delete initialiseHeaders payload object\ndelete cti.store.variables.initialiseHeaders;\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"07b92e0e-aa25-434a-9f29-3a99c449ebcd"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* Initialise API Fail Response */\n\n// Delete initialiseHeaders payload object\ndelete cti.store.variables.initialiseHeaders;\n\n// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Initialisation failed\",\n    \"text\": \"We couldn't reach the AccuServ server to get your information. Please contact support\"\n  }\n);\nwindow.appManager.logEvent('Failed to process initialisation request (API connection).', 'error');\n\n// Close spinner\ncti.fnCloseSpinner();"},"_auto_id_":"f767439a-78c7-4321-acd4-de2d02462756"}]}]}],"name":"Initialise"},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"/* Login API Request Package Function */\nvar settings = true;\n\nif(cti.store.pages.AppSettings === undefined || cti.store.pages.AppSettings.accuservAPIAddress === undefined || cti.store.pages.AppSettings.accuservAPIAddress == '') {\n  if(cti.store.schema.metadata.accuservurl === undefined) {\n    // Notify operative that API not configured\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\": \"api_failure_error\",\n        \"title\": \"Configuration Needed\",\n        \"text\": \"The app is not configured to communicate with AccuServ. Please do this in Settings (consult support if required).\"\n      }\n    );\n\n    settings = false;\n  } else {\n    if(cti.store.pages.AppSettings == undefined) {\n      cti.store.pages.AppSettings = {};\n    }\n    \n    cti.store.pages.AppSettings.accuservAPIAddress = cti.store.schema.metadata.accuservurl;\n  }\n}\n\nif(settings) {\n  // Load Spinner\n  cti.fnOpenSpinner('Attempting to log in...');\n\n  // Fetch the loginHeaders to supply to the login request\n  cti.store.variables.loginHeaders = window.appManager.newHeaderData();\n\n  // Check and defined the payloads store\n  if(cti.store.payloads == undefined) cti.store.payloads = {};\n\n  // Create a login payload of the username and password to send to the login request\n  cti.store.payloads.login = {\n    \"username\": cti.store.pages.Login.Username,\n    \"password\": cti.store.pages.Login.Password\n  };\n\n  $success();\n}"},"_auto_id_":"6df841a4-159b-476e-8cba-91ccd46dc791","actions":[{"event":"success","type":"call-api","data":{"sync":true,"name":"AccuServ","operation":"login","params":{"data":"{{$store.payloads.login}}","applicationkey":"{{$store.variables.loginHeaders.applicationkey}}","messageid":"{{$store.variables.loginHeaders.messageid}}","messagedate":"{{$store.variables.loginHeaders.messagedate}}"}},"_auto_id_":"45854b79-3996-4381-a8cc-7e5d343b065d","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"/* Login API Success Response Function */\n\n// Create link to API for Google Maps\nvar google = document.getElementById('google');\n\n// Check if we haven't already added the script tag\nif(google == undefined) {\n  window.appManager.logEvent('Google Maps API not loaded,  initialising...', 'info');\n  var googleMaps = document.createElement('script');\n  googleMaps.id = 'google';\n  googleMaps.src = 'https://maps.googleapis.com/maps/api/js?key=' + cti.store.schema.metadata.googleapikey;\n  document.body.appendChild(googleMaps);\n  window.appManager.logEvent('Google Maps API initialised successfully.', 'info');\n} else {\n  window.appManager.logEvent('Google Maps API initialised', 'info');\n}\n\n// Hide variable set to hide elements not wanted yet in this version: Example vehicle reg\ncti.store.hide = false;\n\n// Just encoded at the mo, but we'll ultimately use an encrypted hash for an offline login check later. We'll only store this if the login succeeds\nvar username = cti.store.pages.Login.Username.toLowerCase();\nvar credentialHash = btoa(username + '==' + cti.store.pages.Login.Password);\nvar dt = new Date();\n\n// Make certain the password is cleared\ndelete cti.store.pages.Login.Password;\n\n// Grab the result so we can check if our login request was actually accepted\n// We'll put it in a holding object so we can delete the API store response\nvar loginResult = {\n  \"errorCode\": cti.store.api.AccuServ.login.errorCode,\n  \"errorMessage\": cti.store.api.AccuServ.login.errorMessage,\n  \"token\": cti.store.api.AccuServ.login.token,\n  \"startOfDayRequired\": cti.store.api.AccuServ.login.startOfDayRequired,\n  \"expiresIn\": cti.store.api.AccuServ.login.expiresIn,\n  \"jobsRequired\": cti.store.api.AccuServ.login.jobsRequired,\n  \"messageid\": cti.store.api.AccuServ.login.messageid,\n  \"maxLoginDuration\": cti.store.api.AccuServ.login.maxLoginDuration || (60 * 14)\n}\n\n// Delete API store response for Login\ndelete cti.store.api.AccuServ.login;\n\n// Check response for failure \n//\n// Proceed through workflow to Initialise if errorCode returns 0 \n// and startOfDayRequired == true\n// Proceed straight to JobList otherwise\nif(loginResult.errorCode == 0) {\n  window.accuServFunctions.fnInitialiseModel();\n  cti.store.variables.successLogin = true;\n \n  // Is the user the same as the last logged in user?\n  if(cti.store.lastLogin !== undefined) {\n    // Different user - van stock is redundant\n    if(username != cti.store.lastLogin.username) {\n      window.appManager.logEvent('Different user logging in: ' + username, 'info');\n      delete cti.store.offlineApi.AccuServOffline.vanstock;\n      delete cti.store.staticData.vanStockLastRetrievedDate;\n    }\n    else if (window.appManager.areDatesEqual(cti.store.lastLogin.dateTime, dt)) {\n      window.appManager.logEvent('Logging back in: ' + username, 'info');\n      var previousUser = true;\n    }\n    else {\n      window.appManager.logEvent('First login today: ' + username, 'info');\n    }\n  }\n  else  {\n    window.appManager.logEvent('New user logging in: ' + username, 'info');\n  }\n\n  // Store the user as the last user to login\n  cti.store.lastLogin = {\n    \"userHash\": credentialHash,\n    \"username\": username,\n    \"dateTime\": dt\n  };\n  \n  // PW I've pre-emptively supported the ability for the login method to tell us the maximum length of our\n  // session, during which we may keep re-acquiring a token to keep the session running. Once we reach this\n  // threshhold (maxLoginDuration; defaults to 14 hours from login), the user must fully login again.\n  var maxLoginDurationExpiry = new Date();\n  maxLoginDurationExpiry.setMinutes(maxLoginDurationExpiry.getMinutes() + loginResult.maxLoginDuration);\n\n  // Create a current profile for the user\n  cti.store.currentProfile = {\n    \"username\": username,\n    \"token\": loginResult.token,\n    \"dateTime\": dt,\n    \"maxLoginDurationExpiry\": maxLoginDurationExpiry,\n    \"jobsRequired\": loginResult.jobsRequired\n  };\n  \n  window.accuServFunctions.fnUpdateAuthToken(loginResult.token, loginResult.expiresIn);\n\n  if(loginResult.startOfDayRequired) {\n    window.accuServFunctions.fnDataDestroy();\n    cti.utils.callAction('call-actionflow', { \"name\": \"Initialise\" });\n  } else {\n    if(cti.store.staticData.updateStatus === undefined) {\n      cti.store.staticData.updateStatus = {\n        \"updateSORCodes\": true,\n        \"updateVanStock\": true,\n        \"updateSupplier\": true,\n        \"updateJobLocations\": true,\n        \"updateCatalogue\": true,\n        \"updateSummaries\" : true,\n        \"updateTrades\" : true\n      }\n    } else {\n      cti.store.staticData.updateStatus.updateSummaries = true;\n      cti.store.staticData.updateStatus.updateTrades = true;\n    } \n    \n    if(previousUser) {\n      if(cti.store.variables.timedOut) {\n        cti.store.variables.timedOut = false;\n        cti.utils.callAction('go-to-page', { \"name\": cti.store.variables.lastPage });\n      } else {\n        cti.fnCloseSpinner();\n        cti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\n        cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n      }\n    } else {\n      cti.fnCloseSpinner();\n      cti.utils.callAction('call-actionflow', { \"name\": \"StaticData\" });\n      cti.utils.callAction('call-actionflow', { \"name\": \"GetJobList\" });\n    }\n  }\n} else {\n  // We have failed to login, display returned error message\n  cti.utils.callAction(\n    \"show-notification\", {\n      \"name\": \"api_response_error\",\n      \"title\": \"Login Failed\",\n      \"text\": loginResult.errorMessage || \"Please provide a valid Username and Password\"\n    }\n  );\n}\n\n// Delete loginHeaders payload object\ndelete cti.store.variables.loginHeaders;\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"4034f103-27c7-44bd-969a-9916f07ec492","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"/* Login API Fail Response Function */\n\n// Make certain the password is cleared\ndelete cti.store.pages.Login.Password;\n\n// TODO Depending on the nature of the failure, we can allow the user to log in using cached credentials\n\n// Delete loginHeaders payload object\ndelete cti.store.variables.loginHeaders;\n\n// Notify operative that the request failed \ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_failure_error\",\n    \"title\": \"Login failed\",\n    \"text\": \"We couldn't reach the AccuServ server to log you in. Please contact support\"\n  }\n);\n\nwindow.appManager.logEvent('Failed to process login request (API connection).', 'error');\n\n// Close Spinner\ncti.fnCloseSpinner();"},"_auto_id_":"71161c91-2c2c-43c8-b041-8827f9904307","actions":[]}]}]}],"name":"Login"}],"dataflows":[],"config":[{"name":"Moment","type":"scripting","item-type":"js-asset","_auto_id_":"71d0d5ba-66f3-4f18-92d7-8dccfe84a1ba","fileName":"moment.js"},{"name":"cp12_module","type":"scripting","item-type":"js-asset","_auto_id_":"fd06a0e0-3869-4790-801c-7049ad54ed70","fileName":"cp12.js"},{"name":"cp12_skate","type":"scripting","item-type":"js-asset","_auto_id_":"75b0cd41-9119-49a9-b4f8-1b2efc15ecf5","fileName":"skate.js"},{"name":"jsAppManager","type":"scripting","item-type":"js-asset","_auto_id_":"72b58305-d80b-4bc9-8742-5e21e266b5b2","fileName":"appManager.js"},{"name":"jsAccuServFunctions","type":"scripting","item-type":"js-asset","_auto_id_":"b194d421-fa6b-4157-9ec7-d8f585b9d6c6","fileName":"accuServGlobalFunctions.js"},{"name":"cp12_theme","type":"style","item-type":"css-asset","_auto_id_":"097ab3fb-b0db-472a-a305-47388276c8e1","fileName":"cp12-theme.css"},{"name":"cssMain","type":"style","item-type":"css","_auto_id_":"100b2d38-f561-4781-9daa-6e380e66b65f","content":"#CP12 section.scrollable-item {\n    padding: 0px;\n}\nsection.scrollable-item {\n    overflow-y: auto;\n}\n.md-list .scrollable {\n    overflow-y: hidden;\n}\n\n.h3-header { \n  text-align: center; \n}\n\n.p-text { \n  text-align: center; \n}\n\n.btn.disabled, .btn[disabled], fieldset[disabled] .btn {\n  pointer-events: none;\n  cursor: not-allowed;\n  filter: alpha(opacity=25);\n  -webkit-box-shadow: none;\n  box-shadow: none;\n  opacity: 0.25;\n  color: black;\n}\n.required-asterix.fa-star { \n  color: transparent; \n}\n\n.fa-circle-o:before, .fa-dot-circle-o:before { \n  padding-right: 2vw; \n}\n\n.has-success .form-control {\n  border-color: #8E8A87!important;\n}\n\n.flexbox-container .navbar-default.row-item:last-child { \n  background-color: #fff; \n}\n\n.form-group.item-date .input-group-addon, .form-group.item-time .input-group-addon { \n  background-color: #dc4f10!important; \n}\n\n.md-checkbox { \n  font-size:1.4em; \n}\n\ndiv.cb-bias-last > div > div > div:first-child div.md-checkbox,\ndiv.cb-bias-first > div > div > div:nth-child(2) div.md-checkbox { \n  color:green !important; \n}\n\ndiv.cb-bias-first > div > div > div:first-child div.md-checkbox,\ndiv.cb-bias-last > div > div > div:nth-child(2) div.md-checkbox { \n  color:red !important; \n}\n\n.form-input-error { \n  color: #fff; \n}\n\n#toast-container { \n  position: fixed; z-index: 999999; margin-top: 200px; \n}\n\n#toast-container>div { \n  width: 94vw!important; margin-left: 4vw; \n}\n\n.container, .container-fluid {\n  font-size: 12pt!important;\n  padding-right: 0px;\n  padding-left: 0px;\n  margin-right: 14px;\n}\n\n.signature-frame .canvas-frame { \n  width: 330px; \n  border: 2px dotted #0072C6; \n}\n\n.completeheader { \n  text-align: center; \n  color: #228B22; \n}\n\n.abandonheader { \n  text-align: center; \n  color: #ff0000; \n}\n\n.check-fail-header { \n  text-align: center; \n  color: #ff0000; \n}\n\n.complete { \n  color: #228B22; \n}\n\n.has-error .control-label { \n  color: #000; \n}\n\n/* Generic list styling */\n\nul {\n  list-style:none;\n  padding:0;\n}\n.list-item-container {\n  width: 100%;\n  min-height:30px;\n}\n.list-item-head {\n  width:98%;\n}\n.list-item-head span {\n  /*font-size:0.8em;*/\n  font-style: italic;\n  font-variant: small-caps;\n  float:right;\n}\n.list-item-detail {\n  font-size:0.8em;\n  color:darkgrey;\n}\n\n.read-more {\n  margin-top: 5px;\n  color: #0072C6;\n  font-weight: bold;\n}\n\n/* Log display */\n.log-error {\n  color:red;\n}\n.log-warning {\n  color:orange;\n}\n.log-debug {\n  color:gray;\n}\n\n.md-list>.top>.search-area .search-box { \n  max-width: 100%; \n}\n\n.centered-max {\n  width:100%;\n  text-align:center;\n}\n.centered-text {\n  text-align:center;\n}\n\n.list-display-block {\n  display:inline-block;\n  width:100%;\n}"},{"name":"cssButtons","type":"style","item-type":"css","_auto_id_":"518059d5-28a5-45f5-84b0-875b88e37ba5","content":".abandon-bar-btn, .abandon-bar-btn[disabled] {\n  background-color: #0072C6!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.deletephoto-btn {\n  background-color: #cc0000!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.button-bar-btn, .button-bar-btn[disabled] {\n  background-color: #dc4f10!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.confirm-bar-btn {\n  background-color: #0072C6!important;\n  color: #fff!important;\n  width: 40vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.login-button {\n  background-color: #dc4f10!important;\n  color: #fff!important;\n  width: 300px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n  margin-bottom: 20px;\n  margin-top: 20px;\n}\n.travel-btn {\n  display: inline-block;\n  background-color: #0072C6!important;\n  color: #fff!important;\n  margin-bottom: 3vh;\n  width: 250px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.startjob-btn {\n  display: inline-block;\n  background-color: #0072C6!important;\n  color: #fff!important;\n  margin-bottom: 3vh;\n  width: 60vw;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.startjob-btn, .startjob-btn[disabled] {\n  color: #fff!important;\n  background-color: #0072C6;\n}\n.getmethere-btn {\n  color: #fff!important;\n  background-color: #0072C6!important;\n  margin-bottom: 5vh;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.takephoto-btn {\n  color: #0072C6!important;\n  background-color: #fff!important;\n  margin-top: -50px;\n  width: 60vw;\n  height: 48px;\n  font-size: 2.2em;\n  border: none;\n}\n.selecttime-btn, .selecttime-btn[disabled] {\n  color: #fff!important;\n  background-color: #0072C6!important;\n  margin-bottom: 20px;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.bookappointment-btn {\n  color: #fff!important;\n  background-color: #0072C6!important;\n  width: 300px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.fetchtime-btn {\n  color: #fff!important;\n  background-color: #228B22!important;\n  margin-bottom: 20px;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}\n.showlist-btn {\n  color: #0072C6!important;\n  background-color: #fff!important;\n  border: none;\n  width: 200px;\n  height: 48px;\n  padding-top: 10px;\n  font-size: 1.2em;\n}"},{"name":"cssJobMap","type":"style","item-type":"css","_auto_id_":"7259638b-f10f-4155-beae-57db416fa6bc","content":"#map {\n  position: absolute;\n  left: 0;\n  top: 0;\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n}\n\n#JobMap section#scrollable {\n    position: absolute;\n    top: 520px;\n    width: 100vw;\n    /* height: 32vh; */\n    padding: 0;\n}\n\n#JobMap section#staticMap {\n    position: absolute;\n    left: 5vw;\n    top: 100px;\n    height: 400px;\n    width: 90vw;\n    padding: 0;\n}\n\n#JobMap section#scrollable div.scrollable {\n  margin: 0;\n  overflow-y: auto !important;\n}"},{"name":"cssFontAwesomeOverrides","type":"style","item-type":"css","_auto_id_":"38e67769-3928-4b44-9449-f1ba6f1f9603","content":"/* Vehicle Checks */\n.supervisor:before { content: \"\\f095\"; font-size: 30pt; }\n\n/* Jobs List */\n.high:before { content: \"\\f071\"; font-size: 20pt; }\n.med:before { content: \"\\f071\"; font-size: 20pt; }\n.low:before { content: \"\\f071\"; font-size: 20pt; }\n\n/* Tenant Details */\n.home:before { content: \"\\f095\"; font-size: 30pt; }\n.mobile:before { content: \"\\f10b\"; font-size: 32pt; }\n.booked:before { content: \"\\f271\"; font-size: 30pt; }\n\n/* Warnings */\n.checked-warning:before { content: \"\\f046\"; font-size: 20pt; }\n.unchecked-warning:before { content: \"\\f096\"; font-size: 20pt; }\n.all-checked-warning:before { content: \"\\f046\"; font-size: 20pt; }\n.all-unchecked-warning:before { content: \"\\f096\"; font-size: 20pt; }\n\n/* Start Travel */\n.getmethere:before { content: \"\\f018\"; font-size: 50pt; }\n.started-ticked:before { content: \"\\f087\"; font-size: 35pt; }\n\n/* Arrived On Site */\n.checked-lone:before { content: \"\\f046\"; font-size: 15pt; }\n.unchecked-lone:before { content: \"\\f096\"; font-size: 15pt; }\n.arrived-ticked:before { content: \"\\f087\"; font-size: 35pt; }\n\n/* Risk Assessment */\n.racomplete:before { content: \"\\f087\"; font-size: 35pt; }\n.raabandon:before { content: \"\\f05e\"; font-size: 35pt; }\n\n/* Start Job */\n.startjob:before { content: \"\\f0ad\"; font-size: 35pt; }\n.complete:before { content: \"\\f087\"; font-size: 35pt; }\n\n/* SOR Code Selection */\n.required-sorcode:before { content: \"\\f071\"; font-size: 20pt; }\n.added-sorcode:before { content: \"\\f087\"; font-size: 20pt; }\n\n/* Purchase Order */\n.purchase-order-icon:before { content: \"\\f07a\"; font-size: 50pt; }"},{"name":"cssSpinner","type":"style","item-type":"css","_auto_id_":"5b9f0752-6c62-4cfb-8897-22c19029a39c","content":"load-spinner {\n    display:block;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.7);\n    z-index:10000;\n    display: none;\n}\n\nload-spinner.active {\n  display: block !important;\n}\n\nload-spinner .spinner {\n    height:40px;\n    width:40px;\n    top:20%;\n    margin:auto;\n    animation: rotation 1.2s infinite linear;\n    border-left:6px solid rgba(255,255,255,.8);\n    border-right:6px solid rgba(255,255,255,.8);\n    border-bottom:6px solid rgba(255,255,255,.8);\n    border-top:6px solid rgba(220,79,16,.8);\n    border-radius:100%;\n}  \n\nload-spinner .header {\n    height:25%;\n}\n\nload-spinner .loading-message {\n    padding:10px 20px;\n    text-align:center;\n    font-size:20px;\n    color:white;\n}\n\n@keyframes rotation {\n    from {transform: rotate(0deg);}\n    to {transform: rotate(359deg);}\n}"},{"name":"cssContextMenu","type":"style","item-type":"css","_auto_id_":"1acd7998-b866-4ec1-82f2-eed702867abb","content":".context-menu {\n  display:inline-block;\n  width: 90vw;\n  padding-top: 2vh;\n}\n\n#title_bar.navbar-default {\n  background-color: #fff !important; \n  background: url('user-assets/logo.png') no-repeat;\n  max-height: 80px!important;\n  background-size: contain;\n  flex: inherit;\n  border-bottom: 1px solid #dc4f10;\n}\n\n#title_bar.navbar-default md-content[item-type=\"html\"] {\n  width:100%;\n  text-indent:60px;\n  font-size:16pt;\n  margin-top:8pt;\n  color: #dc4f10;  \n}\n\n.header-button {\n  color:#dc4f10 !important;\n  background-color: #fff !important;\n  margin-right:6px;\n  margin-top:6px;\n  border: none;\n}\n.header-button .fa {\n  font-size: 32px !important;\n}\n\n.title {\n  line-height: 16px;\n  padding-left: 12px;\n}\n\n.contextMenuBG {\n    position: absolute;\n    width: 100vw;\n    height: 100vh;\n    top: 0;\n    left: 0;\n    background-color: rgba(0, 0, 0, 0.3);\n    z-index: 999\n}\ncontext-menu .contextMenuBG .contextMenu {\n    position: absolute;\n    width: 60vw;\n    height: 100vh;\n    top: 0;\n    right: -60vw;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 1000;\n    -webkit-animation: slide .5s forwards\n}\n@-webkit-keyframes slide {\n    100% {\n        right: 0\n    }\n}\n@keyframes slide {\n    100% {\n        right: 0\n    }\n}\ncontext-menu .contextMenuBG .contextMenu div {\n    margin: 0;\n    border-bottom: 1px solid white\n}\ncontext-menu .contextMenuBG .contextMenu div a,\ncontext-menu .contextMenuBG .contextMenu div a:hover {\n    color: white !important;\n    border: none;\n    background-color: transparent !important;\n    width: 100%;\n    padding: 3vh 0;\n    text-align: left;\n    margin-left: 3vw\n}\ncontext-menu .contextMenuBG .contextMenu div a span span:before {\n    margin-right: 3vw;\n    width: 8vw;\n    display: inline-block;\n    text-align: center\n}\ncontext-menu[popup=\"true\"] .contextMenuBG {\n    background-color: transparent\n}\ncontext-menu[popup=\"true\"] .contextMenu {\n    position: absolute;\n    z-index: 1000;\n    background-color: white;\n    border: 1px solid #d3d3d3;\n    height: initial;\n    -webkit-animation: none\n}\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div {\n    border-top: 1px solid #d3d3d3\n}\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div:first-child {\n    border-top: none\n}\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div a,\ncontext-menu[popup=\"true\"] .contextMenuBG .contextMenu div a:hover {\n    color: black !important;\n    margin-left: 0;\n    text-align: center;\n    padding: 2vh 0\n}\n\ncontext-menu .btn .fa { padding-right: 1vw; }\n\n#btnLogout  {\n  position: fixed;\n  bottom: 0;\n  border-top: 1px solid #fff;\n  margin: 0;\n  padding-left: 0px;\n  border-bottom: none!important;\n}\n\n#btnLogout > .btn .fa {\n  margin-left: 3vw!important;\n}"},{"name":"cssPhotoManager","type":"style","item-type":"css","_auto_id_":"64653dcc-00b1-4658-b698-345da36bb175","content":"#photoArea {\n    margin: 8px 4px;\n    min-height: 20px;\n}\n.photo-row {\n  min-height: 120px;\n  border: 1px solid silver;\n  margin-top: 6px;\n  border-radius:12px;\n  overflow:hidden\n}\n.photo-container {\n  box-sizing:border-box;\n  float:left;\n  width: 25%;\n}\n.photo-container > img {\n    width: 100%;\n    height: auto;\n}\n.photo-info-container {\n  box-sizing:border-box;\n  margin-left:25%;\n  display: block;\n}\n.photo-info-banner {\n  background-color:#dc4f10;\n  min-height:10%;\n  width:100%;\n  text-align:right;\n}\n.photo-info-banner span {\n  position:relative;\n  display:inline-block;\n  color:white;\n  top:25px;\n  height:40px; \n  font-size:0.8em;\n  width:66px;\n  text-align:center;\n}\n.photo-info-banner span:before {\n  font-family: FontAwesome;\n  font-size:2.2em;\n  position:absolute;\n  white-space: pre;\n  top:0px;\n  left: 33px;\n  transform: translate(-12px, -27px);\n}\n.description-option:before {\n  content:\"\\f044\";\n}\n.delete-option:before {\n  content:\"\\f057\";\n}\n.photo-info {\n  float:none;\n  padding:2px;\n  font-size:0.9em;\n}\n.photo-info span {\n  font-size:0.75em;\n  font-weight:700;\n  padding-right:4px;\n}\n.photo-review-container {\n  width:98vw;\n}\n.photo-review {\n  max-width:90%;\n  border:none;\n  height:auto;\n}\n\n.take-photo-div {\n  text-align: center;\n  font-size: 50pt;\n  color: #0072C6!important;\n}\n.take-photo-fa:before {\n  content: \"\\f030\"; \n}"},{"name":"cssLogin","type":"style","item-type":"css","_auto_id_":"e851d967-8e33-4c75-862b-7802703a03a6","content":"#Login .credentials-input { text-align: center; }\n#Login .form-input-error { color: transparent; }\n#Login .form-control { border: none; border-bottom: 1px solid black; text-align: center; }\n#Login .flexbox-container .navbar-default { background-color: #fff; }\n\n.app-title {\n  padding:8px;\n  text-align:center;\n  width:100%;\n}\n.version {\n  display:block;\n  font-size:0.7em;\n  color:grey;\n}\n.header-image {\n  padding-top: 10vh;\n  padding-bottom: 10vh;\n  text-align: center;\n  padding-right: 6vw;\n}\n\na#btnSettings {\n    color: #dc4f10;\n    border: none;\n}\na#btnSettings span.fa.fa-gear {\n    font-size: 2.0em;\n}"},{"name":"cssCP12","type":"style","item-type":"css","_auto_id_":"a89a3a52-b211-4d4b-8cd4-8a0908b4ccf9","content":"#CP12 .has-success .checkbox, .has-success .checkbox-inline, .has-success .control-label, .has-success .help-block, .has-success .radio, .has-success .radio-inline, .has-success.checkbox label, .has-success.checkbox-inline label, .has-success.radio label, .has-success.radio-inline label {\n    color: #000000;\n}\n\n#CP12 .form-input-error { color: transparent; }\n\n.disclaimer-container {\n  padding: 40px 20px 0px 20px;\n  text-align: center;\n}\n\n.disclaimer-container-start {\n  padding: 20px 20px 0px 20px;\n  text-align: center;\n}\n\n#CP12 .navbar-default {\n  background-color: #fff;\n  color: #dc4f10;\n}"},{"name":"cssVehicleChecks","type":"style","item-type":"css","_auto_id_":"30e14c82-7179-42e7-82b5-603856c4d199","content":"#VehicleChecks .has-success .checkbox, .has-success .checkbox-inline, .has-success .control-label, .has-success .help-block, .has-success .radio, .has-success .radio-inline, .has-success.checkbox label, .has-success.checkbox-inline label, .has-success.radio label, .has-success.radio-inline label {\n    color: #000000;\n}\n#VehicleChecks .form-input-error { color: transparent; }\n\n.supervisor { color: #ff0000; padding-top: 3vh; }"},{"name":"cssJobsList","type":"style","item-type":"css","_auto_id_":"c1fd40e4-e3cf-4166-9ecb-7c75d59bd160","content":".info { display: inline-block; width: 100%; padding-top: 30px; }\n.details { display: inline-block; width: 100%; }\n.floatright { display: inline-block; float: right; }\n.description { display: inline-block; font-weight: bold; max-width: 75%; }\n.address { display: inline-block; max-width: 75%; }\n\n#list_joblistfull .list-group-item {\n    padding: 20px 0px;\n    margin-bottom: 10px;\n    border: none;\n    border-radius: 20px;\n    background-color: #f1f1f1;\n}\n\n#list_joblistshort .list-group-item {\n    padding: 20px 0px;\n    margin-bottom: 10px;\n    border: none;\n    border-radius: 20px;\n    background-color: #f1f1f1;\n}\n\n#JobList .content-block {\n    margin-bottom: 0px;\n}\n\n.high {\n  color: #ff0000;\n  display: inline-block;\n  float: right;\n}\n.med {\n  color: #FFC200;\n  display: inline-block;\n  float: right;\n}\n.low {\n  color: #008000;\n  display: inline-block;\n  float: right;\n}\n\n.retry-job {\n  color:#0072C6;\n  text-align:center;\n  font-size:30pt;\n  width:100%;\n}\n\n.joblist-container {\n    display: flex;\n    margin: 0px 0px 0px 5px;\n    position: relative;\n}\n\n.joblist-column-1 {\n    flex: 0 0 35px;    \n}\n\n.joblist-column-2 {\n    flex: 2;\n    margin-left: 12px;\n}\n.joblist-column-3 {\n    display: flex;\n    flex: 0 0 20px;\n    align-items: center;\n    justify-content: flex-end;\n\n}\n.joblist-column-3:after {\n    font-family: 'FontAwesome';\n    content: \"\\f105\";\n    margin-right: 10px;\n    font-size: 20px;\n    float:right;\n    color:#333;    \n}\n\n.joblist-status {\n    border-right: 3px solid #8BC34A;\n    padding: 0px 10px 5px 5px;\n}\n.joblist-contract {\n    font-size: 14px;\n}\n\n.joblist-priority, .joblist-address {\n    font-size: 12px;\n    font-weight: 200;\n}\n\n.joblist-slot {\n  font-size: 12px;\n  text-align: center;\n}\n\n.joblist-day {\n  font-size: 16px;\n  text-align: center;\n}\n\n.joblist-month {\n  font-size: 14px;\n  text-transform: uppercase;\n  text-align: center;\n}\n\n.hide-job {\n  display: none;\n}"},{"name":"cssTenantDetails","type":"style","item-type":"css","_auto_id_":"0d7beccf-aa0f-4700-a819-c5876b3d12dc","content":"#TenantDetails .form-input-error { color: transparent; }\n#TenantDetails .form-group.item-date .input-group, .form-group.item-time .input-group {padding-top: 4vh;}\n#TenantDetails .form-control {text-align: left;}\n#TenantDetails .form-group.item-date .form-control, .form-group.item-time .form-control {border: none;}\n#TenantDetails .checkbox-element { margin: 0px 0 0;  padding: 5px 13px; }\n#TenantDetails .md-checkbox-container { text-align: left; }\n#TenantDetails .md-checkbox { padding: 0px 0px 0px 0px; }\n#TenantDetails .vehiclecheck-reg { padding-top: 5vh; }\n.inlineblock-default { display:inline-block;width: 100%; }\n\n#TenantDetails .container, .container-fluid { \n  padding-right: 0px; \n  padding-left: 0px; \n  margin-right: 0px; \n  margin-left: 0px; \n}\n\n.home {\n  color: #0072C6;\n  display: inline-block;\n  float: left;\n  margin-left: 30px;\n}\n.mobile {\n  color: #0072C6;\n  display: inline-block;\n  margin: 0 auto;\n}\n.booked {\n  color: #0072C6;\n  display: inline-block;\n  float: right;\n  margin-right: 30px;\n}\n\n.no-home {\n  color: grey!important;\n}\n.no-mobile {\n  color: grey!important;\n}\n.no-booked {\n  color: grey!important;\n}\n\n.home-text {\n  color: #0072C6;\n  display: inline-block;\n  float: left;\n  margin-left: 6px;\n}\n.mobile-text {\n  color: #0072C6;\n  display: inline-block;\n  margin: 0px auto;\n  margin-right: 16px;\n}\n.booked-text {\n  color: #0072C6;\n  display: inline-block;\n  float: right;\n  margin-right: 16px;\n}\n\n.tenant-contacts {\n  font-weight:bold;\n  margin-bottom: 3vh;\n  margin-top:1vh;\n  text-align: left;\n}"},{"name":"cssJobAccessDetails","type":"style","item-type":"css","_auto_id_":"02a3b544-f9fc-4e53-a661-4d290ef117eb","content":"#order_summary textarea.form-control { height: 20vh; }"},{"name":"cssJobHistory","type":"style","item-type":"css","_auto_id_":"f559baad-0d35-4b5c-95b4-a85af1188e55","content":"#list_jobhistory .list-group-item {\n    padding: 20px 0px;\n    margin-bottom: 10px;\n    border: none;\n    border-radius: 20px;\n    background-color: #f1f1f1;\n}\n\n#JobHistory .content-block {\n    margin-bottom: 0px;\n}\n\n.left-list-header {\n  font-weight: bold;\n  display: inline-block;\n  float: left;\n}\n.center-list-header {\n  font-weight: bold;\n  display: inline-block;\n  margin: 0px auto;\n}\n.right-list-header {\n  font-weight: bold;\n  display: inline-block;\n  float: right;\n}"},{"name":"cssWarnings","type":"style","item-type":"css","_auto_id_":"447825a5-52e1-43b4-84df-e1ba11e23314","content":"#Warnings .list-group-item {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#Warnings .list-group-item:first-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#Warnings .list-group-item:last-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n\n.warning-short {\n  display:inline-block;\n  font-weight:bold;\n  margin-bottom: 20px;\n  margin-left: 10px;\n}\n\n.checked-warning {\n  color: #228B22;\n  display: inline-block;\n  float: right;\n}\n.unchecked-warning {\n  color: #ff0000;\n  display: inline-block;\n  float: right;\n}\n\n.all-checked-warning {\n  color: #228B22;\n  display: inline-block;\n  float: right;\n}\n.all-unchecked-warning {\n  color: #ff0000;\n  display: inline-block;\n  float: right;\n}\n\n.property-icon { \n  color: #000000;\n  display: inline-block;\n  float: left; \n  font-size: 20pt;\n} \n.two-person-icon { \n  color: #FF0000; \n  display: inline-block; \n  float: left;\n  font-size: 20pt;\n}\n.disability-icon { \n  color: #0072C6;\n  display: inline-block;\n  float: left; \n  font-size: 20pt;\n}\n.vulnerability-icon { \n  color: #0072C6;\n  display: inline-block;\n  float: left; \n  font-size: 20pt;\n}\n.asbestos-icon { \n  color: #FFC200; \n  display: inline-block; \n  float: left; \n  font-size: 20pt;\n}\n.other-icon { \n  color: #228B22; \n  display: inline-block; \n  float: left; \n  font-size: 20pt;\n}"},{"name":"cssStartTravel","type":"style","item-type":"css","_auto_id_":"a6275093-8d35-4942-bee9-4a61acc71d5a","content":".started-ticked { color: #228B22; }\n.starting { color: #228B22; text-align: center; }\n.getmethere {  color: #0072C6; margin-bottom: 0vh; }\n.buttonDisabled:hover{ color: #0072C6; background-color: #fff; text-decoration: none; }"},{"name":"cssArrivedOnSite","type":"style","item-type":"css","_auto_id_":"a38062a0-08c2-44dc-995e-c52ff06b097a","content":".arrived-ticked { color: #228B22; }\n.arriving { color: #228B22; text-align: center; }\n\n.lone-device-warning {\n  display: inline-block;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n  width: 325px;\n  line-height: 71px;\n  height: 76px;\n}\n\n.checked-lone {\n  color: #228B22;\n  display: inline-block;\n}\n.unchecked-lone {\n  color: #ff0000;\n  display: inline-block;\n}"},{"name":"cssRiskAssessment","type":"style","item-type":"css","_auto_id_":"39406114-e9cf-47a8-8819-9494fd048b8d","content":".racomplete { color: #228B22; padding-top: 3vh; }\n.raabandon { color: #ff0000; padding-top: 3vh; }"},{"name":"cssStartingWork","type":"style","item-type":"css","_auto_id_":"3ddf2fe4-7d46-411e-9e8e-93852f9f18fa","content":".startjob { color: #0072C6; }\n\n.job-info-hide { display: none; }\n.job-info {\n  display: inline-block;\n  width: 100%;\n  margin-bottom: 10px;\n  padding: 19px;\n  background-color: lightgray;\n}\n\n.job-info-header {\n  display:inline-block;\n  font-weight:bold;\n  margin-bottom: 20px;\n}"},{"name":"cssFollowOnAppointment","type":"style","item-type":"css","_auto_id_":"1b0c7add-b060-4b9e-9867-97b38434f006","content":".timeslot-item-selected {\n  border: 1px solid #dc4f10;\n  font-weight: bold;\n  border-radius: 30px;\n  margin-left: -10px;\n  padding: 8px;\n}\n\n#FollowOnContinued .list-group-item { padding: 20px 20px; margin-bottom: 0px; border-bottom: 1px solid #ddd!important; border: none; }"},{"name":"cssSORLocationSelect","type":"style","item-type":"css","_auto_id_":"5aaa556c-c651-4ea2-b347-a20dcb16cc1f","content":"#SORLocationSelect  .list-group-item {\n  padding: 10px 10px;\n  margin-bottom: 0px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n}\n\n#SORLocationSelect .list-item-container {\n  text-align: center;\n  font-size: 1.4em;\n  display: inline-block;\n  width: 100%;\n}\n\n#SORLocationSelect .list-location {\n  display: inline-block;\n}\n\n#SORLocationSelect .content-block {\n  margin-bottom: 0px;\n}\n\n#SORLocationSelect .list-group {\n  margin-bottom: 0px!important;\n}\n\n.required-sorcode { \n  color: #FFC200;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}\n.added-sorcode { \n  color: #008000;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}\n\n.codes-icon {\n  text-align: center;\n  font-size: 30pt;\n  margin-bottom: -10px;\n  margin-top: -10px;\n}\n\n.codes-icon-header {\n  text-align: center;\n  margin-bottom: 20px;\n}"},{"name":"cssSORCodes","type":"style","item-type":"css","_auto_id_":"7aad6527-fa7e-4419-b7ba-a5a4f53b5da2","content":".sor-schedules-panel {\n  width: 100%;\n  display: inline-block;\n  min-height: 30px;\n  padding: 10px 10px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n  background: linear-gradient( to right, #dc4f10 0%, #dc4f10 50%, #fff 50%, #fff 100% );\n}\n\n.sor-schedules-schedules {\n  color: #fff;\n  width: 50%;\n  display: inline-block;\n  text-align: center;\n}\n.sor-schedules-search {\n  color: #dc4f10;\n  width: 40%;\n  display: inline-block;\n  text-align: center;\n}\n\n.sor-search-panel {\n  width: 100%;\n  display: inline-block;\n  min-height: 30px;\n  padding: 10px 10px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n  background: linear-gradient( to right, #fff 0%, #fff 50%, #dc4f10 50%, #dc4f10 100% );\n}\n\n.sor-search-schedules {\n  color: #dc4f10;\n  width: 50%;\n  display: inline-block;\n  text-align: center;\n}\n.sor-search-search {\n  color: #fff;\n  width: 40%;\n  display: inline-block;\n  text-align: center;\n}\n\n#list_sorsummary .list-group-item {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_sorsummary .list-group-item:first-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_sorsummary .list-group-item:last-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n\n#list_sorcodes .list-group-item {\n  padding: 10px 20px 20px 20px;\n  margin-bottom: 0px;\n  border-bottom: 1px solid #dc4f10!important;\n  height: 100px;\n  border: none;\n}\n\n#list_sorsummary .content-block {\n  margin-bottom: 0px;\n}\n\n#list_sorcodes { \n  margin-top: 20px;\n}\n\n#list_sorsummary .navbar-default {\n  background-color: #fff;\n  color: #dc4f10;\n  font-size: 20pt;\n  border: none;\n}\n#list_sorsummary .btn-default {\n  border: none;\n}\n\n#SORCodes .flexbox-container .navbar-default.row-item:last-child .btn:not(.minimal) {\n  background-color: #fff;\n  border: 0;\n}\n\n.sor-value {\n  line-height: 55px;\n}\n\n.sor-list-header {\n  font-weight: bold;\n  font-size: 12pt;\n  text-align: center;\n}\n\n.fa-minus-circle:before {\n  color: #0072C6;\n  font-size: 20pt;\n}\n.fa-plus-circle:before {\n  color: #0072C6;\n  font-size: 20pt;\n}\n\n.sor-header { display:inline-block; font-weight:bold; margin-bottom: 20px; padding: 5px; font-size: 14pt; }\n.estimated { color: #0072C6; display: inline-block; float: right; margin-left: 6px; padding: 5px; }\n.qty-text { color: #0072C6; display: inline-block; float: left; margin-left: 40px; }\n.remaining-text { color: #0072C6; display: inline-block; float: right; margin-right: 40px; }\n.minus { color: #0072C6; display: inline-block; }\n.plus { color: #0072C6; display: inline-block; }\n.plus:before { content: \"\\f196\"; font-size: 20pt; }\n.minus:before { content: \"\\f147\"; font-size: 20pt; }\n.qty { color: #0072C6; display: inline-block; width: 30px; text-align: center; font-size: 20pt;}\n.remaining { color: #0072C6;display: inline-block;width: 30px;font-size: 20pt; }\n.qty-block { display: inline-block;float: left;margin-left: 31px; }\n.remaining-block { display: inline-block;float: right;margin-right:  38px; }\n.inlineblock-toggle { text-align:center;width:100%; }\n.inlineblock-outer { display:inline-block;width:100%; }\n.not-available { color: silver!important; }\n\n#list_sorcodes .pagination>.disabled>a, \n.pagination>.disabled>a:focus, \n.pagination>.disabled>a:hover, \n.pagination>.disabled>span, \n.pagination>.disabled>span:focus, \n.pagination>.disabled>span:hover {\n    color: #D3D3D3;\n    background-color: #fff;\n    border-color: #dc4f10;\n}\n\n#list_sorcodes .pagination>.active>a, \n.pagination>.active>a:focus, \n.pagination>.active>a:hover, \n.pagination>.active>span, \n.pagination>.active>span:focus, \n.pagination>.active>span:hover {\n    color: #fff;\n    background-color: #dc4f10;\n    border-color: #dc4f10;\n}\n\n#list_sorcodes .pagination>li>a, \n.pagination>li>span {\n    color: #dc4f10;\n    border: 1px solid #dc4f10;\n}"},{"name":"cssVanLocationSelect","type":"style","item-type":"css","_auto_id_":"a4e53cf5-e511-4dfb-aca9-39c726615a7e","content":"#VanLocationSelect  .list-group-item {\n  padding: 10px 10px;\n  margin-bottom: 0px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n}\n\n#VanLocationSelect .list-item-container {\n  text-align: center;\n  font-size: 1.4em;\n  display: inline-block;\n  width: 100%;\n}\n\n#VanLocationSelect .list-location {\n  display: inline-block;\n}\n\n#VanLocationSelect .content-block {\n  margin-bottom: 0px;\n}\n\n#VanLocationSelect .list-group {\n  margin-bottom: 0px!important;\n}\n\n.required-sorcode { \n  color: #FFC200;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}\n.added-sorcode { \n  color: #008000;\n  display: inline-block;\n  float: right;\n  padding-top: 3px; \n}"},{"name":"cssVanStock","type":"style","item-type":"css","_auto_id_":"83bec354-b1c8-4ee9-a90d-03ad0c9e3807","content":"#list_vanstocksummary .list-group-item {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_vanstocksummary .list-group-item:first-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n#list_vanstocksummary .list-group-item:last-child {\n  margin-bottom: 10px;\n  border: 2px solid #dc4f10;\n  border-radius: 35px;\n}\n\n#list_vanstock .list-group-item {\n  padding: 10px 20px 20px 20px;\n  margin-bottom: 0px;\n  border-bottom: 1px solid #dc4f10!important;\n  height: 100px;\n  border: none;\n}\n\n#list_vanstock { \n  margin-top: 20px;\n}\n\n#list_vanstocksummary .navbar-default {\n  background-color: #fff;\n  color: #dc4f10;\n  font-size: 20pt;\n  border: none;\n}\n\n#list_vanstocksummary .content-block {\n  margin-bottom: 0px;\n}\n\n#VanStockCodes .btn-default {\n  border: none;\n}\n\n#VanStockCodes .flexbox-container .navbar-default.row-item:last-child .btn:not(.minimal) {\n  background-color: #fff;\n  border: 0;\n}\n\n#list_vanstock .pagination>.disabled>a, \n.pagination>.disabled>a:focus, \n.pagination>.disabled>a:hover, \n.pagination>.disabled>span, \n.pagination>.disabled>span:focus, \n.pagination>.disabled>span:hover {\n    color: #D3D3D3;\n    background-color: #fff;\n    border-color: #dc4f10;\n}\n\n#list_vanstock .pagination>.active>a, \n.pagination>.active>a:focus, \n.pagination>.active>a:hover, \n.pagination>.active>span, \n.pagination>.active>span:focus, \n.pagination>.active>span:hover {\n    color: #fff;\n    background-color: #dc4f10;\n    border-color: #dc4f10;\n}\n\n#list_vanstock .pagination>li>a, \n.pagination>li>span {\n    color: #dc4f10;\n    border: 1px solid #dc4f10;\n}"},{"name":"cssOTCLocationSelect","type":"style","item-type":"css","_auto_id_":"bd4cd99a-01ff-4a0c-bf76-0f04eb6a35e4","content":"#OTCLocationSelect  .list-group-item {\n  padding: 10px 10px;\n  margin-bottom: 0px;\n  border: 1px solid #dc4f10;\n  border-radius: 20px;\n  margin-bottom: 10px;\n}\n\n#OTCLocationSelect .list-item-container {\n  text-align: center;\n  font-size: 1.4em;\n  display: inline-block;\n  width: 100%;\n}\n\n#OTCLocationSelect .list-location {\n  display: inline-block;\n}\n\n#OTCLocationSelect .content-block {\n  margin-bottom: 0px;\n}\n\n#OTCLocationSelect .list-group {\n  margin-bottom: 0px!important;\n}\n\n.hide-location {\n  display: none;\n}"},{"name":"cssOTCCodes","type":"style","item-type":"css","_auto_id_":"1b8f8a26-e3e2-494e-baa9-4903c9c80691","content":"#list_otcstocksummary .list-group-item {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#list_otcstocksummary .list-group-item:first-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n#list_otcstocksummary .list-group-item:last-child {\n    margin-bottom: 10px;\n    border: 2px solid #dc4f10;\n    border-radius: 35px;\n}\n\n#list_otcstock .list-group-item {\n  padding: 10px 20px 20px 20px;\n  margin-bottom: 0px;\n  border-bottom: 1px solid #dc4f10!important;\n  border: none;\n}\n#list_otcstock { \n  margin-top: 20px;\n}\n\n#list_otcstocksummary .navbar-default {\n  background-color: #fff;\n  color: #dc4f10;\n  font-size: 20pt;\n  border: none;\n}\n#OTCCodes .btn-default {\n  border: none;\n}\n\n#OTCCodes .flexbox-container .navbar-default.row-item:last-child .btn:not(.minimal) {\n  background-color: #fff;\n  border: 0;\n}\n\n\n#list_otcstock .pagination>.disabled>a, \n.pagination>.disabled>a:focus, \n.pagination>.disabled>a:hover, \n.pagination>.disabled>span, \n.pagination>.disabled>span:focus, \n.pagination>.disabled>span:hover {\n    color: #D3D3D3;\n    background-color: #fff;\n    border-color: #dc4f10;\n}\n\n#list_otcstock .pagination>.active>a, \n.pagination>.active>a:focus, \n.pagination>.active>a:hover, \n.pagination>.active>span, \n.pagination>.active>span:focus, \n.pagination>.active>span:hover {\n    color: #fff;\n    background-color: #dc4f10;\n    border-color: #dc4f10;\n}\n\n#list_otcstock .pagination>li>a, \n.pagination>li>span {\n    color: #dc4f10;\n    border: 1px solid #dc4f10;\n}"},{"name":"cssPauseTask","type":"style","item-type":"css","_auto_id_":"6c68ee14-8ef6-40c9-9d91-b1ef640609ee","content":".pauseicon { \n  text-align: center; \n  color: #dc4f10; \n  font-size: 60pt;\n}\n.pauseheader { \n  text-align: center; \n  color: #dc4f10; \n}"},{"name":"cssPurchaseOrder","type":"style","item-type":"css","_auto_id_":"bec4d7b8-d64e-43b8-9cfb-8a8c72cea540","content":".purchase-order {\n  text-align: center;\n}\n\n.purchase-order-icon { \n  color: #0072C6; \n}\n\n.purchase-order-header { \n  text-align: center; \n  color: #0072C6; \n  margin-bottom: 40px;\n}\n\n.purchases-area {\n  margin-top: 15px;\n  margin-bottom: 15px;\n}\n\n#OTCPurchases .navbar-default {\n  background-color: #FFF!important;\n}"},{"name":"image_asset_mainlogo","type":"style","item-type":"image-asset","_auto_id_":"bf0304c7-2299-4ab9-b749-676442bde2ff","fileName":"accuserv-logo.png"},{"name":"image_asset_thumblogo","type":"style","item-type":"image-asset","_auto_id_":"666fce7f-b8af-4628-b984-a43cc693f90f","fileName":"logo.png"},{"name":"tmFetchMapData","type":"scripting","item-type":"timer","_auto_id_":"9e3659b5-e222-4871-a048-363b848849b1","timer-type":"delay","time":500,"actions":[{"event":"click","type":"call-api","data":{"sync":true,"name":"GoogleMapsAPI","operation":"initMap"},"_auto_id_":"fe6ca778-75b6-450e-827b-1fa86b444ddf","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"debugger;\nfunction initMap(positions) {\n  var currentLocation = {lat: positions[0].lat, lng: positions[0].lng};\n  \n  var map = new google.maps.Map(document.getElementById('map'), {\n    zoom: 8,\n    center: currentLocation\n  });\n  \n  var infoWindow = new google.maps.InfoWindow({map: map});\n  \n  if (navigator.geolocation) {\n    navigator.geolocation.getCurrentPosition(function(position) {\n      var pos = {\n        lat: position.coords.latitude,\n        lng: position.coords.longitude\n      };\n\n      infoWindow.setPosition(pos);\n      infoWindow.setContent('Location found.');\n      map.setCenter(pos);\n    }, function() {\n      handleLocationError(true, infoWindow, map.getCenter());\n    });\n  } else {\n    // Browser doesn't support Geolocation\n    handleLocationError(false, infoWindow, map.getCenter());\n  }\n  \n  var marker = new google.maps.Marker({\n    icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',\n    position: currentLocation,\n    map: map\n  });\n  \n  for(var i in positions) {\n    var marker = new google.maps.Marker({\n      position: positions[i],\n      map: map\n    });\n  }\n}\n\nfunction handleLocationError(browserHasGeolocation, infoWindow, pos) {\n  infoWindow.setPosition(pos);\n  infoWindow.setContent(browserHasGeolocation ?\n                        'Error: The Geolocation service failed.' :\n                        'Error: Your browser doesn\\'t support geolocation.');\n}\n\nvar mapLocations = cti.store.jobs.mapLocations;\n\nif(mapLocations.length > 0) {\n  initMap(mapLocations);\n}\n\ncti.utils.updatePage();\n\ncti.fnCloseSpinner();"},"_auto_id_":"b8381345-12b7-49ae-8148-36b01c028edc"},{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"api_failure_error","title":"Error Connecting to Google","text":"No connection could be made to the Google API to download the map information. Please check your connection and try again, alternatively please contact support if the issue continues."},"_auto_id_":"0b864020-dd2c-4685-aa25-842028906984"},{"event":"success","type":"stop-timer","data":{"name":"tmFetchMapData"},"_auto_id_":"1d1cce05-806c-4e4c-a021-20adf26c3780"},{"event":"fail","type":"stop-timer","data":{"name":"tmFetchMapData"},"_auto_id_":"44873181-8195-414f-8abf-47927747456e"}]}]},{"name":"fnClearPhotos","type":"scripting","item-type":"function","_auto_id_":"3ab17a36-7f8d-4e4d-a4de-346ac16ed4ba","sync":true,"params":[{"name":"photosObject","description":"Container object with photo details"},{"name":"online","description":"Boolean to see if we're resubmitting a photo that failed or not"}],"content":"if(online) {\n  var photos = photosObject || cti.store.jobs.selectedJob.photos || [];\n  cti.store.jobs.photoAssociatedJobPhotos = photos;\n} else {\n  var photos = photosObject || cti.store.jobs.failedPhotosToSend.photos || [];\n  cti.store.jobs.photoAssociatedJobPhotos = photos;\n}\n\nvar l = photos.length;\nvar instance = this;\nvar thisPhoto = undefined;\nvar failCount = 0;\n\nif (l == 0) { \n  completeEvent(); \n  return true; \n}\n\n//window.appManager.logEvent('Deleting photos', 'info');\n\nif (!window.cordova) {\n  for (var i = l; i>=0; i--) {\n    photos.splice(i, 1);\n  }\n  completeEvent(); \n  return true; \n}\n\n// Start at the last photo and work our way back\nvar photoIndex = l;\n  \nfunction completeEvent() {\n  delete cti.store.jobs.photoAssociatedJobPhotos;\n  \n  if (failCount > 0) { \n    if (typeof this.$fail === \"function\") { this.$fail(); } else { return false; }\n  } else { \n    if (typeof this.$success === \"function\") { this.$success(); } else { return true; }\n  }\n}\n  \nfunction processNextPhoto() {\n  var requireDelete = false;\n  photoIndex--;\n  if (photoIndex >= 0) {\n    var startIndex = photoIndex;\n    for (var i = startIndex; i >= 0; i--) {\n      photoIndex = i;\n      // TODO Only delete if uploaded??\n      requireDelete = true;\n      break;\n    }\n  }\n  if (requireDelete) {\n    window.resolveLocalFileSystemURI(cti.store.jobs.photoAssociatedJobPhotos[photoIndex].src, function(entry) {\n      entry.remove(function(){\n        photos.splice(photoIndex, 1);\n        processNextPhoto();\n      },function(e1){\n        failCount++;\n        window.appManager.logError('Unable to remove file when deleting photo', e1);\n        processNextPhoto();\n      },function(){\n        window.appManager.logError('Unable to remove file when deleting photo');\n        photos.splice(photoIndex, 1);\n        processNextPhoto();\n      });\n    }, function(e2) {\n      failCount++;\n      window.appManager.logError('Unable to resolve file URL when deleting photo', e2);\n      // See if we can delete others\n      processNextPhoto();\n    });            \n  }\n  else {\n    // No more photos to be deleted, fire the completion event\n    completeEvent();\n  }\n}\n  \nwindow.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSys) { \n  instance.fileSys = fileSys;\n  // Start the process once we know we have the file system etc\n  processNextPhoto();\n}, function(e) {\n  failCount++;\n  //window.appManager.logError('Unable to retrieve file system for deleting photos', e);\n  completeEvent();\n});"},{"name":"fnDeleteSelectedPhoto","type":"scripting","item-type":"function","_auto_id_":"4bd1aef6-a479-47a4-97b8-38866f30cbc1","sync":true,"params":[],"content":"// Delete the currently selected photo - ie the one we are viewing in the PhotoDetail page\n// Find it's location in the source array\nvar index = undefined;\nfor (var k in cti.store.variables.selectedPhotoList) {\n  if (cti.store.variables.selectedPhotoList[k].id == cti.store.variables.selectedPhoto.id) {\n    index = k;\n    break;\n  }\n}\n          \nif (index === undefined) {\n  //console.log(\"debug:: Photo id \" + id + \" not found for deletion\");\n  return false;\n}\n\nif(!window.cordova) {\n  cti.fnCloseSpinner();\n  cti.store.variables.selectedPhotoList.splice(index, 1);\n  delete cti.store.variables.selectedPhoto;\n  \n  cti.store.variables.fromPhotoDetail = true;\n  cti.utils.updatePage();\n  \n  var lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastPhotoDetailPage));\n  cti.utils.callAction(\"go-to-page\", { \"name\" : lastPage });\n  delete cti.store.variables.lastPhotoDetailPage;\n} else {      \n  window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSys) { \n    window.resolveLocalFileSystemURL(cti.store.variables.selectedPhotoList[index].src, function(entry) {\n      entry.remove(function(){\n        cti.fnCloseSpinner();\n        cti.store.variables.selectedPhotoList.splice(index, 1);\n        delete cti.store.variables.selectedPhoto;\n        \n        cti.store.variables.fromPhotoDetail = true;\n        cti.utils.updatePage();\n\n        var lastPage = JSON.parse(JSON.stringify(cti.store.variables.lastPhotoDetailPage));\n        cti.utils.callAction(\"go-to-page\", { \"name\" : lastPage });\n        delete cti.store.variables.lastPhotoDetailPage;\n      },function(e1){\n        cti.fnCloseSpinner();\n        window.appManager.logEvent(\"error:: Problem removing file - \" + JSON.stringify(e1), 'error');\n        cti.utils.callAction(\n          \"show-notification\", {\n            \"name\": \"api_failure_error\",\n            \"title\": \"Delete failed\",\n            \"text\": \"Problem removing file - \" + JSON.stringify(e1)\n          }\n        );\n      },function(){\n        cti.fnCloseSpinner();\n        window.appManager.logEvent(\"error:: Problem removing file - probably does not exist\", 'error');\n        cti.utils.callAction(\n          \"show-notification\", {\n            \"name\": \"api_failure_error\",\n            \"title\": \"Delete failed\",\n            \"text\": \"Problem removing file - file does not exist.\"\n          }\n        );\n      });\n    }, function(e2) {\n      cti.fnCloseSpinner();\n      window.appManager.logEvent(\"error:: Problem resolving file URL - \" + JSON.stringify(e2), 'error');\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\": \"api_failure_error\",\n          \"title\": \"Delete failed\",\n          \"text\": \"Problem resolving file URL - \" + JSON.stringify(e2)\n        }\n      );\n    });\n  }, function(e3) {\n    cti.fnCloseSpinner();\n    window.appManager.logEvent(\"error:: Problem getting file system - \" + JSON.stringify(e3), 'error');\n    cti.utils.callAction(\n      \"show-notification\", {\n        \"name\": \"api_failure_error\",\n        \"title\": \"Delete failed\",\n        \"text\": \"Problem getting file system - \" + JSON.stringify(e3)\n      }\n    );\n  });\n}"},{"name":"fnUploadPhotos","type":"scripting","item-type":"function","_auto_id_":"4c7bc896-8755-40e6-a010-82e4b3a47700","sync":false,"params":[{"name":"photosObject","description":"Container object with details of all of the photos for the job","required":true},{"name":"baseUrl","description":"API host address (same as used in API integration)","required":true},{"name":"callbackEvent","description":"Callback on success or fail - object takes  bool param"},{"name":"online","description":"Boolean to determine whether we are submitting a new photo or re-submitting a photo that failed"}],"content":"// fnUploadPhotos v 0.3.0.120\n\n/*\n\nSignatures upload\n\nLocations of signatures:\n\n// Operator sign off for job completion\ncti.store.pages.Completion.operativeSignature\n\n// Customer signature\ncti.store.pages.CustomerSignature.customerSignature\n\n// RA Sign-off\ncti.store.pages.RiskAssessment.confirmRASignature\n*/\n\nif(online) {\n  var photos = photosObject || cti.store.jobs.selectedJob.photos || [];\n  cti.store.jobs.photoAssociatedJob = cti.store.jobs.selectedJob;\n  cti.store.jobs.signaturesAssociatedJob = undefined;\n} else {\n  var photos = photosObject.photos || cti.store.jobs.failedPhotosToSend.photos || [];\n  cti.store.jobs.photoAssociatedJob = cti.store.jobs.failedPhotosToSend.job;\n  cti.store.jobs.signaturesAssociatedJob = cti.store.jobs.failedPhotosToSend.signatures;\n}\n\nvar thisPhoto = undefined;\nvar photosToBeUploaded = 0;\nvar failCount = 0;\nvar successCount = 0;\n\nvar signatures = [];\nvar thisSignature = undefined;\nvar signatureFailCount = 0;\nvar signatureSuccessCount = 0;\n\nvar instance = this;\nvar currentItemIndex = -1;\n\nfunction allCompleteEvent() {\n  delete cti.store.jobs.photoAssociatedJob;\n\n  // If any uploads fail, fire the fail event, else fire the success event\n  if (failCount > 0 || signatureFailCount > 0) { \n    if (callbackEvent !== undefined) { callbackEvent(false); } else if (typeof this.$fail === \"function\") { this.$fail(); } else { return false; }\n  } else { \n    if (callbackEvent !== undefined) { callbackEvent(true); } else if (typeof this.$success === \"function\") { this.$success(); } else { return true; }\n  }\n}\nfunction photosCompleteEvent() {\n  // Photos have completed - do the signatures\n  // Reset the index\n  currentItemIndex = -1;\n  // Assign what signatures we have. Object needs to look like this:\n  // { \"content\": \"--base64 image--\", \"category\": \"Signature\", \"description\": \"Type of signature\" }\n  \n  if(cti.store.jobs.signaturesAssociatedJob) {\n    for(var i in cti.store.jobs.signaturesAssociatedJob) {\n      signatures.push(cti.store.jobs.signaturesAssociatedJob[i]);\n    }\n  } else {\n    if (cti.store.pages.Completion !== undefined && cti.store.pages.Completion.operativeSignature !== undefined) {\n      signatures.push({ \n        \"docType\": \"Signature\", \n        \"docNote\": cti.store.pages.Completion.operativeComments || \"\", \n        \"description\":\"\", \n        \"docSubType\": \"Operative job completion\", \n        \"content\": cti.store.pages.Completion.operativeSignature \n      });\n    }\n    if (cti.store.pages.RiskAssessment !== undefined && cti.store.pages.RiskAssessment.confirmRASignature !== undefined) {\n      signatures.push({ \n        \"docType\": \"Signature\", \n        \"docNote\": \"\", \n        \"description\":\"\", \n        \"docSubType\": \"Risk assessment sign-off\", \n        \"content\": cti.store.pages.RiskAssessment.confirmRASignature \n      });\n    }\n    if (cti.store.pages.CustomerSignature !== undefined && cti.store.pages.CustomerSignature.customerSignature !== undefined) {\n      signatures.push({ \n        \"docType\": \"Signature\", \n        \"docNote\": \"\", \n        \"description\":\"\", \n        \"docSubType\": \"Tenant sign-off\", \n        \"content\": cti.store.pages.CustomerSignature.customerSignature \n      });\n    }\n  }\n  \n  if (signatures.length > 0) {\n    cti.store.variables.signatures = signatures;\n    processNextSignature();\n  }\n  else {\n    allCompleteEvent();\n  }\n}\n\nfunction signatureResultCallback(success) {\n  if (success) { \n    signatureSuccessCount++; \n    thisSignature.uploaded = true; \n  } else { \n    signatureFailCount++; \n  }\n  \n  //window.appManager.logEvent('Upload: ' + success, 'info');\n  processNextSignature();\n}\n\nfunction processNextSignature() {\n  var requireUpload = false;\n  currentItemIndex++;\n  if (currentItemIndex < signatures.length) {\n    var startIndex = currentItemIndex;\n    for (var i = startIndex; i < signatures.length; i++) {\n      currentItemIndex = i;\n      thisSignature = signatures[currentItemIndex];\n      // If the photo needs uploading, attempt to do so\n      if (!thisSignature.uploaded) {\n        requireUpload = true;\n        break;\n      }\n    }\n  }\n  if (requireUpload) {\n    // function (serverBaseUri, uploadEndpoint, associateEndpoint, sourceObject, jobObject, callback)\n    //window.appManager.logEvent('Found signature to upload at index ' + currentItemIndex, 'info');\n    window.appManager.uploadBase64AndAssociateWithJob(\n      baseUrl, \n      \"PostImage\", \n      \"AttachImageToJobEvent\", \n      thisSignature,\n      cti.store.jobs.photoAssociatedJob,\n      \"signature\",\n      signatureResultCallback\n    );\n  }\n  else {\n    // No more signatures to be uploaded, fire the completion event\n    allCompleteEvent();\n  }\n}\n\n\nfunction photoResultCallback(success) {\n  if (success) { \n    successCount++; \n    thisPhoto.uploaded = true; \n  } else { \n    failCount++; \n  }\n  \n  //window.appManager.logEvent('Upload: ' + success, 'info');\n  processNextPhoto();\n}\n\nfunction processNextPhoto() {\n  var requireUpload = false;\n  currentItemIndex++;\n  if (currentItemIndex < photos.length) {\n    var startIndex = currentItemIndex;\n    for (var i = startIndex; i < photos.length; i++) {\n      currentItemIndex = i;\n      thisPhoto = photos[currentItemIndex];\n      // If the photo needs uploading, attempt to do so\n      if (!thisPhoto.uploaded) {\n        requireUpload = true;\n        break;\n      }\n    }\n  }\n  if (requireUpload) {\n    photosToBeUploaded++;\n    //window.appManager.logEvent('Found photo to upload at index ' + currentItemIndex, 'info');\n\n    window.appManager.uploadBase64AndAssociateWithJob(\n      baseUrl, \n      \"PostImage\", \n      \"AttachImageToJobEvent\", \n      thisPhoto,\n      cti.store.jobs.photoAssociatedJob,\n      \"photo\",\n      photoResultCallback\n    );\n    //window.appManager.uploadFile(serverUri, thisPhoto.src, resultCallback);\n    //window.appManager.uploadFileAsBase64(serverUri, thisPhoto.src, resultCallback);\n  }\n  else {\n    // No more photos to be uploaded, fire the completion event\n    photosCompleteEvent();\n  }\n}\n\n//window.appManager.logEvent('Uploading photos', 'info');\nif (photos.length > 0) {\n  processNextPhoto();\n} else {\n  photosCompleteEvent();\n}","actions":[]},{"name":"fnStashPhotos","type":"scripting","item-type":"function","_auto_id_":"15242a9f-8c8c-4853-b1bb-e0139fe040e3","sync":true,"params":[],"content":"var failedPhotoObj = JSON.parse(JSON.stringify(cti.store.payloads.failedPhotos));\n\nif(failedPhotoObj == undefined) {\n  failedPhotoObj = {\n    \"photos\" : [],\n    \"signatures\" : [],\n    \"job\" : cti.store.jobs.selectedJob\n  };\n}\n\ncti.store.jobs.failedPhotos.push(failedPhotoObj);\n\ndelete cti.store.jobs.selectedJob.photos;\ndelete cti.store.variables.jobCompleteHeaders;\ndelete cti.store.payloads.jobComplete;\ndelete cti.store.payloads.failedPhotos;\n\nwindow.appManager.logEvent('Failed to send PHOTOS to server for Job ID: ' + failedPhotoObj.job.aAccuServJobID.sJobNo + '. Re-submitting...', 'warning');\n\ncti.utils.callAction('call-actionflow', { \"name\": \"JobComplete\" });","actions":[]},{"name":"fnStashJob","type":"scripting","item-type":"function","_auto_id_":"4692a828-09bd-4f84-ba00-06e264032c49","sync":true,"params":[{"name":"job"}],"content":"var offlineJob = JSON.parse(JSON.stringify(job));\nvar jobList = cti.store.jobs.jobList;\nvar jobDetails = cti.store.jobs.jobDetails;\nvar failedJobs = cti.store.jobs.failedJobs;\n\nfor(var i in jobList) {\n  var thisJob = jobList[i];\n  if(thisJob.aAccuServJobID.iJobEventNoKey === offlineJob.aAccuServJobID.iJobEventNoKey) {\n    jobList.splice(i, 1);\n    break;\n  }\n}\n\nfor(var i in jobDetails) {\n  var thisJob = jobDetails[i];\n  if(thisJob.aAccuServJobID.iJobEventNoKey === offlineJob.aAccuServJobID.iJobEventNoKey) {\n    jobDetails.splice(i, 1);\n    break;\n  }\n}\n\nfor(var i in failedJobs) {\n  var thisJob = failedJobs[i];\n  if(thisJob.aAccuServJobID.iJobEventNoKey === offlineJob.aAccuServJobID.iJobEventNoKey) {\n    failedJobs.splice(i, 1);\n    break;\n  }\n}\n\nif(cti.store.jobs.failedJobs === undefined) cti.store.jobs.failedJobs = [];\ncti.store.jobs.failedJobs.push(offlineJob);\n\ncti.store.jobs.lastJobEvent = {\n  \"aAccuServJobID\" : offlineJob.aAccuServJobID,\n  \"sPropertyID\" : offlineJob.aPropertyDetail.sPropertyID,\n  \"sOperativeID\" : offlineJob.aOperativeDetail.sOperativeID\n};\n\nwindow.appManager.logEvent('Failed to send JOB DETAIL to server for Job ID: ' + offlineJob.aAccuServJobID.sJobNo + '.Re-submitting...', 'error');\n\nwindow.accuServFunctions.fnClearJobData();\n\n// Close spinner\ncti.fnCloseSpinner(1000);\n\ncti.utils.callAction(\n  \"show-notification\", {\n    \"name\": \"api_response_error\",\n    \"title\": \"Job Failed to Send to Server\",\n    \"text\": \"You are currently either offline or there is not a strong enough internet connection to send the data back to the server. Job stored for re-submission.\"\n  }\n);"},{"name":"fnOpenSpinner","type":"scripting","item-type":"function","_auto_id_":"01c10470-46ce-470c-9285-c3e621c67bac","sync":true,"params":[{"name":"message","description":"Message for the spinner to display","required":false}],"content":"var spinner = document.querySelectorAll('load-spinner');\n\nif(spinner && spinner.length > 0) {\n  spinner[0].setAttribute(\"message\", message);\n  spinner[0].show();\n}","actions":[]},{"name":"fnCloseSpinner","type":"scripting","item-type":"function","_auto_id_":"b35429ff-cfd5-417e-b93d-a2e9a0733803","sync":true,"params":[{"name":"timeout"}],"actions":[],"content":"var time = 0;\n\nif(timeout) {\n\ttime = timeout;\n}\n\nsetTimeout(function(){\n  var spinner = document.querySelectorAll('load-spinner');\n\n  if(spinner && spinner.length > 0) {\n    spinner[0].close();\n  }\n}, time);"},{"name":"fnSelectJob","type":"scripting","item-type":"function","_auto_id_":"ffdbd040-497a-40ec-8371-622d5240f05c","sync":true,"params":[{"name":"jobid","description":"Element id for the job"}],"content":"cti.fnOpenSpinner('Loading Job Details...');\n\nvar jobDetails = cti.store.jobs.jobDetails;\nvar jobFound = false;\n\nfor (var i = 0; i < jobDetails.length; i++) {\n  if (jobid == jobDetails[i].aAccuServJobID.iJobEventNoKey) {\n    var detailObj = JSON.parse(JSON.stringify(jobDetails[i]));\n    var items = [];\n\n    for(var i in detailObj.aItemGroups) {\n      var thisItem = detailObj.aItemGroups[i]; \n      var str = JSON.stringify(thisItem);\n      \n      str = str.replace(/sLongDescription/g, 'sLongDescr');\n      str = str.replace(/sDescription/g, 'sShortDescr');\n      \n      thisItem = JSON.parse(str);\n      \n      delete thisItem.nQtyDoneToDate;\n      delete thisItem.sID;\n      delete thisItem.sPriceBook;\n      delete thisItem.sSpecialInstruction;\n      delete thisItem.sUnitOfMeasure;\n      \n      if(thisItem.sLongDescr == \"\" || thisItem.sLongDescr == undefined) thisItem.sLongDescr = thisItem.sShortDescr;\n      if(thisItem.nSMVs == \"\" || thisItem.nSMVs == undefined) thisItem.nSMVs = 0;\n      if(thisItem.nSellPrice == \"\" || thisItem.nSellPrice == undefined) thisItem.nSellPrice = 0;\n      \n      if(thisItem.sAttrib1 == undefined) thisItem.sAttrib1 = \"\";\n      if(thisItem.sAttrib2 == undefined) thisItem.sAttrib2 = \"\";\n      if(thisItem.sAttrib3 == undefined) thisItem.sAttrib3 = \"\";\n      if(thisItem.sAttrib4 == undefined) thisItem.sAttrib4 = \"\";\n      if(thisItem.sStockUnit == undefined) thisItem.sStockUnit = \"\";\n      if(thisItem.sTrade == undefined) thisItem.sTrade = \"\";\n\n      thisItem.nQtyRemaining = thisItem.nQtyRequired;\n      thisItem.bAccuServCode = true;\n      \n      items.push(thisItem);\n    }\n    \n    detailObj.aItemGroups = items;\n    \n    cti.store.jobs.selectedJob = JSON.parse(JSON.stringify(detailObj));\n    \n    if(cti.store.jobs.selectedJob.aInJobDataCollectionResponse === undefined) {\n      cti.store.jobs.selectedJob.aInJobDataCollectionResponse = [];\n    }\n    if(cti.store.jobs.selectedJob.aInJobEventStatus === undefined) {\n      cti.store.jobs.selectedJob.aInJobEventStatus = [];\n    }\n    \n    jobFound = true;\n    break;\n  }\n}\n\nif(jobFound) {\n  if(cti.store.staticData.jobLocations != undefined) {\n    if(cti.store.staticData.jobLocations.length > 0) {\n      cti.fnOrderSORLocations();\n      cti.fnOrderVanLocations();\n      cti.fnOrderOTCLocations();\n    }\n  }\n  \n  cti.utils.callAction('go-to-page', { \"name\": \"TenantDetails\" });\n  cti.fnSendEventStatus(\"30\");\n  \n  // Close spinner\n  cti.fnCloseSpinner(1500);\n} else {\n  cti.store.variables.selectedJobId = jobid;\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobDetailOnline\" });\n}"},{"name":"fnPhoneCall","type":"scripting","item-type":"function","_auto_id_":"1d46d37c-898d-4989-a7e1-fc266d82e25b","sync":true,"params":[{"name":"type"}],"content":"if(type == \"tenanthome\") {\n  window.open('tel:'+cti.store.jobs.selectedJob.aPropertyDetail.sHome_No);\n} else if(type == \"tenantmob\") {\n  window.open('tel:'+cti.store.jobs.selectedJob.aPropertyDetail.sMobile_No);\n} else if(type == \"user\") {\n  window.open('tel:'+cti.store.jobs.selectedJob.aPropertyDetail.sWork_No);\n} else if(type == \"manager\") {\n  window.open('tel:'+cti.store.currentProfile.managerTelephone);\n}"},{"name":"fnBuildPayload","type":"scripting","item-type":"function","_auto_id_":"48c87a75-4cbb-4759-ba9a-3482b5d7a0f9","sync":true,"params":[{"name":"pageName"},{"name":"payloadObject"}],"content":"var schema = cti.store.schema;\n\nfunction getObjects(obj, key, val) {\n    var objects = [];\n    for (var i in obj) {\n          if (!obj.hasOwnProperty(i))\n              continue;\n        if (typeof obj[i] === 'object') {\n            objects = objects.concat(getObjects(obj[i], key, val));\n        }\n        else {\n            if (i == key && obj[i] == val || i == key && val == '') {\n                objects.push(obj);\n            }\n            else if (obj[i] == val && key == '') {\n                if (objects.lastIndexOf(obj) == -1) {\n                    objects.push(obj);\n                }\n            }\n        }\n    }\n    return objects;\n}\n\nfunction sanitiseAnswer(answer) {\n    if (answer === undefined || answer == '') { return undefined; }\n    if (typeof answer === 'object' && answer.hasOwnProperty('value')) {\n      return answer.value;\n    }\n      return answer;\n}\n\nfor (var i = 0; i < schema.pages.length; i++) {\n  if (schema.pages[i].name.toLowerCase() == pageName.toLowerCase()) {    \n    var userInput = getObjects(schema.pages[i].content, 'type', 'user-input');\n    var choice = getObjects(schema.pages[i].content, 'type', 'choice');\n    \n    var questions = userInput.concat(choice);\n    \n    for (var p in questions) {\n      var questionName = questions[p].name;\n      var answer = sanitiseAnswer(cti.store.pages[pageName][questionName]);\n      if (answer !== undefined) {\n        payloadObject[questionName] = answer;\n      }\n    }\n  }\n}"},{"name":"fnPreparePayload","type":"scripting","item-type":"function","_auto_id_":"d6469038-2734-4d9b-ae45-41621703710f","sync":true,"params":[{"name":"pages"}],"content":"var payload = {};\n\nfor(var i in pages) {\n  cti.fnBuildPayload(pages[i], payload);\n}\n\ncti.store.saveActionPayload = payload;"},{"name":"GoogleMapping","type":"integration","item-type":"url","_auto_id_":"8950922d-c921-4891-b2ba-5ca7a7fab017","params":{},"target":"_system","url":"http://maps.google.com/maps/dir/"},{"name":"GoogleMapsAPI","type":"integration","item-type":"api","_auto_id_":"4e2981e5-ec7f-4408-8a45-0bffa5ccb3d8","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"initMap","summary":"initMap","path":"initMap","method":"GET","content-type":"application/json","$open":false}],"url":"https://maps.googleapis.com/maps/api/js?key={{$store.schema.metadata.googleapikey}}&callback"},{"name":"AccuServ","type":"integration","item-type":"api","_auto_id_":"569abf74-343f-410a-a0ec-8fd3a837d933","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"login","summary":"Authentication call","path":"login","method":"POST","content-type":"application/json","$open":false,"params":[{"name":"data","description":"Post payload of username and password","type":"string","typeConfig":{},"in":"body"},{"name":"applicationkey","type":"string","typeConfig":{},"in":"header","description":"App key"},{"name":"messageid","description":"Unique identifies the request","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"joblist","summary":"Job list","path":"joblist","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Current Job List","type":"string","typeConfig":{},"in":"body"}],"$open":false},{"ttlMinutes":60,"name":"jobdetail","summary":"Fetches individual job detail for selected job from job list","path":"jobdetail","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Job ID data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messageid","description":"Unique message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"initialise","summary":"Fetches vehicle information, stock and manager phone number","path":"initialise","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Unique request id","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Date of the request","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Authentication token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobhistory","summary":"Returns specific Job's history","path":"jobhistory","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Data object to send as parameter","type":"string","typeConfig":{},"in":"body"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App Key","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"followonappointment","summary":"Books a follow on appointment","path":"followonappointment","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobcompletion","summary":"Job complete event","path":"jobcompletion","method":"POST","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"followonavailability","summary":"Fetches follow on appointments per trade","path":"followonavailability","method":"POST","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}],"$open":false},{"ttlMinutes":60,"name":"joblocations","summary":"Job locations list","path":"joblocations","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"sordata","summary":"SOR data","path":"sordata","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"vanstock","summary":"Van Stock","path":"vanstock","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"ordercatalogue","summary":"Order catalogue","path":"ordercatalogue","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"purchaseorder","summary":"Send purchase order for stock from device","path":"purchaseorder","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"requestoutofhoursjob","summary":"Sends a request for an OOH job on the fly","path":"requestoutofhoursjob","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"raiseincident","summary":"Raises an on-the-fly incident event","path":"raiseincident","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]},{"ttlMinutes":60,"name":"validatejobstatus","summary":"Validates job before it's started","path":"validatejobstatus","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]}],"url":"{{$store.pages.AppSettings.accuservAPIAddress}}"},{"name":"api_failure_error","type":"notification","item-type":"app-notification","_auto_id_":"a00dff3e-c1be-4578-a028-db36b2261211","options":{"autoDismiss":true,"closeButton":true},"style":"error","actions":[]},{"name":"api_response_error","type":"notification","item-type":"app-notification","_auto_id_":"ef570c53-161e-4d8d-abfe-45c47be48119","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"app_logout","type":"notification","item-type":"app-notification","_auto_id_":"8f05bc62-c9a9-4411-8a6c-b644f2dda39b","options":{"progressBar":false,"autoDismiss":true,"closeButton":true},"style":"warning"},{"name":"AccuServOffline","type":"integration","item-type":"offline-api","_auto_id_":"34baea52-46c2-4e0e-a4ce-f8794894aec5","headers":{},"params":[],"operations":[{"ttlMinutes":60,"name":"startofday","summary":"Sends back vehicle check data","path":"startofday","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Unique id of the request","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Date time of the request","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Sends the Start of Day checks in a data payload to the server","type":"string","typeConfig":{},"in":"body"}],"$open":true},{"ttlMinutes":60,"name":"sordata","summary":"Fetches SOR codes for the user","path":"sordata","method":"GET","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"vanstock","summary":"Brings back Van Stock data","path":"vanstock","method":"GET","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":5,"name":"jobdetail","summary":"jobdetail","path":"jobdetail","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Job ID data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Unique id of the message","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"joblocations","summary":"Fetches locations for van and SOR codes","path":"joblocations","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":5,"name":"refreshtoken","summary":"Refresh our auth token","path":"refreshtoken","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Unique ref","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Date of the message","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"API key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Current token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"tradeslist","summary":"Fetches a list of trades for a job","path":"tradeslist","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"problemsummaries","summary":"Fetches a list of problem summaries for a job","path":"problemsummaries","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"resultsummaries","summary":"Fetches a list of result summaries for a job","path":"resultsummaries","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobdatacollection","summary":"Sends job data back to the server","path":"jobdatacollection","method":"POST","content-type":"application/json","params":[{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"jobcompletion","summary":"Completes current job","path":"jobcompletion","method":"POST","content-type":"application/json","params":[{"name":"messageid","description":"Message id","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}],"$open":false},{"ttlMinutes":60,"name":"ordercatalogue","summary":"Order Catalogue","path":"ordercatalogue","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"}],"$open":false},{"ttlMinutes":60,"name":"stocksuppliers","summary":"Stock Suppliers List","path":"stocksuppliers","method":"GET","content-type":"application/json","params":[{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message Date","type":"string","typeConfig":{},"in":"header"},{"name":"applicationkey","description":"App Key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth Token","type":"string","typeConfig":{},"in":"header"}]},{"ttlMinutes":60,"name":"jobstatus","summary":"Sends a status code back to Accu Serv for the status of the current job","path":"jobstatus","method":"POST","content-type":"application/json","params":[{"name":"applicationkey","description":"App key","type":"string","typeConfig":{},"in":"header"},{"name":"authtoken","description":"Auth token","type":"string","typeConfig":{},"in":"header"},{"name":"messageid","description":"Message ID","type":"string","typeConfig":{},"in":"header"},{"name":"messagedate","description":"Message date","type":"string","typeConfig":{},"in":"header"},{"name":"data","description":"Data payload","type":"string","typeConfig":{},"in":"body"}]}],"url":"{{$store.pages.AppSettings.accuservAPIAddress}}"},{"name":"app_odometer","type":"notification","item-type":"app-notification","_auto_id_":"a61971b9-90c6-46f5-8cd6-c9b4eff916b4","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"app_nowarnings","type":"notification","item-type":"app-notification","_auto_id_":"37633978-47a4-4048-86ba-fcb6e82d2050","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"fnCheckWarning","type":"scripting","item-type":"function","_auto_id_":"5f203ae3-3021-45e0-ad31-547720fd38ff","sync":true,"params":[{"name":"index"}],"actions":[],"content":"var jobwarnings = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\nvar element = document.getElementById('select-all');\nvar uncheckedWarnings = true;\n\nif(jobwarnings[index].checked === \"checked-warning\") {\n  jobwarnings[index].checked = \"unchecked-warning\";\n} else {\n  jobwarnings[index].checked = \"checked-warning\";\n}\n\nfor(var i in jobwarnings) {  \n  if(jobwarnings[i].checked === \"unchecked-warning\") {\n    uncheckedWarnings = false;\n  }\n}\n\nif(uncheckedWarnings) {\n  element.classList.remove('all-unchecked-warning');\n  element.classList.add('all-checked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = true;\n} else {\n  element.classList.remove('all-checked-warning');\n  element.classList.add('all-unchecked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = false;\n}\n\ncti.utils.updatePage();"},{"name":"fnCheckAllWarnings","type":"scripting","item-type":"function","_auto_id_":"02e2f308-251f-40a3-a6a1-219ed8fa966a","sync":true,"params":[],"actions":[],"content":"var jobwarnings = cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarnings;\nvar element = document.getElementById('select-all');\nvar checkedAll = true;\n\nfor(var i in jobwarnings) {  \n  if(jobwarnings[i].checked === \"unchecked-warning\") {\n    checkedAll = false;\n  }\n}\n\nif(checkedAll) {\n  for(var i in jobwarnings) {  \n    jobwarnings[i].checked = \"unchecked-warning\";\n  }\n  element.classList.remove('all-checked-warning');\n  element.classList.add('all-unchecked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = false;\n} else {\n  for(var i in jobwarnings) {  \n    jobwarnings[i].checked = \"checked-warning\";\n  }\n  element.classList.remove('all-unchecked-warning');\n  element.classList.add('all-checked-warning');\n  cti.store.jobs.selectedJob.aPropertyDetail.aPropertyWarningsChecked = true;\n  \n  var objDiv = document.getElementById(\"scrollable\");\n  objDiv.scrollTop = objDiv.scrollHeight;\n}\n\ncti.utils.updatePage();"},{"name":"fnReturnIconClass","type":"scripting","item-type":"function","_auto_id_":"e0eaa59d-90ee-454b-8d4f-d7232ff70306","sync":true,"params":[{"name":"typeOfWarning"}],"actions":[],"content":"if(typeOfWarning === \"2 PERSON CALL\") { \n  return { \n    \"outerClass\": \"two-person-icon\", \n    \"iconClass\": \"fa-user-plus\" \n  };\n} else if(typeOfWarning === \"PROPERTY\") { \n  return { \n    \"outerClass\": \"property-icon\", \n    \"iconClass\": \"fa-home\" \n  };\n} else if(typeOfWarning === \"ASBESTOS\") { \n  return { \n    \"outerClass\": \"asbestos-icon\", \n    \"iconClass\": \"fa-exclamation-triangle\" \n  };\n} else if(typeOfWarning === \"DISABILITY\") { \n  return { \n    \"outerClass\": \"disability-icon\", \n    \"iconClass\": \"fa-wheelchair\" \n  };\n} else if(typeOfWarning === \"VULNERABILITY\") { \n  return { \n    \"outerClass\": \"vulnerability-icon\", \n    \"iconClass\": \"fa-info-circle\" \n  };\n} else { \n  return { \n    \"outerClass\": \"other-icon\", \n    \"iconClass\": \"fa-file-text-o\" \n  };\n}"},{"name":"fnNavigateJobSummary","type":"scripting","item-type":"function","_auto_id_":"e7dcbc76-2cc4-4665-8791-28e814b3fbdd","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"cti.store.jobs.jobSummary = JSON.parse(JSON.stringify(cti.store.jobs.selectedJob));\nvar job = cti.store.jobs.jobSummary;\n\njob.iAttendOnHrs = (\"0\" + Number(job.iAttendOnHrs)).slice(-2);\njob.iAttendOnMins = (\"0\" + Number(job.iAttendOnMins)).slice(-2);\njob.dAttendOnDate = moment(job.dAttendOnDate).format('Do MMMM YYYY');\n\njob.iJobTargetMins = (\"0\" + Number(job.iJobTargetMins)).slice(-2);\njob.iJobTargetHrs = (\"0\" + Number(job.iJobTargetHrs)).slice(-2);\njob.dJobTargetDate = moment(job.dJobTargetDate).format('Do MMMM YYYY');\n\nif(lastPage !== \"JobMap\") {\n  cti.store.variables.jobSummaryLastPage = lastPage;\n}\n\ncti.utils.callAction('go-to-page', { \"name\": \"JobSummary\" });"},{"name":"fnNavigateJobHistory","type":"scripting","item-type":"function","_auto_id_":"519777c0-6709-405e-a7c2-c1d37db85393","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"// Load the spinner\ncti.fnOpenSpinner('Fetching Job History...');\n\ncti.store.variables.lastJobHistoryPage = lastPage;\nvar jobHistory = cti.store.jobs.jobHistory;\n\nif(jobHistory != undefined) {\n  if(jobHistory.length > 0) {\n    cti.utils.callAction('go-to-page', { \"name\": \"JobHistory\" });\n  } else {\n    cti.utils.callAction('call-actionflow', { \"name\": \"GetJobHistory\" });\n  }\n} else {\n  cti.utils.callAction('call-actionflow', { \"name\": \"GetJobHistory\" });\n}"},{"name":"fnNavigateSORCodes","type":"scripting","item-type":"function","_auto_id_":"eb9ff795-3914-4ab2-8492-c35b51375282","sync":true,"params":[{"name":"lastPage","description":"Current page to retain as historic page stack"},{"name":"customerDetails","description":"Boolean to notifiy if the operative has filled in the customers details correctly"}],"actions":[],"content":"var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\ncti.store.variables.lastJobCost = jobCost;\n\nif(customerDetails === undefined) {\n  customerDetails = false;\n}\n\nif(cti.store.variables.showFullLocations === true) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(lastPage == \"CustomerSignature\" || lastPage == \"VanLocationSelect\") {\n  if(customerDetails) {\n  \tcti.store.variables.sorNav = true;\n  } else {\n    cti.store.variables.sorNav = false;\n  }\n} else {\n  cti.store.variables.sorNav = false;\n}\n\ncti.store.variables.lastSORPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"SORLocationSelect\" });"},{"name":"fnNavigateVanStock","type":"scripting","item-type":"function","_auto_id_":"16c6101b-6459-44fc-aab1-169be90594db","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"if(cti.store.variables.showFullLocations === true) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(lastPage == \"SORLocationSelect\" || lastPage == \"OTCPurchases\") {\n  cti.store.variables.vanNav = true;\n} else {\n  cti.store.variables.vanNav = false;\n}\n\nvar vanStockResponse = cti.store.offlineApi.AccuServOffline.vanstock;\n\nif(vanStockResponse != undefined) {\n  if(vanStockResponse.bSuccess === false) {\n    if(vanStockResponse.aOperativeVanStock.length === 0) {\n      cti.store.variables.noVanStock = vanStockResponse.sStatus;\n    } else {\n      cti.store.variables.noVanStock = \"Van Stock failed to download for current Operative. Contact Support.\";\n    }\n  } else {\n    cti.store.variables.noVanStock = undefined;\n  }\n} else {\n  cti.store.variables.noVanStock = \"Van Stock failed to download for current Operative. Contact Support.\";\n}\n\ncti.store.variables.lastVanStockPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"VanLocationSelect\" });"},{"name":"fnNavigatePO","type":"scripting","item-type":"function","_auto_id_":"5d282275-a67c-4fdc-a3ca-11a42d356b34","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"if(lastPage == \"Completion\" || lastPage == \"VanLocationSelect\") {\n  cti.store.variables.poNav = true;\n} else {\n  cti.store.variables.poNav = false;\n}\n\ncti.store.variables.lastPOPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"OTCPurchases\" });"},{"name":"fnNavigateJobMap","type":"scripting","item-type":"function","_auto_id_":"212e237b-1317-4ec1-96b4-cd1672170325","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"// Load the spinner\ncti.fnOpenSpinner('Loading Job Map...');\n\nif(cti.store.jobs.selectedJob == undefined) {\n  cti.store.variables.jobStarted = false;\n} else {\n  if(cti.store.jobs.selectedJob.bJobTravelStarted) {\n    cti.store.variables.jobStarted = true;\n  } else {\n    cti.store.variables.jobStarted = false;\n  }\n}\n\nif(lastPage !== \"JobSummary\") {\n  cti.store.variables.lastJobMapPage = lastPage;\n}\n\ncti.utils.callAction('go-to-page', { \"name\": \"JobMap\" });"},{"name":"fnNavigateSupportInfo","type":"scripting","item-type":"function","_auto_id_":"9933eab2-ce0f-4818-8225-f081bc215db8","sync":true,"params":[],"content":"if(cti.store.jobs.selectedJob == undefined) {\n  cti.store.variables.jobStarted = false;\n} else {\n  if(cti.store.jobs.selectedJob.bJobTravelStarted) {\n    cti.store.variables.jobStarted = true;\n  } else {\n    cti.store.variables.jobStarted = false;\n  }\n}\n\ncti.store.variables.supportInfo = {\n  \"tokenExpiry\": \"n/a\",\n  \"sessionExpiry\": \"n/a\"\n}\n\nif(cti.store.currentProfile.expiryTime) {\n  cti.store.variables.supportInfo.tokenExpiry = window.accuServFunctions.fnLocaleTimeString(cti.store.currentProfile.expiryTime);\n}\nif(cti.store.currentProfile.maxLoginDurationExpiry) {\n  cti.store.variables.supportInfo.sessionExpiry = window.accuServFunctions.fnLocaleTimeString(cti.store.currentProfile.maxLoginDurationExpiry);\n}\n\ncti.store.variables.supportInfoLastPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { \"name\": \"SupportInfo\" });"},{"name":"fnNavigatePhotoDetail","type":"scripting","item-type":"function","_auto_id_":"544f0033-2487-4eb5-b680-382f0d90018f","sync":true,"params":[{"name":"request","description":"Id of the photo to show the details for","required":true}],"content":"if (cti.store.variables.selectedPhoto !== undefined) {\n  delete cti.store.variables.selectedPhoto;\n}\n\ncti.store.variables.selectedPhotoList = request.photosContainer;\n\nfor (var k in request.photosContainer) {\n  if (request.photosContainer[k].id == request.id) {\n    cti.store.variables.selectedPhoto = {\n      \"id\": request.id,\n      \"description\": request.photosContainer[k].description,\n\t  \"src\": request.photosContainer[k].src,\n\t  \"category\": request.photosContainer[k].category,\n\t  \"date\": window.accuServFunctions.fnLocaleTimeString(request.photosContainer[k].date),\n\t  \"internalName\": request.photosContainer[k].internalName\n    }\n\tif (cti.store.pages.PhotoDetail === undefined) {\n      cti.store.pages.PhotoDetail = {};\n    }\n    cti.store.pages.PhotoDetail.Description = cti.store.variables.selectedPhoto.description;\n    \n    break;\n  }\n}\n\ncti.store.variables.lastPhotoDetailPage = cti.store.state.currentPage;\ncti.utils.callAction('go-to-page', { \"name\": \"PhotoDetail\" });"},{"name":"fnNavigateTakePhoto","type":"scripting","item-type":"function","_auto_id_":"cbf6d259-9481-4e7c-be6f-184b4f03b2eb","sync":true,"params":[{"name":"lastPage","description":"Page to navigate to"}],"actions":[],"content":"if(lastPage == \"SORLocationSelect\" || lastPage == \"VanLocationSelect\") {\n  cti.store.variables.sorNav = true;\n} else {\n  cti.store.variables.sorNav = false;\n}\n\ncti.store.variables.lastPhotoPage = lastPage;\ncti.utils.callAction('go-to-page', { \"name\": \"AdHocPhotos\" });"},{"name":"fnStartTravel","type":"scripting","item-type":"function","_auto_id_":"3ee41228-92cb-423a-913a-30a0945f1682","sync":true,"params":[],"content":"var d = new Date();\nvar h = (d.getHours()<10?'0':'') + d.getHours();\nvar m = (d.getMinutes()<10?'0':'') + d.getMinutes();\nvar time = h + ':' + m;\n\ncti.store.jobs.selectedJob.sJobTravelStartedText = \"En-Route Time\";\ncti.store.jobs.selectedJob.dtJobTravelStartedDateTime = moment().format();\ncti.store.jobs.selectedJob.iJobStartedTravelTime = time;\ncti.store.jobs.selectedJob.iJobStartedTravelHrs = h;\ncti.store.jobs.selectedJob.iJobStartedTravelMins = m;\ncti.store.jobs.selectedJob.bJobTravelStarted = true;\n\n// Send job status\ncti.fnSendEventStatus(\"40\");\n\ncti.utils.updatePage();"},{"name":"app_startedtravel","type":"notification","item-type":"app-notification","_auto_id_":"7c9e2d01-79c2-4a30-b6c3-c2a5e5326152","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnEndTravel","type":"scripting","item-type":"function","_auto_id_":"a3c6b774-00fd-4b48-bdc2-c76433bfb1b9","sync":true,"params":[],"content":"var d = new Date();\nvar h = (d.getHours()<10?'0':'') + d.getHours();\nvar m = (d.getMinutes()<10?'0':'') + d.getMinutes();\nvar time = h + ':' + m;\n\nvar spinner = document.getElementById('arriving-spinner');\nspinner.classList.remove('fa-fw');\nspinner.classList.remove('fa-3x');\nspinner.classList.remove('fa-spin');\nspinner.classList.remove('fa-spinner');\nspinner.classList.add('arrived-ticked');\n\ncti.store.jobs.selectedJob.sJobTravelEndedText = \"Arrived Time\";\ncti.store.jobs.selectedJob.dtJobTravelEndedDateTime = moment().format();\ncti.store.jobs.selectedJob.iJobEndedTravelTime = time;\ncti.store.jobs.selectedJob.iJobEndedTravelHrs = h;\ncti.store.jobs.selectedJob.iJobEndedTravelMins = m;\ncti.store.jobs.selectedJob.bJobTravelEnded = true;\n\n// Send job status\ncti.fnSendEventStatus(\"60\");\n\ncti.utils.updatePage();","actions":[]},{"name":"app_noaccessphoto","type":"notification","item-type":"app-notification","_auto_id_":"76807f63-a986-41cd-bbd0-3cd7726444ea","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnStartJob","type":"scripting","item-type":"function","_auto_id_":"0c8404a3-9144-4f61-8de3-eca920de9041","sync":true,"params":[],"content":"var job = cti.store.jobs.selectedJob;\nvar d = new Date();\nvar h = (d.getHours()<10?'0':'') + d.getHours();\nvar m = (d.getMinutes()<10?'0':'') + d.getMinutes();\nvar time = h + ':' + m;\n\njob.sJobStartWorkText = \"Job Started Time\";\njob.iJobStartWorkTime = time;\njob.iJobStartWorkHrs = h;\njob.iJobStartWorkMins = m;\njob.bJobStartWork = true;\n\nif(cti.store.pages.CustomerSignature == undefined) cti.store.pages.CustomerSignature = {};\n\ncti.store.pages.CustomerSignature.tenantHomeNumber = job.aPropertyDetail.sHome_No;\ncti.store.pages.CustomerSignature.tenantMobileNumber = job.aPropertyDetail.sMobile_No;\n\nif(cti.store.variables.estimatedOverride) {\n  job.sExpected_Duration = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n} else {\n  if(job.sExpected_Duration == undefined || job.sExpected_Duration == \"\") {\n    job.sExpected_Duration = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n  }\n}\n\njob.iJobStartWorkEst = job.sExpected_Duration;\n\ncti.store.variables.jobCollectionType = \"initialvisit\";\ncti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n\n// Send job status\ncti.fnSendEventStatus(\"65\");\n\n// Capture original estimatedDuration slot\nif(cti.store.pages.StartingWork.estimatedDuration.value === undefined) {\n  cti.store.jobs.selectedJob.originalEstimatedValue = job.sExpected_Duration;\n} else {\n  cti.store.jobs.selectedJob.originalEstimatedValue = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n}\n\ncti.utils.updatePage();"},{"name":"app_timeslot","type":"notification","item-type":"app-notification","_auto_id_":"29c9d79b-3631-49e5-830c-f46ebc4854aa","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnShowMoreInfo","type":"scripting","item-type":"function","_auto_id_":"6528f7e8-92de-4b32-9f5c-dc808d184b1e","sync":true,"params":[{"name":"elementId"}],"content":"var short = document.getElementById('job-info-short');\nvar full = document.getElementById('job-info-full');\n\nif(elementId == \"short\") {\n  short.classList.remove('job-info-hide');\n  full.classList.add('job-info-hide');\n} else {\n  full.classList.remove('job-info-hide');\n  short.classList.add('job-info-hide');\n}\n\ncti.utils.updatePage();","actions":[]},{"name":"app_sorcodematch","type":"notification","item-type":"app-notification","_auto_id_":"3712d60a-bdee-4510-b913-e06263462006","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnSearchPanel","type":"scripting","item-type":"function","_auto_id_":"5f0a4dd4-3517-495c-90d5-7f3747db42e0","sync":true,"params":[{"name":"menuOption"}],"content":"var panel = document.getElementById('panel');\nvar schedules = document.getElementById('schedules');\nvar search = document.getElementById('search');\n\nif(menuOption == \"schedules\") {\n  panel.classList.remove('sor-search-panel');\n  schedules.classList.remove('sor-search-schedules');\n  search.classList.remove('sor-search-search');\n  \n  panel.classList.add('sor-schedules-panel');\n  schedules.classList.add('sor-schedules-schedules');\n  search.classList.add('sor-schedules-search');\n} else {\n  panel.classList.remove('sor-schedules-panel');\n  schedules.classList.remove('sor-schedules-schedules');\n  search.classList.remove('sor-schedules-search');\n  \n  panel.classList.add('sor-search-panel');\n  schedules.classList.add('sor-search-schedules');\n  search.classList.add('sor-search-search');\n}\n\ncti.store.variables.menuOption = menuOption;\ncti.utils.updatePage();","actions":[]},{"name":"fnOrderSORLocations","type":"scripting","item-type":"function","_auto_id_":"b3e968b7-c88d-40a9-9570-9837e46a44da","sync":true,"params":[],"actions":[],"content":"var locations = cti.store.staticData.jobLocations;\nvar listOfLocations = [];\n\nif(cti.store.variables.showFullLocations === undefined) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(locations == undefined) locations = [];\n\nif(locations.length != 0) {\n  cti.store.variables.jobLocations = true;\n  \n  var orderIdIncrementer = 7;\n  var sorLocations = JSON.parse(JSON.stringify(locations));\n  var sorCodesOnJob = cti.store.jobs.selectedJob.aItemGroups;\n\n  for(var i in sorLocations) {\n    var requiredInLocation = false;\n    var sorCodesQuantity = 0;\n    var currentLocation = sorLocations[i];\n\n    if(currentLocation.sSORCodesQuantity == undefined) currentLocation.sSORCodesQuantity = {};\n\n    for(var k in sorCodesOnJob) {\n      if(sorCodesOnJob[k].sLocation == \"\") {\n        sorCodesOnJob[k].sLocation = \"NOLOCATION\";\n      }\n      \n      if(currentLocation.sLocation == sorCodesOnJob[k].sLocation) {\n        sorCodesQuantity++;\n\n        if(sorCodesOnJob[k].nQtyRemaining != 0) {\n          requiredInLocation = true;\n        }\n      }\n    }\n\n    currentLocation.nSORQuantity = sorCodesQuantity;\n\n    if(sorCodesQuantity > 0) {\n      if(requiredInLocation) {\n        currentLocation.sLocationClass = \"fa required-sorcode\";\n      } else {\n        currentLocation.sLocationClass = \"fa added-sorcode\";\n      }\n\n      currentLocation.sSORCodesQuantity = '(' + sorCodesQuantity + ')';\n    } else {\n      currentLocation.sSORCodesQuantity = \"\";\n      currentLocation.sLocationClass = \"\";\n    }\n    \n    var location = currentLocation.sLocation.toLowerCase();\n       \n    if(location.indexOf(\"kitchen\") != -1) {\n      currentLocation.nOrderId = 1;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bathroom\") != -1) {\n      currentLocation.nOrderId = 2;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"lounge\") != -1 || location.indexOf(\"living\") != -1) {\n      currentLocation.nOrderId = 3;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"1\") != -1) {\n      currentLocation.nOrderId = 4;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"2\") != -1) {\n      currentLocation.nOrderId = 5;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"3\") != -1) {\n      currentLocation.nOrderId = 6;\n      if(sorCodesQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    } else {\n      currentLocation.nOrderId = orderIdIncrementer;\n      orderIdIncrementer++;\n      if(sorCodesQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    }\n  }\n  \n  if(cti.store.variables.showFullLocations) {\n    for(var i in sorLocations) {\n      if(sorLocations[i].nSORQuantity != 0) {\n        sorLocations[i].nOrderId = 0;\n      }\n    }\n    \n    sorLocations.sort(compare);\n    cti.store.jobs.jobSORLocations = sorLocations;\n  } else {\n    cti.store.variables.showFullLocations = false;\n    for(var i in listOfLocations) {\n      if(listOfLocations[i].nSORQuantity != 0) {\n        listOfLocations[i].nOrderId = 0;\n      }\n    }\n    \n    listOfLocations.sort(compare);\n    cti.store.jobs.jobSORLocations = listOfLocations;\n  }\n} else {\n  delete cti.store.jobs.jobSORLocations;\n  cti.store.variables.jobLocations = false;\n}\n\nfunction compare(a,b) {\n  if (a.nOrderId > b.nOrderId) return 1;\n  if (a.nOrderId < b.nOrderId) return -1;\n  return 0;\n}"},{"name":"app_sorcodesfailed","type":"notification","item-type":"app-notification","_auto_id_":"4d25b25c-d2a1-4727-938f-7fd0688e85cb","options":{"autoDismiss":true,"closeButton":true},"style":"warning"},{"name":"app_sorcodeadded","type":"notification","item-type":"app-notification","_auto_id_":"e1825ae8-4d28-4d91-bf20-c21e44bd4127","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"app_specialordersent","type":"notification","item-type":"app-notification","_auto_id_":"4701139d-40ed-48fb-a942-e57d24eda9d3","options":{"autoDismiss":true,"closeButton":true},"style":"info"},{"name":"app_jobcomplete","type":"notification","item-type":"app-notification","_auto_id_":"253d22c8-7ef5-480c-ab23-f9d7329aaa5f","options":{"autoDismiss":true,"closeButton":true},"style":"info"},{"name":"app_genericwarning","type":"notification","item-type":"app-notification","_auto_id_":"004a4fb4-4a0e-45e1-88f5-9e4fb857825c","options":{"autoDismiss":true,"closeButton":true},"style":"warning","title":"Warning"},{"name":"app_riskassessmentsent","type":"notification","item-type":"app-notification","_auto_id_":"51b4bc49-e912-437d-aa34-3eab0446425b","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"fnOrderVanLocations","type":"scripting","item-type":"function","_auto_id_":"e100b1c1-d7d8-4b77-bc7b-579b7f9887bb","sync":true,"params":[],"actions":[],"content":"var locations = cti.store.staticData.jobLocations;\nvar listOfLocations = [];\n\nif(cti.store.variables.showFullLocations === undefined) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(locations == undefined) locations = [];\n\nif(locations.length != 0) {\n  cti.store.variables.jobLocations = true;\n  \n  var orderIdIncrementer = 7;\n  var vanLocations = JSON.parse(JSON.stringify(locations));\n  var vanStockOnJob = cti.store.jobs.selectedJob.aVanStock;\n\n  if(cti.store.jobs.selectedJob.aVanStock == undefined) cti.store.jobs.selectedJob.aVanStock = [];\n\n  for(var i in vanLocations) {\n    var vanStockQuantity = 0;\n    var currentLocation = vanLocations[i];\n\n    if(currentLocation.sVanStockQuantity == undefined) currentLocation.sVanStockQuantity = {};\n\n    for(var k in vanStockOnJob) {\n      if(currentLocation.sLocation == vanStockOnJob[k].sLocation) {\n        vanStockQuantity++;\n      }\n    }\n\n    currentLocation.nVanQuantity = vanStockQuantity;\n\n    if(vanStockQuantity > 0) {\n      currentLocation.sLocationClass = \"fa added-sorcode\";\n      currentLocation.sVanStockQuantity = '(' + vanStockQuantity + ')';\n    } else {\n      currentLocation.sVanStockQuantity = \"\";\n      currentLocation.sLocationClass = \"\";\n    }\n    \n    var location = currentLocation.sLocation.toLowerCase();\n       \n    if(location.indexOf(\"kitchen\") != -1) {\n      currentLocation.nOrderId = 1;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bathroom\") != -1) {\n      currentLocation.nOrderId = 2;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"lounge\") != -1 || location.indexOf(\"living\") != -1) {\n      currentLocation.nOrderId = 3;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"1\") != -1) {\n      currentLocation.nOrderId = 4;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"2\") != -1) {\n      currentLocation.nOrderId = 5;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"3\") != -1) {\n      currentLocation.nOrderId = 6;\n      if(vanStockQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    } else {\n      currentLocation.nOrderId = orderIdIncrementer;\n      orderIdIncrementer++;\n      if(vanStockQuantity > 0) {\n      \tlistOfLocations.push(currentLocation);\n      }\n    }\n  }\n\n  if(cti.store.variables.showFullLocations) {\n    for(var i in vanLocations) {\n      if(vanLocations[i].nVanQuantity != 0) {\n        vanLocations[i].nOrderId = 0;\n      }\n    }\n    \n    vanLocations.sort(compare);\n    cti.store.jobs.locationsVanStock = vanLocations;\n  } else {\n    cti.store.variables.showFullLocations = false;\n    for(var i in listOfLocations) {\n      if(listOfLocations[i].nVanQuantity != 0) {\n        listOfLocations[i].nOrderId = 0;\n      }\n    }\n    \n    listOfLocations.sort(compare);\n    cti.store.jobs.locationsVanStock = listOfLocations;\n  }\n} else {\n  delete cti.store.jobs.locationsVanStock;\n  cti.store.variables.jobLocations = false;\n}\n\nfunction compare(a,b) {\n  if (a.nOrderId > b.nOrderId) return 1;\n  if (a.nOrderId < b.nOrderId) return -1;\n  return 0;\n}"},{"name":"fnOrderOTCLocations","type":"scripting","item-type":"function","_auto_id_":"d873e2ef-4544-483a-80d2-9dbc8f573ac4","sync":true,"params":[],"actions":[],"content":"var locations = cti.store.staticData.jobLocations;\nvar listOfLocations = [];\n\nif(cti.store.variables.showFullLocations === undefined) {\n  cti.store.variables.showFullLocations = false;\n}\n\nif(locations == undefined) locations = [];\n\nif(locations.length != 0) {\n  cti.store.variables.jobLocations = true;\n\n  var orderIdIncrementer = 7;\n  var otcLocations = JSON.parse(JSON.stringify(locations));\n  var otcStockOnJob = cti.store.jobs.selectedJob.aOTCStock;\n\n  if(cti.store.jobs.selectedJob.aOTCStock == undefined) cti.store.jobs.selectedJob.aOTCStock = [];\n\n  for(var i in otcLocations) {\n    var otcStockQuantity = 0;\n    var currentLocation = otcLocations[i];\n\n    if(currentLocation.sOTCStockQuantity == undefined) currentLocation.sOTCStockQuantity = {};\n\n    for(var k in otcStockOnJob) {\n      if(currentLocation.sLocation == otcStockOnJob[k].sLocation) {\n        otcStockQuantity++;\n      }\n    }\n\n    currentLocation.nOTCQuantity = otcStockQuantity;\n\n    if(otcStockQuantity > 0) {\n      currentLocation.sLocationClass = \"fa added-sorcode\";\n      currentLocation.sOTCStockQuantity = '(' + otcStockQuantity + ')';\n    } else {\n      currentLocation.sOTCStockQuantity = \"\";\n      currentLocation.sLocationClass = \"\";\n    }\n\n    var location = currentLocation.sLocation.toLowerCase();\n\n    if(location.indexOf(\"kitchen\") != -1) {\n      currentLocation.nOrderId = 1;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bathroom\") != -1) {\n      currentLocation.nOrderId = 2;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"lounge\") != -1 || location.indexOf(\"living\") != -1) {\n      currentLocation.nOrderId = 3;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"1\") != -1) {\n      currentLocation.nOrderId = 4;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"2\") != -1) {\n      currentLocation.nOrderId = 5;\n      listOfLocations.push(currentLocation);\n    } else if(location.indexOf(\"bed\") != -1 && location.indexOf(\"3\") != -1) {\n      currentLocation.nOrderId = 6;\n      if(otcStockQuantity > 0) {\n        listOfLocations.push(currentLocation);\n      }\n    } else {\n      currentLocation.nOrderId = orderIdIncrementer;\n      orderIdIncrementer++;\n      if(otcStockQuantity > 0) {\n        listOfLocations.push(currentLocation);\n      }\n    }\n  }\n\n  if(cti.store.variables.showFullLocations) {\n    for(var i in otcLocations) {\n      if(otcLocations[i].nOTCQuantity != 0) {\n        otcLocations[i].nOrderId = 0;\n      }\n    }\n\n    otcLocations.sort(compare);\n    cti.store.jobs.locationsOTCStock = otcLocations;\n  } else {\n    cti.store.variables.showFullLocations = false;\n    for(var i in listOfLocations) {\n      if(listOfLocations[i].nOTCQuantity != 0) {\n        listOfLocations[i].nOrderId = 0;\n      }\n    }\n\n    listOfLocations.sort(compare);\n    cti.store.jobs.locationsOTCStock = listOfLocations;\n  }\n} else {\n  delete cti.store.jobs.locationsOTCStock;\n  cti.store.variables.jobLocations = false;\n}\n\nfunction compare(a,b) {\n  if (a.nOrderId > b.nOrderId) return 1;\n  if (a.nOrderId < b.nOrderId) return -1;\n  return 0;\n}"},{"name":"fnCheckPouchDB","type":"scripting","item-type":"function","_auto_id_":"d22dd9c3-9d50-4e4d-99a4-1a99182521b4","sync":true,"params":[{"name":"pouchDB"}],"content":"// Load Spinner\ncti.fnOpenSpinner('Loading Stock Codes...');\n\nwindow.appManager.loadFromDatabase(pouchDB, function (doc) {\n  return true;\n  cti.fnCloseSpinner();\n}, function (reason, err) {\n  cti.fnCloseSpinner();\n  return false;\n});"},{"name":"app_sorpouchfailed","type":"notification","item-type":"app-notification","_auto_id_":"fd9cb18a-4af2-4eaf-9177-cece457e54b3","options":{"autoDismiss":true,"closeButton":true},"style":"warning"},{"name":"app_followon","type":"notification","item-type":"app-notification","_auto_id_":"e2496812-cce2-4426-9e51-fa5d8131b947","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"fnSendEventStatus","type":"scripting","item-type":"function","_auto_id_":"02a27bb1-700e-4a49-bfaf-eb49b0394fd2","sync":true,"params":[{"name":"statusCode"}],"content":"var job = cti.store.jobs.selectedJob;\n\nvar statusObj = {\n  \"sStatus\": statusCode,\n  \"aJobID\" : job.aAccuServJobID,\n  \"dtStatusDT\" : moment().format()\n};\n\ncti.store.payloads.eventStatusPayload = statusObj;\ncti.store.jobs.eventStatusLimit = 10;\n\ncti.utils.callAction('call-actionflow', { \"name\": \"SendEventStatus\" });"},{"name":"fnLoadCamera","type":"scripting","item-type":"function","_auto_id_":"100daf2e-fd80-4fee-a8d7-4471db16f8b0","sync":true,"params":[{"name":"page"},{"name":"componentInstanceId"}],"content":"if(!cti.store.variables.fromPhotoDetail) {\n  cti.utils.callAction(\"call-component-function\", { \n    \"page\" : page,\n    \"componentInstanceId\": componentInstanceId,\n    \"function\":\"takePhoto\"\n  });\n}","actions":[]},{"name":"fnCalcSMVChange","type":"scripting","item-type":"function","_auto_id_":"a6b598a1-31af-4917-b27f-6502d2468cf3","sync":true,"params":[{"name":"sorMins","description":"Expected duration of job in mins from the SORs"}],"content":"if(cti.store.variables.estimatedOverride) {\n  if(cti.store.jobs.selectedJob.bJobStartWork) {\n    cti.store.variables.jobCollectionType = \"updatevisit\";\n    cti.store.jobs.selectedJob.sExpected_Duration = cti.store.pages.StartingWork.estimatedDuration.value.toString();\n\n    cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n  }\n} else {\n  cti.store.jobs.selectedJob.sExpected_Duration = sorMins\n\n  if(cti.store.jobs.selectedJob.bJobStartWork) {\n    if(cti.store.jobs.expectedDurationData != undefined) {\n      if(cti.store.jobs.expectedDurationData.tPairs != undefined) {\n        if(cti.store.jobs.expectedDurationData.tPairs.asValues != undefined) {\n          var lastTimeSent = cti.store.jobs.expectedDurationData.tPairs.asValues[0];\n          var latestTime = sorMins;\n\n          if(lastTimeSent != latestTime) {\n            cti.store.variables.jobCollectionType = \"updatevisit\";\n            cti.store.jobs.selectedJob.sExpected_Duration = latestTime;\n            cti.store.jobs.selectedJob.originalEstimatedValue = latestTime;\n\n            cti.utils.callAction('call-actionflow', { \"name\": \"JobDataCollection\" });\n          }\n        }\n      }\n    }\n  }\n}","actions":[]},{"name":"app_costbanding_a","type":"notification","item-type":"app-notification","_auto_id_":"cffc3e11-d616-4704-92a0-a264c5df0e62","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"app_costbanding_b","type":"notification","item-type":"app-notification","_auto_id_":"f90e58ea-e550-4d5b-9fe5-cea4330ecd73","options":{"autoDismiss":false,"closeButton":false},"style":"warning","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.fnPhoneCall('manager');"},"_auto_id_":"b9e83ff9-6324-49e3-ac7b-9973e923a4a6","actions":[]}]},{"name":"app_costbanding_c","type":"notification","item-type":"app-notification","_auto_id_":"c1cfada4-76be-4916-a1bf-23f92fe156c3","options":{"autoDismiss":false,"closeButton":true},"style":"error","actions":[]},{"name":"app_nopreviousjob","type":"notification","item-type":"app-notification","_auto_id_":"0ee5fe4d-40ef-49a0-9dc6-b9980dc04594","options":{"autoDismiss":true,"closeButton":true},"style":"warning","actions":[]},{"name":"fnSORAlgorithms","type":"scripting","item-type":"function","_auto_id_":"a1b72f53-4136-4560-8aef-d0b5b3fb757c","sync":true,"params":[{"name":"startingWork","description":"Boolean to check if we are calculating the SMV from the Start Work page"},{"name":"minusQty","description":"Whether we are removing a quanitity value from the job cost"}],"content":"function fnCalcEstimatedTime(sors) {\n  var estimated = 0;\n\n  if(sors.length > 0) {\n    for(var i in sors) {\n      var sor = sors[i];\n      var timeSpentOnCode = parseInt(sor.nQtyDoneThisVisit * sor.nSMVs);\n      var timeToSpendOnCode = parseInt(sor.nQtyRemaining * sor.nSMVs);\n\n      estimated += timeSpentOnCode + timeToSpendOnCode;\n    }\n  }\n\n  if(estimated === 0) {\n    if(cti.store.jobs.selectedJob.bJobStartWork) {\n      estimated = cti.store.jobs.expectedDurationData.tPairs.asValues[0];\n    } else {\n      estimated = cti.store.jobs.selectedJob.sExpected_Duration;\n    }\n  }\n\n  return estimated.toString();\n}\n\nfunction fnCalcCostBanding(jobCost, notifications) {\n  var variations = cti.store.jobs.selectedJob.aJobVariationBands;\n  var sBandName;\n  var sBandOverLimitAction;\n  var bandALower;\n  var bandAUpper;\n  var bandAHeader;\n  var bandAAction;\n  \n  var bandBLower;\n  var bandBUpper;\n  var bandBHeader;\n  var bandBAction;\n  \n  var bandCLower;\n  var bandCUpper;\n  var bandCHeader;\n  var bandCAction;\n\n  for(var i in variations) {\n    var thisVariation = variations[i];\n\n    if(thisVariation.sBandName == \"Band A\") {\n      bandALower = thisVariation.nBandLowerLimit;\n      bandAUpper = thisVariation.nBandUpperLimit;\n      bandAHeader = thisVariation.sBandName;\n      bandAAction = thisVariation.sBandOverLimitAction;\n    } else if(thisVariation.sBandName == \"Band B\") {\n      bandBLower = thisVariation.nBandLowerLimit;\n      bandBUpper = thisVariation.nBandUpperLimit;\n      bandBHeader = thisVariation.sBandName;\n      bandBAction = thisVariation.sBandOverLimitAction;\n    } else if(thisVariation.sBandName == \"Band C\") {\n      bandCLower = thisVariation.nBandLowerLimit;\n      bandCUpper = thisVariation.nBandUpperLimit;\n      bandCHeader = thisVariation.sBandName;\n      bandCAction = thisVariation.sBandOverLimitAction;\n    }\n  }\n\n  if(bandALower == undefined) bandALower = 0;\n  if(bandAUpper == undefined) bandAUpper = 200;\n  if(bandAHeader == undefined) bandAHeader = \"Band A\";\n  if(bandAAction == undefined) bandAAction = \"Progress with Job\";\n  if(bandBLower == undefined) bandBLower = 200.01;\n  if(bandBUpper == undefined) bandBUpper = 500;\n  if(bandBHeader == undefined) bandBHeader = \"Band B\";\n  if(bandBAction == undefined) bandBAction = \"Contact Supervisor\";\n  if(bandCLower == undefined) bandCLower = 500;\n  if(bandCUpper == undefined) bandCUpper = 50000;\n  if(bandCHeader == undefined) bandCHeader = \"Band C\";\n  if(bandCAction == undefined) bandCAction = \"Stop Work\";\n\n  var exceededBand = false;\n\n  if(jobCost <= bandAUpper) {\n    var title = bandAHeader + ': ' + bandAAction;\n    var text = \"You are within Band A. Cost Variation Bands for Band A are between ÃÂ£\" + bandALower + \" and ÃÂ£\" + bandAUpper + \".\\n\\nCurrent Cost on Job: ÃÂ£\" + jobCost + \".\\n\\nYou may progress through the job as standard.\";\n\n    if(notifications) {\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\" : \"app_costbanding_a\",\n          \"item-type\" : \"app-notification\",\n          \"style\" : \"success\",\n          \"title\" : title,\n          \"text\" : text\n        }\n      );\n    }\n  } else if(jobCost > bandBLower && jobCost <= bandBUpper) {\n    var title = bandBHeader + ': ' + bandBAction;\n    var text = \"You are within Band B. Cost Variation Bands for Band B are between ÃÂ£\" + bandBLower + \" and ÃÂ£\" + bandBUpper + \".\\n\\nCurrent Cost on Job: ÃÂ£\" + jobCost + \".\\n\\nPlease contact your supervisor before progressing through the job.\";\n\n    if(notifications) {\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\" : \"app_costbanding_b\",\n          \"item-type\" : \"app-notification\",\n          \"style\" : \"warning\",\n          \"title\" : title,\n          \"text\" : text\n        }\n      );\n    }\n  } else if(jobCost > bandCLower) {\n    exceededBand = true;\n    var title = bandCHeader + ': ' + bandCAction;\n    var text = \"You are within Band C. Cost Variation Bands for Band C are above ÃÂ£\" + bandCLower + \".\\n\\nCurrent Cost on Job: ÃÂ£\" + jobCost + \".\\n\\nYou may progress through the job, but further addition of SOR Codes or quantity increases to current SOR Codes will now be restricted. Please discuss with Tenant and contact supervisor if required.\";\n\n    if(notifications) {\n      cti.utils.callAction(\n        \"show-notification\", {\n          \"name\" : \"app_costbanding_c\",\n          \"item-type\" : \"app-notification\",\n          \"style\" : \"Error\",\n          \"title\" : title,\n          \"text\" : text\n        }\n      );\n    }\n  }\n\n  return exceededBand;\n}\n\nif(startingWork === undefined) { startingWork = false; }\nif(minusQty === undefined) { minusQty = false; }\n  \nif(cti.store.variables.estimatedOverride === false || cti.store.variables.estimatedOverride === undefined) {\n  var sorMins = fnCalcEstimatedTime(cti.store.jobs.selectedJob.aItemGroups);\n  cti.fnCalcSMVChange(sorMins);\n}\n\nif(minusQty) {\n  var minusJobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\n  cti.store.jobs.selectedJob.sPreviousJobCost = minusJobCost;\n} else {\n  var exceededBand = undefined;\n  var costChange = false;\n  var jobCost = cti.fnCalcJobCost(cti.store.jobs.selectedJob.aItemGroups);\n\n  if(cti.store.variables.firstCostCalculation) {\n    exceededBand = fnCalcCostBanding(jobCost, startingWork);\n    delete cti.store.variables.firstCostCalculation;\n  } else {\n    if(cti.store.jobs.selectedJob.sPreviousJobCost != jobCost) {\n      cti.store.jobs.selectedJob.sPreviousJobCost = jobCost;\n    }\n\n    exceededBand = fnCalcCostBanding(jobCost, startingWork);\n  }\n\n  return exceededBand;\n}","actions":[]},{"name":"fnCalcJobCost","type":"scripting","item-type":"function","_auto_id_":"3e87fb90-297f-498e-b757-8e0e059eee2a","sync":true,"params":[{"name":"sors","description":"SORs on job"}],"content":"var jobCost = 0;\n\nfor(var i in sors) {\n  var sor = sors[i];\n  var jobCostOnCode = (parseFloat(sor.nSellPrice).toFixed(2) * sor.nQtyDoneThisVisit);\n  var jobCostToSpendOnCode = (parseFloat(sor.nSellPrice).toFixed(2) * sor.nQtyRemaining);\n  var thisSorCost = jobCostOnCode + jobCostToSpendOnCode;\n\n  jobCost += thisSorCost;\n}\n\njobCost = jobCost.toFixed(2);\n\nif(cti.store.jobs.selectedJob.sPreviousJobCost === undefined) {\n  cti.store.variables.firstCostCalculation = true;\n  cti.store.jobs.selectedJob.sPreviousJobCost = jobCost;\n}\n\nreturn jobCost;","actions":[]}],"components":[{"name":"ContextMenu","description":"","icon":"fa-puzzle-piece","_auto_id_":"9d0ad91e-82cf-454a-8d80-931ec019b6e8","tagName":"context-menu","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"title","description":"An optional panel title","type":"string","enum":null,"required":false}],"functions":[{"name":"open","description":"Open the context menu","params":[],"returnType":"void","returnEnum":null},{"name":"close","description":"Close the context menu","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"ContextMenu.js","transpiled":"ContextMenu.output.js"}},{"name":"ActivitySpinner","description":"","icon":"fa-puzzle-piece","_auto_id_":"649dedf7-f246-460b-841c-df3adbdf6522","tagName":"load-spinner","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"message","description":"A message to display whilst the spinner is showing","type":"string","enum":null,"required":false}],"functions":[{"name":"show","description":"Invoke the spinner","params":[],"returnType":"void","returnEnum":null},{"name":"close","description":"Remove/hide the spinner","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"ActivitySpinner.js","transpiled":"ActivitySpinner.output.js"}},{"name":"ListSearcher","description":"Custom search control for lists","icon":"fa-puzzle-piece","_auto_id_":"d9a7540d-769f-4e02-adb9-2148284a8208","tagName":"list-searcher","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"minCharacters","description":"Min number of characters to be entered before it will auto-search ahead","type":"number","enum":null,"required":false},{"name":"maxResults","description":"Maximum number of results to output (defaults to 30)","type":"number","enum":null,"required":false},{"name":"displayListIfNoSearch","description":"Governs display of results if a search is not active default to 0","type":"number","enum":["0","1"],"required":true},{"name":"sourceObjectArrayName","description":"Name of the source object array you want to search (eg. cti.model.customerList)","type":"string","enum":null,"required":true},{"name":"displayArrayName","description":"Name of the array to populate with search results, which you should then bind to a list (eg. cti.model.mySearchResults)","type":"string","enum":null,"required":true}],"events":[{"name":"searchComplete","description":"Fired when a search has finished actioning","type":"void","enum":null}]},"userConfig":{},"valid":true,"files":{"original":"ListSearcher.js","transpiled":"ListSearcher.output.js"}},{"name":"PhotoManager","description":"Manage photos, capture, delete, store and display","icon":"fa-puzzle-piece","_auto_id_":"98807067-3c95-452a-9d3d-74d7a04fa651","tagName":"photo-manager","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"captureWidth","description":"Width restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureHeight","description":"Height restriction on captured photos","type":"number","enum":null,"required":false},{"name":"captureQuality","description":"QUality setting for captured photos","type":"number","enum":["50","75","90","100"],"required":false},{"name":"captureCategory","description":"Optional category identifier to assign to photos when captured.","type":"string","enum":null,"required":false},{"name":"displayCategory","description":"Optional category on which to filter display of photos","type":"string","enum":null,"required":false},{"name":"maxPhotos","description":"Maximum number of photos that can be captured in this category (default is 3)","type":"number","enum":null,"required":false}],"events":[{"name":"captureComplete","description":"Fired when a photo has been captured","type":"void","enum":null},{"name":"editPhoto","description":"Fired when user selects edit option","type":"void","enum":null},{"name":"maxPhotosTaken","description":"Fired when we have taken the maximum number of photos in this category","type":"void","enum":null}],"functions":[{"name":"takePhoto","description":"Take a photo","params":[{"name":"filename","description":"A filename to allocate to the capture photo","type":"string","enum":null,"required":false}],"returnType":"void","returnEnum":null},{"name":"deletePhoto","description":"Delete a photo","params":[{"name":"id","description":"The internal id of the photo to remove","type":"string","enum":null,"required":true}],"returnType":"void","returnEnum":null},{"name":"clearPhotos","description":"Clear photos","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"PhotoManager.js","transpiled":"PhotoManager.output.js"}},{"name":"SORSearcher","description":"","icon":"fa-puzzle-piece","_auto_id_":"55b24a7c-9cde-4da4-95b2-8ab725ae8165","tagName":"sor-searcher","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"minCharacters","description":"Min number of characters to be entered before it will auto-search ahead","type":"number","enum":null,"required":false},{"name":"maxResults","description":"Maximum number of results to output (defaults to 30)","type":"number","enum":null,"required":false},{"name":"displayListIfNoSearch","description":"Governs display of results if a search is not active default to 0","type":"number","enum":["0","1"],"required":true},{"name":"sourceObjectArrayName","description":"Name of the source object array you want to search (eg. cti.model.customerList). If not specified, sordata in pouchdb will be used as the source","type":"string","enum":null,"required":false},{"name":"displayArrayName","description":"Name of the array to populate with search results, which you should then bind to a list (eg. cti.model.mySearchResults)","type":"string","enum":null,"required":true},{"name":"locationFilter","description":"Location id filter by which to restrict result selection (empty value will be unfiltered)","type":"string","enum":null,"required":false},{"name":"pouchDB","description":"Select your pouch DB instance","type":"string","enum":null,"required":false}],"events":[{"name":"searchComplete","description":"Fired when a search has finished actioning","type":"void","enum":null}],"functions":[{"name":"bind","description":"Re-bind location filtered SOR codes to the model","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{},"valid":true,"files":{"original":"SORSearcher.js","transpiled":"SORSearcher.output.js"}},{"name":"NumericToggler","description":"","icon":"fa-puzzle-piece","_auto_id_":"85bb1332-5b6a-4997-88ea-7a6a9af9e949","tagName":"numeric-toggler","type":"web-component","format":"javascript","typeVersion":"1","annotations":{"attributes":[{"name":"initialQuantity","description":"Starting quantity value","type":"number","enum":null,"required":false},{"name":"canIncrement","description":"Are we able to increment the value","type":"boolean","enum":null,"required":false},{"name":"canDecrement","description":"Are we able to decrement the value","type":"boolean","enum":null,"required":false}],"events":[{"name":"changed","description":"Fired when held value changes","type":"void","enum":null}],"properties":[{"name":"quantity","getter":true,"setter":true,"modelConfig":{"store":false,"changeEvents":[]},"getterDescription":"Get the current quantity","returnType":"number","returnEnum":null,"setterDescription":"Set the quantity","valueType":"number","valueEnum":null},{"name":"canDecrement","getter":true,"setter":true,"modelConfig":{"store":false,"changeEvents":[]},"getterDescription":"Is the user allowed to dec the value?","returnType":"boolean","returnEnum":null,"setterDescription":"Set if the user is allowed to dec the value","valueType":"boolean","valueEnum":null},{"name":"canIncrement","getter":true,"setter":true,"modelConfig":{"store":false,"changeEvents":[]},"getterDescription":"Is the user allowed to inc the value?","returnType":"boolean","returnEnum":null,"setterDescription":"Set if the user is allowed to inc the value","valueType":"boolean","valueEnum":null}],"functions":[{"name":"decrement","description":"Decrement the value in the control","params":[],"returnType":"void","returnEnum":null},{"name":"increment","description":"Increment the current value","params":[],"returnType":"void","returnEnum":null}]},"userConfig":{"properties":{"quantity":{"modelConfig":{"store":false,"changeEvents":[]}},"canDecrement":{"modelConfig":{"store":false,"changeEvents":[]}},"canIncrement":{"modelConfig":{"store":false,"changeEvents":[]}}}},"valid":true,"files":{"original":"NumericToggler.js","transpiled":"NumericToggler.output.js"}}],"icondata":"logo.png","lastSchemaUpgradeDate":"2017-04-20 07:25:24","jwt":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBfaWQiOiJlNTMxZGRlNi1hNDY3LTQ4ODItYTNkMS05NWM0YzU0ZjBhMWYiLCJhcHBfbmFtZSI6IkFjY3VTZXJ2X0NQMTJfdjEwNSIsImJ1aWxkX2lkIjoiMWI2NDZhODYtMDIzNi00M2ZhLWFmMzMtM2ZlNDFlNGQ0M2Q2IiwiY2xpZW50X2lkIjoiYjM3ODUyNzEtN2U3ZS00ZTg4LTk1YmMtMjFiZjM0MWY2ZjNlIiwiY2xpZW50X3NlY3JldCI6ImVIWXhWMnRHVlhkNUsxaHFkQ3RqWlZrM2JtdFFkejA5IiwiZXhwIjoxNTM3MTQyNDAwLCJmcmVxdWVuY3kiOjIxNjAwMDAwMCwiaGFzaCI6ImEzZmE5YjE1ODA3YzQ4NmQ1MTZiNjhmNDJjZjRlMjdiZWQ4MGMxODU4NDEwYzU1N2FhMDU5ZGJjYWUyMjE2MTgiLCJsaWNfZXhwIjoxNTM0NTUwNDAwLCJscF9pZCI6IjFlODIzNTc0LWUyNzAtNDAxZS1hNGYzLTc4ZDdmMzY5MGQyMyIsInBhY2thZ2VfaWQiOiJjb20uaW50ZXJuZXRhbGlhLmFjY3VzZXJ2LnloZ3VhdCIsInJlZnJlc2hfdG9rZW4iOiJjV3hRV1hZMFdUUjZNMWh0Vlhoa1J6QmlZV1ZXYmpoVFpqaHljbVYxTlZoM05VVXdSVE16VG1WSVVUMD0iLCJ0eXBlIjoiZnVsbCIsImlhdCI6MTUyMDYwNTM2N30.afYRy0LRBKTQZrIIW6tPAxIA7uEnT2LTKS_eojszEDuRWunRkk2nCbfx4QoQkfedyml1QCgSahw1F_Mk4p5qLB3sNMEy6MUTCCGHlAzxjNqSbtTf07OF40-yk_eWP7Krd6C5HfGLVlfdts9LnZsPZxkXqv6yBGFnrEUoifMy0xiBFpLDmGV-PaPpcZ8hroAzGWozHhNPaMGFZoRPmrIhN9nmsiC6WF4wIiOO4yAnbx5ASfj5ieyMhWByf7w6CRYB1Jmx_CSfmYgt4Gbz5iTCpAA2S-M5i-St36ifOEBeSNiq8fk7oYgkxJ16HZyJWcTWDvjRwDBM4Y1Io9544vhh7g","buildId":"1b646a86-0236-43fa-af33-3fe41e4d43d6","hostContext":0}